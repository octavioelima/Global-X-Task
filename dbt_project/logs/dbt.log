

============================== 2024-06-05 23:59:29.054872 | ecdd57aa-593c-40a3-b704-0552e94d3a7b ==============================
[0m23:59:29.054892 [info ] [MainThread]: Running with dbt=1.3.0
[0m23:59:29.055276 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:59:29.055364 [debug] [MainThread]: Tracking: tracking
[0m23:59:29.063261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113058820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113040640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130404f0>]}
[0m23:59:29.070098 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m23:59:29.070345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecdd57aa-593c-40a3-b704-0552e94d3a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11304d2b0>]}
[0m23:59:29.089662 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:59:29.091671 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m23:59:29.092252 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m23:59:29.096590 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:59:29.101405 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:59:29.102753 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:59:29.104970 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:59:29.105643 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:59:29.107463 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:59:29.107734 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:59:29.109514 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:59:29.110082 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:59:29.110271 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:59:29.114498 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:59:29.115343 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:59:29.117139 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:59:29.118308 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:59:29.119090 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:59:29.127053 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:59:29.133648 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:59:29.139559 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:59:29.141652 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:59:29.142494 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:59:29.143302 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:59:29.147095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:59:29.154805 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:59:29.155518 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:59:29.158638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:59:29.163604 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:59:29.171695 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:59:29.174190 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:59:29.175737 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:59:29.178275 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:59:29.178881 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:59:29.180375 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:59:29.181385 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:59:29.184857 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:59:29.193559 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:59:29.194305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:59:29.195432 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:59:29.196113 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:59:29.196506 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:59:29.196876 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:59:29.197178 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:59:29.197785 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:59:29.200160 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:59:29.204011 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:59:29.204370 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:59:29.204918 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:59:29.205338 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:59:29.205754 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:59:29.206297 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:59:29.206650 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:59:29.207106 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:59:29.207642 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:59:29.208674 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:59:29.209232 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:59:29.209721 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:59:29.210212 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:59:29.210702 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:59:29.211150 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:59:29.211644 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:59:29.212057 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:59:29.215135 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:59:29.215609 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:59:29.216024 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:59:29.216847 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:59:29.217874 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:59:29.218343 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:59:29.219033 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:59:29.219505 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:59:29.220473 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:59:29.221973 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:59:29.223242 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:59:29.230172 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:59:29.231139 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:59:29.237495 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:59:29.239570 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:59:29.242844 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:59:29.247685 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:59:29.250621 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:59:29.370107 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m23:59:29.376851 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m23:59:29.378157 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m23:59:29.379356 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m23:59:29.398139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113174970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ffaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f0a30>]}
[0m23:59:29.398319 [debug] [MainThread]: Flushing usage events
[0m23:59:29.665291 [error] [MainThread]: Encountered an error:
Compilation Error in model fred_unemp (models/fred_unemp.sql)
  Model 'model.global_x_task.fred_unemp' (models/fred_unemp.sql) depends on a node named 'integrated_etf_data' which was not found


============================== 2024-06-06 00:06:48.159178 | d9179ea2-56d9-45d6-98c2-56d6cbc61a50 ==============================
[0m00:06:48.159203 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:06:48.159868 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:06:48.159984 [debug] [MainThread]: Tracking: tracking
[0m00:06:48.170422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109124d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109124940>]}
[0m00:06:48.177186 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:06:48.177387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9179ea2-56d9-45d6-98c2-56d6cbc61a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109119490>]}
[0m00:06:48.189397 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:06:48.190559 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:06:48.191161 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:06:48.195163 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:06:48.199725 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:06:48.200990 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:06:48.203132 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:06:48.203776 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:06:48.205478 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:06:48.205746 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:06:48.207534 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:06:48.208087 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:06:48.208269 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:06:48.211994 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:06:48.212696 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:06:48.214555 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:06:48.215682 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:06:48.216437 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:06:48.223771 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:06:48.229992 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:06:48.235631 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:06:48.237633 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:06:48.238431 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:06:48.239218 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:06:48.242793 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:06:48.250131 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:06:48.250805 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:06:48.253794 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:06:48.258523 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:06:48.266466 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:06:48.268963 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:06:48.270500 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:06:48.272954 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:06:48.273512 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:06:48.275001 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:06:48.275991 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:06:48.279374 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:06:48.287953 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:06:48.288605 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:06:48.289690 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:06:48.290365 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:06:48.290756 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:06:48.291102 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:06:48.291400 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:06:48.291999 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:06:48.294343 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:06:48.298139 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:06:48.298495 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:06:48.299026 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:06:48.299446 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:06:48.299854 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:06:48.300389 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:06:48.300743 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:06:48.301197 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:06:48.301740 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:06:48.302763 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:06:48.303296 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:06:48.303766 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:06:48.304231 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:06:48.304709 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:06:48.305116 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:06:48.305598 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:06:48.305993 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:06:48.308936 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:06:48.309394 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:06:48.309796 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:06:48.310585 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:06:48.311570 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:06:48.312023 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:06:48.312676 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:06:48.313132 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:06:48.314065 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:06:48.315510 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:06:48.316729 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:06:48.323530 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:06:48.324429 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:06:48.330557 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:06:48.332521 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:06:48.335725 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:06:48.340176 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:06:48.342946 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:06:48.455466 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:06:48.461212 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:06:48.462410 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:06:48.463553 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:06:48.464692 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:06:48.482493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b4040>]}
[0m00:06:48.482644 [debug] [MainThread]: Flushing usage events
[0m00:06:48.698886 [error] [MainThread]: Encountered an error:
Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  Model 'model.global_x_task.integrated_etf_data' (models/integrated_etf_data.sql) depends on a source named 'global.integrated_etf' which was not found


============================== 2024-06-06 00:08:05.420131 | b5a78005-4606-438b-a3f6-58368a43213a ==============================
[0m00:08:05.420150 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:08:05.420535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:08:05.420623 [debug] [MainThread]: Tracking: tracking
[0m00:08:05.428962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110263820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11024ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11024c250>]}
[0m00:08:05.435372 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:08:05.435563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5a78005-4606-438b-a3f6-58368a43213a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110259220>]}
[0m00:08:05.445866 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:08:05.446824 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:08:05.447347 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:08:05.451139 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:08:05.455747 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:08:05.457072 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:08:05.459187 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:08:05.459695 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:08:05.461353 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:08:05.461606 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:08:05.463376 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:08:05.463921 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:08:05.464094 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:08:05.467770 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:08:05.468471 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:08:05.470170 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:08:05.471239 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:08:05.471962 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:08:05.479623 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:08:05.486205 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:08:05.492135 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:08:05.494249 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:08:05.495077 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:08:05.495896 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:08:05.499781 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:08:05.507741 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:08:05.508529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:08:05.511609 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:08:05.516386 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:08:05.524381 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:08:05.526853 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:08:05.528553 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:08:05.531089 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:08:05.531675 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:08:05.533187 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:08:05.534241 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:08:05.537797 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:08:05.546598 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:08:05.547283 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:08:05.548431 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:08:05.549122 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:08:05.549516 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:08:05.549870 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:08:05.550168 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:08:05.550767 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:08:05.553201 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:08:05.557039 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:08:05.557409 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:08:05.557949 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:08:05.558368 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:08:05.558781 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:08:05.559325 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:08:05.559682 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:08:05.560128 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:08:05.560677 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:08:05.561720 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:08:05.562263 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:08:05.562733 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:08:05.563199 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:08:05.563645 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:08:05.564044 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:08:05.564510 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:08:05.564907 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:08:05.567855 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:08:05.568311 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:08:05.568711 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:08:05.569507 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:08:05.570482 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:08:05.570934 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:08:05.571589 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:08:05.572050 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:08:05.572990 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:08:05.574428 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:08:05.575662 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:08:05.582331 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:08:05.583188 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:08:05.589299 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:08:05.591261 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:08:05.594445 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:08:05.598889 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:08:05.601657 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:08:05.719160 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:08:05.725535 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:08:05.726794 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:08:05.728104 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:08:05.729489 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:08:05.748217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ddc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f40a0>]}
[0m00:08:05.748476 [debug] [MainThread]: Flushing usage events
[0m00:08:06.038373 [error] [MainThread]: Encountered an error:
Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  Model 'model.global_x_task.integrated_etf_data' (models/integrated_etf_data.sql) depends on a source named 'globalx.integrated_etf' which was not found


============================== 2024-06-06 00:08:39.263538 | f1e7cfc7-e7e5-493f-8897-2f7719ef9879 ==============================
[0m00:08:39.263560 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:08:39.263913 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:08:39.264003 [debug] [MainThread]: Tracking: tracking
[0m00:08:39.272450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ffc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107335d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe46d0>]}
[0m00:08:39.278674 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:08:39.278836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1e7cfc7-e7e5-493f-8897-2f7719ef9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff1250>]}
[0m00:08:39.293978 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:08:39.294918 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:08:39.295430 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:08:39.299472 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:08:39.303990 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:08:39.305258 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:08:39.307171 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:08:39.307648 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:08:39.309587 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:08:39.310031 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:08:39.311958 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:08:39.312548 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:08:39.312740 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:08:39.316555 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:08:39.317300 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:08:39.319073 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:08:39.320195 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:08:39.320966 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:08:39.328458 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:08:39.335009 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:08:39.341234 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:08:39.343477 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:08:39.344422 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:08:39.345359 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:08:39.349128 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:08:39.356830 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:08:39.357563 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:08:39.360722 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:08:39.365860 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:08:39.373941 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:08:39.376435 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:08:39.377986 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:08:39.380454 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:08:39.381025 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:08:39.382522 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:08:39.383513 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:08:39.386926 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:08:39.395553 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:08:39.396223 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:08:39.397305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:08:39.397985 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:08:39.398383 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:08:39.398730 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:08:39.399026 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:08:39.399623 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:08:39.401973 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:08:39.405766 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:08:39.406129 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:08:39.406663 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:08:39.407084 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:08:39.407497 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:08:39.408039 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:08:39.408395 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:08:39.408848 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:08:39.409387 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:08:39.410416 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:08:39.410951 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:08:39.411426 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:08:39.411884 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:08:39.412338 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:08:39.412737 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:08:39.413207 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:08:39.413599 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:08:39.416543 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:08:39.417002 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:08:39.417407 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:08:39.418201 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:08:39.419193 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:08:39.419642 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:08:39.420304 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:08:39.421846 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:08:39.422865 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:08:39.424356 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:08:39.425605 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:08:39.432399 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:08:39.433282 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:08:39.439367 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:08:39.441380 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:08:39.444622 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:08:39.449054 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:08:39.451836 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:08:39.564772 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:08:39.570619 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:08:39.571813 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:08:39.572950 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:08:39.574093 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:08:39.592363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a39d100>]}
[0m00:08:39.592538 [debug] [MainThread]: Flushing usage events
[0m00:08:39.814638 [error] [MainThread]: Encountered an error:
Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  Model 'model.global_x_task.integrated_etf_data' (models/integrated_etf_data.sql) depends on a source named 'global_x_task.integrated_etf' which was not found


============================== 2024-06-06 00:28:00.270903 | f3f5b34b-01d5-4bf6-a0cd-07332dcaec46 ==============================
[0m00:28:00.270926 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:28:00.271475 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:28:00.271578 [debug] [MainThread]: Tracking: tracking
[0m00:28:00.282417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92100>]}
[0m00:28:00.289155 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:28:00.289370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3f5b34b-01d5-4bf6-a0cd-07332dcaec46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99430>]}
[0m00:28:00.292177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f994f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99400>]}
[0m00:28:00.292335 [debug] [MainThread]: Flushing usage events
[0m00:28:00.539738 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/source.yml is invalid because the yml property file models/source.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2024-06-06 00:29:03.175089 | 60daf1a5-7949-4437-ad2b-673511ed692a ==============================
[0m00:29:03.175113 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:29:03.176095 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:29:03.176204 [debug] [MainThread]: Tracking: tracking
[0m00:29:03.185403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651f850>]}
[0m00:29:03.193113 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:29:03.193309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60daf1a5-7949-4437-ad2b-673511ed692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106515490>]}
[0m00:29:03.211190 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:29:03.212338 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:29:03.212873 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:29:03.216789 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:29:03.221315 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:29:03.222587 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:29:03.224528 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:29:03.225019 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:29:03.226646 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:29:03.226887 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:29:03.228619 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:29:03.229151 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:29:03.229326 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:29:03.232969 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:29:03.233659 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:29:03.235345 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:29:03.236394 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:29:03.237121 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:29:03.244318 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:29:03.250487 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:29:03.256306 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:29:03.258417 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:29:03.259226 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:29:03.260015 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:29:03.263604 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:29:03.271009 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:29:03.271735 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:29:03.274720 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:29:03.279394 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:29:03.287464 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:29:03.289984 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:29:03.291540 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:29:03.294018 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:29:03.294582 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:29:03.296074 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:29:03.297060 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:29:03.300460 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:29:03.309013 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:29:03.309668 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:29:03.310752 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:29:03.311429 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:29:03.311824 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:29:03.312166 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:29:03.312461 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:29:03.313054 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:29:03.315396 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:29:03.319181 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:29:03.319541 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:29:03.320075 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:29:03.320492 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:29:03.320894 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:29:03.321440 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:29:03.321792 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:29:03.322239 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:29:03.322775 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:29:03.323804 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:29:03.324339 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:29:03.324804 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:29:03.325266 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:29:03.325713 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:29:03.326112 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:29:03.326580 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:29:03.326968 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:29:03.329916 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:29:03.330372 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:29:03.330771 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:29:03.331560 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:29:03.332544 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:29:03.332992 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:29:03.333650 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:29:03.334107 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:29:03.335038 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:29:03.336473 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:29:03.337717 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:29:03.344367 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:29:03.345229 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:29:03.351275 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:29:03.353217 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:29:03.356375 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:29:03.360779 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:29:03.363523 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:29:03.477640 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:29:03.483546 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:29:03.484842 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:29:03.486116 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:29:03.487326 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:29:03.511215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106698190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066986a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106698100>]}
[0m00:29:03.511427 [debug] [MainThread]: Flushing usage events
[0m00:29:03.706443 [error] [MainThread]: Encountered an error:
Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  Model 'model.global_x_task.integrated_etf_data' (models/integrated_etf_data.sql) depends on a source named 'globalx.integrated_etf_data' which was not found


============================== 2024-06-06 00:35:39.688697 | ab527495-48a9-4903-90e8-170fc7fe53a4 ==============================
[0m00:35:39.688717 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:35:39.689184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:35:39.689269 [debug] [MainThread]: Tracking: tracking
[0m00:35:39.700272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eee4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f00bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f00850>]}
[0m00:35:39.707023 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:35:39.707219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab527495-48a9-4903-90e8-170fc7fe53a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef5490>]}
[0m00:35:39.724129 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:35:39.725212 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:35:39.725740 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:35:39.729603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:35:39.734165 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:35:39.735447 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:35:39.737344 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:35:39.737808 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:35:39.739484 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:35:39.739725 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:35:39.741467 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:35:39.741995 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:35:39.742169 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:35:39.745805 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:35:39.746498 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:35:39.748178 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:35:39.749230 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:35:39.749955 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:35:39.757160 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:35:39.763317 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:35:39.768909 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:35:39.770889 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:35:39.771663 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:35:39.772438 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:35:39.775973 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:35:39.783417 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:35:39.784111 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:35:39.787239 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:35:39.791964 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:35:39.799864 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:35:39.802315 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:35:39.803843 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:35:39.806296 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:35:39.806854 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:35:39.808346 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:35:39.809332 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:35:39.812676 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:35:39.821220 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:35:39.821874 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:35:39.822950 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:35:39.823628 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:35:39.824018 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:35:39.824369 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:35:39.824664 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:35:39.825261 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:35:39.827593 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:35:39.831362 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:35:39.831716 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:35:39.832245 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:35:39.832662 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:35:39.833062 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:35:39.833603 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:35:39.833951 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:35:39.834423 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:35:39.834959 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:35:39.835990 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:35:39.836522 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:35:39.836991 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:35:39.837452 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:35:39.837900 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:35:39.838296 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:35:39.838760 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:35:39.839150 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:35:39.842084 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:35:39.842542 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:35:39.842947 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:35:39.843734 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:35:39.844712 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:35:39.845169 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:35:39.845822 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:35:39.846279 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:35:39.847210 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:35:39.848636 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:35:39.849851 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:35:39.856540 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:35:39.857403 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:35:39.863445 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:35:39.865380 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:35:39.868540 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:35:39.872946 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:35:39.875693 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:35:39.990432 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:35:39.997081 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:35:39.998401 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:35:39.999656 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:35:40.000915 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:35:40.041878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab527495-48a9-4903-90e8-170fc7fe53a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106085a60>]}
[0m00:35:40.045539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab527495-48a9-4903-90e8-170fc7fe53a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eeeb20>]}
[0m00:35:40.045673 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:35:40.045806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab527495-48a9-4903-90e8-170fc7fe53a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef4c40>]}
[0m00:35:40.046533 [info ] [MainThread]: 
[0m00:35:40.046828 [debug] [MainThread]: Acquiring new athena connection "master"
[0m00:35:40.047344 [debug] [ThreadPool]: Acquiring new athena connection "list_globalx"
[0m00:35:40.053979 [debug] [ThreadPool]: Using athena connection "list_globalx"
[0m00:35:40.054126 [debug] [ThreadPool]: On list_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_globalx"} */

    select
        distinct schema_name

    from globalx.INFORMATION_SCHEMA.schemata
  
[0m00:35:40.054262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:57.213355 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_globalx"} */

    select
        distinct schema_name

    from globalx.INFORMATION_SCHEMA.schemata
  
[0m00:36:57.215077 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro list_schemas
[0m00:36:57.215329 [debug] [ThreadPool]: On list_globalx: Close
[0m00:36:57.215894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:36:57.215995 [debug] [MainThread]: Connection 'list_globalx' was properly closed.
[0m00:36:57.216146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060851f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106085220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91d550>]}
[0m00:36:57.216286 [debug] [MainThread]: Flushing usage events
[0m00:36:57.569953 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    Unable to locate credentials


============================== 2024-06-06 00:38:35.486441 | ac8b819a-fa06-449f-a829-ba5244bdada8 ==============================
[0m00:38:35.486465 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:38:35.487553 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:35.487753 [debug] [MainThread]: Tracking: tracking
[0m00:38:35.497924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afc820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae4250>]}
[0m00:38:35.517311 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:38:35.517561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac8b819a-fa06-449f-a829-ba5244bdada8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086be7f0>]}
[0m00:38:35.535156 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:38:35.536220 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:38:35.536810 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:38:35.540867 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:38:35.545581 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:38:35.547030 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:38:35.549022 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:38:35.549513 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:38:35.551171 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:38:35.551416 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:38:35.553241 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:38:35.553851 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:38:35.554058 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:38:35.557850 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:38:35.558570 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:38:35.560245 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:38:35.561359 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:38:35.562128 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:38:35.569489 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:38:35.576011 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:38:35.581889 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:38:35.583937 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:38:35.584741 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:38:35.585543 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:38:35.589479 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:38:35.597146 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:38:35.598006 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:38:35.601138 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:38:35.606220 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:38:35.614583 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:38:35.617171 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:38:35.618767 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:38:35.621461 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:38:35.622072 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:38:35.623593 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:38:35.624612 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:38:35.628001 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:38:35.636896 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:38:35.637638 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:38:35.638720 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:38:35.639404 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:38:35.639803 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:38:35.640155 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:38:35.640454 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:38:35.641056 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:38:35.643441 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:38:35.647505 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:38:35.647916 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:38:35.648481 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:38:35.648921 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:38:35.649329 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:38:35.649886 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:38:35.650239 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:38:35.650688 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:38:35.651433 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:38:35.652488 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:38:35.653035 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:38:35.653502 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:38:35.653996 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:38:35.654441 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:38:35.654842 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:38:35.655310 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:38:35.655703 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:38:35.658690 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:38:35.659152 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:38:35.659556 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:38:35.660358 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:38:35.661341 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:38:35.661790 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:38:35.662443 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:38:35.662906 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:38:35.663835 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:38:35.665268 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:38:35.666487 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:38:35.673197 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:38:35.674061 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:38:35.680130 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:38:35.682077 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:38:35.685272 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:38:35.689686 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:38:35.692479 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:38:35.805092 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:38:35.810826 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:38:35.812176 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:38:35.813402 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:38:35.814592 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:38:35.852755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8b819a-fa06-449f-a829-ba5244bdada8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5c880>]}
[0m00:38:35.856371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8b819a-fa06-449f-a829-ba5244bdada8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af1490>]}
[0m00:38:35.856543 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:38:35.856683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8b819a-fa06-449f-a829-ba5244bdada8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9de50>]}
[0m00:38:35.857436 [info ] [MainThread]: 
[0m00:38:35.857763 [debug] [MainThread]: Acquiring new athena connection "master"
[0m00:38:35.858283 [debug] [ThreadPool]: Acquiring new athena connection "list_globalx"
[0m00:38:35.865216 [debug] [ThreadPool]: Using athena connection "list_globalx"
[0m00:38:35.865352 [debug] [ThreadPool]: On list_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_globalx"} */

    select
        distinct schema_name

    from globalx.INFORMATION_SCHEMA.schemata
  
[0m00:38:35.865426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:10.589544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:10.591471 [debug] [MainThread]: Connection 'list_globalx' was left open.
[0m00:39:10.592007 [debug] [MainThread]: On list_globalx: Close
[0m00:39:10.592242 [debug] [MainThread]: Flushing usage events
[0m00:39:10.789548 [info ] [MainThread]: ctrl-c


============================== 2024-06-06 00:40:23.388713 | 572ad331-98f1-4ad7-88a7-3fe2bd8cef3a ==============================
[0m00:40:23.388732 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:40:23.389292 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:40:23.389386 [debug] [MainThread]: Tracking: tracking
[0m00:40:23.407848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105046c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105049130>]}
[0m00:40:23.444948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:40:23.445091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:40:23.448574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '572ad331-98f1-4ad7-88a7-3fe2bd8cef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052070d0>]}
[0m00:40:23.452386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '572ad331-98f1-4ad7-88a7-3fe2bd8cef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051529d0>]}
[0m00:40:23.452550 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:40:23.452692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '572ad331-98f1-4ad7-88a7-3fe2bd8cef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105049eb0>]}
[0m00:40:23.453439 [info ] [MainThread]: 
[0m00:40:23.453750 [debug] [MainThread]: Acquiring new athena connection "master"
[0m00:40:23.454291 [debug] [ThreadPool]: Acquiring new athena connection "list_globalx"
[0m00:40:23.461166 [debug] [ThreadPool]: Using athena connection "list_globalx"
[0m00:40:23.461311 [debug] [ThreadPool]: On list_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_globalx"} */

    select
        distinct schema_name

    from globalx.INFORMATION_SCHEMA.schemata
  
[0m00:40:23.461386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:34.951935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:34.953248 [debug] [MainThread]: Connection 'list_globalx' was left open.
[0m00:40:34.953425 [debug] [MainThread]: On list_globalx: Close
[0m00:40:34.953520 [debug] [MainThread]: Flushing usage events
[0m00:40:35.111462 [info ] [MainThread]: ctrl-c


============================== 2024-06-06 00:44:57.072759 | a35ec9e2-2ba3-4bc9-a30c-9100a26c0246 ==============================
[0m00:44:57.072767 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:44:57.073199 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:44:57.073287 [debug] [MainThread]: Tracking: tracking
[0m00:44:57.085747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041be0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041befd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b2160>]}
[0m00:44:57.175906 [debug] [MainThread]: Executing "git --help"
[0m00:44:57.188684 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:44:57.189032 [debug] [MainThread]: STDERR: "b''"
[0m00:44:57.194347 [debug] [MainThread]: Acquiring new athena connection "debug"
[0m00:44:57.194874 [debug] [MainThread]: Using athena connection "debug"
[0m00:44:57.194986 [debug] [MainThread]: On debug: select 1 as id
[0m00:44:57.195111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:54.799010 [debug] [MainThread]: On debug: Close
[0m00:45:54.799988 [debug] [MainThread]: Flushing usage events
[0m00:45:55.019861 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:45:55.020496 [info ] [MainThread]: ctrl-c


============================== 2024-06-06 00:48:51.949392 | 190faf05-54e9-46d9-9a25-5b3ad58df0a8 ==============================
[0m00:48:51.949398 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:48:51.949786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:48:51.949860 [debug] [MainThread]: Tracking: tracking
[0m00:48:51.961633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d62190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d62f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d56340>]}
[0m00:48:52.050595 [debug] [MainThread]: Executing "git --help"
[0m00:48:52.061956 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:48:52.062319 [debug] [MainThread]: STDERR: "b''"
[0m00:48:52.066986 [debug] [MainThread]: Acquiring new athena connection "debug"
[0m00:48:52.067429 [debug] [MainThread]: Using athena connection "debug"
[0m00:48:52.067587 [debug] [MainThread]: On debug: select 1 as id
[0m00:48:52.067749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:48:53.991677 [debug] [MainThread]: SQL status: OK -1 in 1.92 seconds
[0m00:48:53.995174 [debug] [MainThread]: On debug: Close
[0m00:48:53.995853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062120d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061accd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ace80>]}
[0m00:48:53.996230 [debug] [MainThread]: Flushing usage events
[0m00:48:54.231397 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-06-06 00:49:34.438328 | 660839ca-989f-4682-bc14-7673c27e4963 ==============================
[0m00:49:34.438346 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:49:34.438934 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:49:34.439064 [debug] [MainThread]: Tracking: tracking
[0m00:49:34.449055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106734220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106734f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106740220>]}
[0m00:49:34.467387 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:49:34.467630 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:49:34.467759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '660839ca-989f-4682-bc14-7673c27e4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630e670>]}
[0m00:49:34.487349 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:49:34.488540 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:49:34.489075 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:49:34.492922 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:49:34.497487 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:49:34.498747 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:49:34.500689 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:49:34.501173 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:49:34.502818 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:49:34.503055 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:49:34.504793 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:49:34.505320 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:49:34.505493 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:49:34.509130 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:49:34.509822 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:49:34.511504 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:49:34.512567 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:49:34.513290 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:49:34.520544 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:49:34.526742 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:49:34.532407 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:49:34.534412 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:49:34.535196 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:49:34.535983 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:49:34.539569 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:49:34.547139 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:49:34.547862 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:49:34.550880 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:49:34.555727 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:49:34.563745 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:49:34.566234 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:49:34.567818 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:49:34.570281 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:49:34.570856 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:49:34.572352 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:49:34.573345 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:49:34.576497 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:49:34.585217 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:49:34.585881 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:49:34.586966 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:49:34.587647 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:49:34.588045 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:49:34.588395 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:49:34.588695 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:49:34.589295 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:49:34.591684 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:49:34.595457 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:49:34.595812 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:49:34.596346 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:49:34.596759 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:49:34.597167 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:49:34.597715 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:49:34.598067 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:49:34.598527 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:49:34.599210 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:49:34.600231 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:49:34.600765 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:49:34.601231 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:49:34.601689 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:49:34.602134 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:49:34.602533 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:49:34.602999 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:49:34.603396 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:49:34.606364 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:49:34.606826 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:49:34.607230 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:49:34.608013 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:49:34.608987 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:49:34.609438 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:49:34.610094 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:49:34.610556 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:49:34.611482 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:49:34.612921 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:49:34.614136 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:49:34.620807 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:49:34.621669 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:49:34.627713 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:49:34.629641 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:49:34.632808 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:49:34.637207 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:49:34.639988 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:49:34.757067 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:49:34.762790 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:49:34.764154 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:49:34.765387 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:49:34.766574 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:49:34.803977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '660839ca-989f-4682-bc14-7673c27e4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069102b0>]}
[0m00:49:34.807600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '660839ca-989f-4682-bc14-7673c27e4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b0370>]}
[0m00:49:34.807734 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:49:34.807857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '660839ca-989f-4682-bc14-7673c27e4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675c730>]}
[0m00:49:34.808564 [info ] [MainThread]: 
[0m00:49:34.808852 [debug] [MainThread]: Acquiring new athena connection "master"
[0m00:49:34.809335 [debug] [ThreadPool]: Acquiring new athena connection "list_globalx"
[0m00:49:34.815678 [debug] [ThreadPool]: Using athena connection "list_globalx"
[0m00:49:34.815811 [debug] [ThreadPool]: On list_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_globalx"} */

    select
        distinct schema_name

    from globalx.INFORMATION_SCHEMA.schemata
  
[0m00:49:34.815883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:57.655837 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_globalx"} */

    select
        distinct schema_name

    from globalx.INFORMATION_SCHEMA.schemata
  
[0m00:50:57.656400 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro list_schemas
[0m00:50:57.656715 [debug] [ThreadPool]: On list_globalx: Close
[0m00:50:57.657863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:57.658045 [debug] [MainThread]: Connection 'list_globalx' was properly closed.
[0m00:50:57.658300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106910bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c67bd60>]}
[0m00:50:57.658564 [debug] [MainThread]: Flushing usage events
[0m00:50:58.324319 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    CATALOG_NOT_FOUND: line 4:6: Catalog 'globalx' does not exist


============================== 2024-06-06 00:55:19.224536 | 5ee9f9aa-001b-41fa-81f5-3337ca6af72b ==============================
[0m00:55:19.224545 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:55:19.225016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:55:19.225101 [debug] [MainThread]: Tracking: tracking
[0m00:55:19.235683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fda100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fdafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fce430>]}
[0m00:55:19.319468 [debug] [MainThread]: Executing "git --help"
[0m00:55:19.331833 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:55:19.332189 [debug] [MainThread]: STDERR: "b''"
[0m00:55:19.336726 [debug] [MainThread]: Acquiring new athena connection "debug"
[0m00:55:19.337201 [debug] [MainThread]: Using athena connection "debug"
[0m00:55:19.337295 [debug] [MainThread]: On debug: select 1 as id
[0m00:55:19.337394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:21.173789 [debug] [MainThread]: SQL status: OK -1 in 1.84 seconds
[0m00:55:21.175793 [debug] [MainThread]: On debug: Close
[0m00:55:21.176279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195950a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119532610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119532b20>]}
[0m00:55:21.176572 [debug] [MainThread]: Flushing usage events
[0m00:55:21.383144 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-06-06 00:55:24.395167 | 9f4db050-7cc0-441e-9d0a-bd684cef4946 ==============================
[0m00:55:24.395186 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:55:24.395511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:55:24.395637 [debug] [MainThread]: Tracking: tracking
[0m00:55:24.404174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083cc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ccfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c9f70>]}
[0m00:55:24.423352 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:55:24.423630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f4db050-7cc0-441e-9d0a-bd684cef4946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9a610>]}
[0m00:55:24.441430 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:55:24.442443 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m00:55:24.442989 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m00:55:24.446832 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:55:24.451752 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:55:24.453176 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:55:24.455193 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:55:24.455703 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:55:24.457417 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:55:24.457677 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:55:24.459500 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:55:24.460059 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:55:24.460245 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:55:24.464017 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:55:24.464741 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:55:24.466488 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:55:24.467601 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:55:24.468361 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:55:24.476085 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:55:24.482377 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:55:24.488041 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:55:24.490038 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:55:24.490833 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:55:24.491624 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:55:24.495201 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:55:24.502564 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:55:24.503237 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:55:24.506228 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:55:24.510961 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:55:24.519074 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:55:24.521576 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:55:24.523146 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:55:24.525672 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:55:24.526251 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:55:24.527737 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:55:24.528735 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:55:24.531887 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:55:24.540431 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:55:24.541083 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:55:24.542156 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:55:24.542836 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:55:24.543243 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:55:24.543597 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:55:24.543896 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:55:24.544496 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:55:24.546835 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:55:24.550611 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:55:24.550972 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:55:24.551506 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:55:24.551927 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:55:24.552331 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:55:24.552876 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:55:24.553230 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:55:24.553677 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:55:24.554371 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:55:24.555393 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:55:24.555927 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:55:24.556394 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:55:24.556857 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:55:24.557307 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:55:24.557704 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:55:24.558174 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:55:24.558571 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:55:24.561608 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:55:24.562078 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:55:24.562488 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:55:24.563272 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:55:24.564263 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:55:24.564723 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:55:24.565382 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:55:24.565844 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:55:24.566768 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:55:24.568202 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:55:24.569421 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:55:24.576139 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:55:24.577014 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:55:24.583059 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:55:24.585024 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:55:24.588186 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:55:24.592583 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:55:24.595337 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:55:24.711484 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m00:55:24.717091 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m00:55:24.718460 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m00:55:24.719697 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:55:24.720893 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:55:24.757883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f4db050-7cc0-441e-9d0a-bd684cef4946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108446fd0>]}
[0m00:55:24.761333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f4db050-7cc0-441e-9d0a-bd684cef4946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085170a0>]}
[0m00:55:24.761477 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:55:24.761605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f4db050-7cc0-441e-9d0a-bd684cef4946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f4370>]}
[0m00:55:24.762276 [info ] [MainThread]: 
[0m00:55:24.762566 [debug] [MainThread]: Acquiring new athena connection "master"
[0m00:55:24.763068 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m00:55:24.769616 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m00:55:24.769778 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m00:55:24.769861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:46.806434 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m00:56:46.808687 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro list_schemas
[0m00:56:46.809110 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m00:56:46.810526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:46.810764 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m00:56:46.811103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108446b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108446970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108589fd0>]}
[0m00:56:46.811460 [debug] [MainThread]: Flushing usage events
[0m00:56:47.195757 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    Insufficient permissions to execute the query. Error listing schemas for catalog awsdatacatalog: User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetDatabases on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:GetDatabases action 


============================== 2024-06-06 01:00:13.887499 | 4fb24256-b355-4976-b52b-8408d60a931d ==============================
[0m01:00:13.887520 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:00:13.888379 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:00:13.888542 [debug] [MainThread]: Tracking: tracking
[0m01:00:13.903578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b87340>]}
[0m01:00:13.939059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:13.939196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:13.942635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb24256-b355-4976-b52b-8408d60a931d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d490d0>]}
[0m01:00:13.946401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb24256-b355-4976-b52b-8408d60a931d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8e9d0>]}
[0m01:00:13.946543 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:00:13.946672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb24256-b355-4976-b52b-8408d60a931d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b876a0>]}
[0m01:00:13.947375 [info ] [MainThread]: 
[0m01:00:13.947666 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:00:13.948177 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:00:13.954593 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:00:13.954712 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:00:13.954779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:23.019985 [debug] [ThreadPool]: SQL status: OK -1 in 9.07 seconds
[0m01:00:23.022609 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:00:23.023702 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:00:23.024853 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:00:23.024984 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:00:23.029726 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:00:23.029883 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:00:23.029957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:50.763109 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:01:50.764239 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro create_schema
[0m01:01:50.764392 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:01:50.765069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:50.765151 [debug] [MainThread]: Connection 'create_AwsDataCatalog_default_globalx' was properly closed.
[0m01:01:50.765308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d787f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d786d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d78520>]}
[0m01:01:50.765439 [debug] [MainThread]: Flushing usage events
[0m01:01:51.081807 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:CreateDatabase on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:CreateDatabase action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 03b04a6c-46d2-47fe-85a3-37f59ab62985; Proxy: null))


============================== 2024-06-06 01:03:47.426078 | 420e919e-6c9c-40c8-8042-5881a9a83af5 ==============================
[0m01:03:47.426095 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:03:47.426572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:03:47.426668 [debug] [MainThread]: Tracking: tracking
[0m01:03:47.437634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222cc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222ccca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222c77c0>]}
[0m01:03:47.471723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:03:47.471871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:03:47.475295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '420e919e-6c9c-40c8-8042-5881a9a83af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225880d0>]}
[0m01:03:47.479366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '420e919e-6c9c-40c8-8042-5881a9a83af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224d2a00>]}
[0m01:03:47.479515 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:03:47.479651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '420e919e-6c9c-40c8-8042-5881a9a83af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222c7760>]}
[0m01:03:47.480379 [info ] [MainThread]: 
[0m01:03:47.480678 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:03:47.481215 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:03:47.487741 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:03:47.487880 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:03:47.487948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:49.211418 [debug] [ThreadPool]: SQL status: OK -1 in 1.72 seconds
[0m01:03:49.215126 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:03:49.216670 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:03:49.219599 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:03:49.219935 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:03:49.226067 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:03:49.226282 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:03:49.226419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:13.300719 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:05:13.301871 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro create_schema
[0m01:05:13.302027 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:05:13.302629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:13.302707 [debug] [MainThread]: Connection 'create_AwsDataCatalog_default_globalx' was properly closed.
[0m01:05:13.302821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a98df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a98e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a98dc0>]}
[0m01:05:13.302945 [debug] [MainThread]: Flushing usage events
[0m01:05:13.561118 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:CreateDatabase on resource: arn:aws:glue:us-east-2:975050278905:database/default_globalx because no identity-based policy allows the glue:CreateDatabase action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: ded1fc98-e752-45fe-a0c2-05c90d9dcb41; Proxy: null))


============================== 2024-06-06 01:06:24.408682 | 78af4b28-abc6-484a-aff6-9b6d39c13bcd ==============================
[0m01:06:24.408699 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:06:24.409181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:06:24.409275 [debug] [MainThread]: Tracking: tracking
[0m01:06:24.417935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046401f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104640fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464c100>]}
[0m01:06:24.454082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:24.454227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:24.457644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78af4b28-abc6-484a-aff6-9b6d39c13bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047fb0d0>]}
[0m01:06:24.461118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78af4b28-abc6-484a-aff6-9b6d39c13bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047469d0>]}
[0m01:06:24.461264 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:06:24.461398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78af4b28-abc6-484a-aff6-9b6d39c13bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464c550>]}
[0m01:06:24.462131 [info ] [MainThread]: 
[0m01:06:24.462426 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:06:24.462955 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:06:24.469278 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:06:24.469388 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:06:24.469462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:26.233628 [debug] [ThreadPool]: SQL status: OK -1 in 1.76 seconds
[0m01:06:26.237396 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:06:26.238890 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:06:26.241681 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:06:26.241997 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:06:26.247994 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:06:26.248173 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:06:26.248314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:27.893391 [debug] [ThreadPool]: SQL status: OK -1 in 1.65 seconds
[0m01:06:27.896279 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:06:27.899074 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m01:06:27.908778 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m01:06:27.908990 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m01:06:27.909136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:29.647300 [debug] [ThreadPool]: SQL status: OK -1 in 1.74 seconds
[0m01:06:29.649037 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m01:06:29.649591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78af4b28-abc6-484a-aff6-9b6d39c13bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104668370>]}
[0m01:06:29.650203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:06:29.650437 [info ] [MainThread]: 
[0m01:06:29.652832 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m01:06:29.652999 [debug] [Thread-2  ]: Began running node model.global_x_task.my_first_dbt_model
[0m01:06:29.653222 [info ] [Thread-1  ]: 1 of 5 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m01:06:29.653407 [info ] [Thread-2  ]: 2 of 5 START sql table model default_globalx.my_first_dbt_model ................ [RUN]
[0m01:06:29.653879 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m01:06:29.654334 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.my_first_dbt_model"
[0m01:06:29.654657 [debug] [Thread-2  ]: Began compiling node model.global_x_task.my_first_dbt_model
[0m01:06:29.655877 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m01:06:29.656003 [debug] [Thread-2  ]: Compiling model.global_x_task.my_first_dbt_model
[0m01:06:29.656128 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m01:06:29.658953 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.my_first_dbt_model"
[0m01:06:29.660867 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m01:06:29.661529 [debug] [Thread-1  ]: finished collecting timing info
[0m01:06:29.661634 [debug] [Thread-2  ]: finished collecting timing info
[0m01:06:29.661726 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m01:06:29.661832 [debug] [Thread-2  ]: Began executing node model.global_x_task.my_first_dbt_model
[0m01:06:29.674436 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m01:06:29.687367 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.my_first_dbt_model"
[0m01:06:29.687937 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m01:06:29.688024 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:06:29.688126 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.my_first_dbt_model"
[0m01:06:29.688177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:06:29.688250 [debug] [Thread-2  ]: On model.global_x_task.my_first_dbt_model: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.my_first_dbt_model"} */

  
    create table
    default_globalx.my_first_dbt_model

    with (
        format='parquet'
    )
  as
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null

  
  
[0m01:06:29.692768 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:07:51.478182 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:07:51.478921 [debug] [Thread-1  ]: finished collecting timing info
[0m01:07:51.479202 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m01:07:51.480028 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 97b8f820-7cdf-4da4-91b3-464d1d4f437a; Proxy: null)
[0m01:07:51.480345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78af4b28-abc6-484a-aff6-9b6d39c13bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbda60>]}
[0m01:07:51.480819 [error] [Thread-1  ]: 1 of 5 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.83s]
[0m01:07:51.481314 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m01:07:51.481875 [debug] [Thread-4  ]: Began running node model.global_x_task.fred_unemp
[0m01:07:51.482145 [debug] [Thread-3  ]: Began running node model.global_x_task.polygon
[0m01:07:51.482321 [info ] [Thread-4  ]: 3 of 5 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m01:07:51.482557 [info ] [Thread-3  ]: 4 of 5 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m01:07:51.482945 [debug] [Thread-4  ]: Finished running node model.global_x_task.fred_unemp
[0m01:07:51.483283 [debug] [Thread-3  ]: Finished running node model.global_x_task.polygon
[0m01:07:52.487227 [debug] [Thread-2  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.my_first_dbt_model"} */

  
    create table
    default_globalx.my_first_dbt_model

    with (
        format='parquet'
    )
  as
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null

  
  
[0m01:07:52.487817 [debug] [Thread-2  ]: finished collecting timing info
[0m01:07:52.488055 [debug] [Thread-2  ]: On model.global_x_task.my_first_dbt_model: Close
[0m01:07:52.488765 [debug] [Thread-2  ]: Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Insufficient permissions to execute the query. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:CreateTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:CreateTable action . You may need to manually clean the data at location 's3://global-x-task/athena-results/tables/003ace58-3312-474d-8b8e-647595794a96' before retrying. Athena will not delete data in your account.
[0m01:07:52.489072 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78af4b28-abc6-484a-aff6-9b6d39c13bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab16af0>]}
[0m01:07:52.489662 [error] [Thread-2  ]: 2 of 5 ERROR creating sql table model default_globalx.my_first_dbt_model ....... [[31mERROR[0m in 82.83s]
[0m01:07:52.490087 [debug] [Thread-2  ]: Finished running node model.global_x_task.my_first_dbt_model
[0m01:07:52.490849 [debug] [Thread-1  ]: Began running node model.global_x_task.my_second_dbt_model
[0m01:07:52.491022 [info ] [Thread-1  ]: 5 of 5 SKIP relation default_globalx.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m01:07:52.491351 [debug] [Thread-1  ]: Finished running node model.global_x_task.my_second_dbt_model
[0m01:07:52.492739 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:07:52.493349 [info ] [MainThread]: 
[0m01:07:52.493615 [info ] [MainThread]: Finished running 2 view models, 3 table models in 0 hours 1 minutes and 28.03 seconds (88.03s).
[0m01:07:52.493833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:52.493948 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m01:07:52.494063 [debug] [MainThread]: Connection 'model.global_x_task.my_first_dbt_model' was properly closed.
[0m01:07:52.501060 [info ] [MainThread]: 
[0m01:07:52.501330 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:07:52.501556 [info ] [MainThread]: 
[0m01:07:52.501738 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m01:07:52.501918 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 97b8f820-7cdf-4da4-91b3-464d1d4f437a; Proxy: null)
[0m01:07:52.502093 [info ] [MainThread]: 
[0m01:07:52.502262 [error] [MainThread]: [33mRuntime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)[0m
[0m01:07:52.502428 [error] [MainThread]:   Insufficient permissions to execute the query. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:CreateTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:CreateTable action . You may need to manually clean the data at location 's3://global-x-task/athena-results/tables/003ace58-3312-474d-8b8e-647595794a96' before retrying. Athena will not delete data in your account.
[0m01:07:52.502725 [info ] [MainThread]: 
[0m01:07:52.502925 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m01:07:52.503182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab16040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab9aa60>]}
[0m01:07:52.503390 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 01:19:36.807231 | be771837-0097-4bd9-aa8d-e842daa4deb0 ==============================
[0m01:19:36.807251 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:19:36.808035 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:19:36.808158 [debug] [MainThread]: Tracking: tracking
[0m01:19:36.823988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12584c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12584c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125855310>]}
[0m01:19:36.861796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:36.861974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:36.865966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be771837-0097-4bd9-aa8d-e842daa4deb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a070d0>]}
[0m01:19:36.870603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be771837-0097-4bd9-aa8d-e842daa4deb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259529a0>]}
[0m01:19:36.870788 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:19:36.870932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be771837-0097-4bd9-aa8d-e842daa4deb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125855e80>]}
[0m01:19:36.871693 [info ] [MainThread]: 
[0m01:19:36.872023 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:19:36.872583 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:19:36.879954 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:19:36.880144 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:19:36.880231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:38.690432 [debug] [ThreadPool]: SQL status: OK -1 in 1.81 seconds
[0m01:19:38.692913 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:19:38.694126 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:19:38.695286 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:19:38.695419 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:19:38.697884 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:19:38.697991 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:19:38.698061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:02.494365 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:21:02.494986 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro create_schema
[0m01:21:02.495123 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:21:02.495762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:02.495861 [debug] [MainThread]: Connection 'create_AwsDataCatalog_default_globalx' was properly closed.
[0m01:21:02.495986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126216130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126216100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126216460>]}
[0m01:21:02.496157 [debug] [MainThread]: Flushing usage events
[0m01:21:02.803538 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:CreateDatabase on resource: arn:aws:glue:us-east-2:975050278905:database/default_globalx because no identity-based policy allows the glue:CreateDatabase action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: d7903b47-2429-472e-ade1-7ee0f6731c49; Proxy: null))


============================== 2024-06-06 01:22:11.821089 | 4429bc76-ad80-4cf6-8859-a51be0d44670 ==============================
[0m01:22:11.821116 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:22:11.821649 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:22:11.821742 [debug] [MainThread]: Tracking: tracking
[0m01:22:11.829927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872c970>]}
[0m01:22:11.865020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:22:11.865182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:22:11.868801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4429bc76-ad80-4cf6-8859-a51be0d44670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d10d0>]}
[0m01:22:11.872294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4429bc76-ad80-4cf6-8859-a51be0d44670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881b970>]}
[0m01:22:11.872429 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:22:11.872562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4429bc76-ad80-4cf6-8859-a51be0d44670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881b9a0>]}
[0m01:22:11.873296 [info ] [MainThread]: 
[0m01:22:11.873594 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:22:11.874110 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:22:11.880514 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:22:11.880639 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:22:11.880708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:13.557460 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m01:22:13.561087 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:22:13.562691 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:22:13.565230 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:22:13.565528 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:22:13.571440 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:22:13.571617 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:22:13.571760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:15.131032 [debug] [ThreadPool]: SQL status: OK -1 in 1.56 seconds
[0m01:22:15.131809 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:22:15.132845 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m01:22:15.137566 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m01:22:15.137740 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m01:22:15.137813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:16.803419 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m01:22:16.806335 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m01:22:16.806863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4429bc76-ad80-4cf6-8859-a51be0d44670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872c2e0>]}
[0m01:22:16.807365 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:22:16.807580 [info ] [MainThread]: 
[0m01:22:16.810138 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m01:22:16.810267 [debug] [Thread-2  ]: Began running node model.global_x_task.my_first_dbt_model
[0m01:22:16.810431 [info ] [Thread-1  ]: 1 of 5 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m01:22:16.810547 [info ] [Thread-2  ]: 2 of 5 START sql table model default_globalx.my_first_dbt_model ................ [RUN]
[0m01:22:16.810878 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m01:22:16.811143 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.my_first_dbt_model"
[0m01:22:16.812054 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m01:22:16.812135 [debug] [Thread-2  ]: Began compiling node model.global_x_task.my_first_dbt_model
[0m01:22:16.812212 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m01:22:16.812276 [debug] [Thread-2  ]: Compiling model.global_x_task.my_first_dbt_model
[0m01:22:16.814291 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m01:22:16.817742 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.my_first_dbt_model"
[0m01:22:16.818442 [debug] [Thread-2  ]: finished collecting timing info
[0m01:22:16.818566 [debug] [Thread-1  ]: finished collecting timing info
[0m01:22:16.818711 [debug] [Thread-2  ]: Began executing node model.global_x_task.my_first_dbt_model
[0m01:22:16.818903 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m01:22:16.830721 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.my_first_dbt_model"
[0m01:22:16.837885 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m01:22:16.838296 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.my_first_dbt_model"
[0m01:22:16.838377 [debug] [Thread-2  ]: On model.global_x_task.my_first_dbt_model: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.my_first_dbt_model"} */

  
    create table
    default_globalx.my_first_dbt_model

    with (
        format='parquet'
    )
  as
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null

  
  
[0m01:22:16.838446 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:22:16.844115 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m01:22:16.844350 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:22:16.844790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:23:38.573657 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:23:38.575571 [debug] [Thread-1  ]: finished collecting timing info
[0m01:23:38.575854 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m01:23:38.576549 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:table/default/integrated_etf_data because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1655471e-5950-4c46-a128-9e4351129370; Proxy: null)
[0m01:23:38.576844 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4429bc76-ad80-4cf6-8859-a51be0d44670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a67b490>]}
[0m01:23:38.577301 [error] [Thread-1  ]: 1 of 5 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.77s]
[0m01:23:38.577801 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m01:23:38.578346 [debug] [Thread-4  ]: Began running node model.global_x_task.fred_unemp
[0m01:23:38.578518 [debug] [Thread-3  ]: Began running node model.global_x_task.polygon
[0m01:23:38.578839 [info ] [Thread-4  ]: 3 of 5 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m01:23:38.579053 [info ] [Thread-3  ]: 4 of 5 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m01:23:38.579433 [debug] [Thread-4  ]: Finished running node model.global_x_task.fred_unemp
[0m01:23:38.579771 [debug] [Thread-3  ]: Finished running node model.global_x_task.polygon
[0m01:23:39.540055 [debug] [Thread-2  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.my_first_dbt_model"} */

  
    create table
    default_globalx.my_first_dbt_model

    with (
        format='parquet'
    )
  as
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null

  
  
[0m01:23:39.540495 [debug] [Thread-2  ]: finished collecting timing info
[0m01:23:39.540646 [debug] [Thread-2  ]: On model.global_x_task.my_first_dbt_model: Close
[0m01:23:39.541174 [debug] [Thread-2  ]: Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Insufficient permissions to execute the query. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:CreateTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_globalx because no identity-based policy allows the glue:CreateTable action . You may need to manually clean the data at location 's3://global-x-task/athena-results/tables/ed05fc30-13df-4776-934d-f7cb2ed451ef' before retrying. Athena will not delete data in your account.
[0m01:23:39.541480 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4429bc76-ad80-4cf6-8859-a51be0d44670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b314460>]}
[0m01:23:39.541815 [error] [Thread-2  ]: 2 of 5 ERROR creating sql table model default_globalx.my_first_dbt_model ....... [[31mERROR[0m in 82.73s]
[0m01:23:39.542170 [debug] [Thread-2  ]: Finished running node model.global_x_task.my_first_dbt_model
[0m01:23:39.542620 [debug] [Thread-1  ]: Began running node model.global_x_task.my_second_dbt_model
[0m01:23:39.542804 [info ] [Thread-1  ]: 5 of 5 SKIP relation default_globalx.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m01:23:39.543063 [debug] [Thread-1  ]: Finished running node model.global_x_task.my_second_dbt_model
[0m01:23:39.543980 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:23:39.544395 [info ] [MainThread]: 
[0m01:23:39.544588 [info ] [MainThread]: Finished running 2 view models, 3 table models in 0 hours 1 minutes and 27.67 seconds (87.67s).
[0m01:23:39.544757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:39.544846 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m01:23:39.544930 [debug] [MainThread]: Connection 'model.global_x_task.my_first_dbt_model' was properly closed.
[0m01:23:39.551741 [info ] [MainThread]: 
[0m01:23:39.551994 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:23:39.552183 [info ] [MainThread]: 
[0m01:23:39.552345 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m01:23:39.552600 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:table/default/integrated_etf_data because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1655471e-5950-4c46-a128-9e4351129370; Proxy: null)
[0m01:23:39.552825 [info ] [MainThread]: 
[0m01:23:39.552992 [error] [MainThread]: [33mRuntime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)[0m
[0m01:23:39.553147 [error] [MainThread]:   Insufficient permissions to execute the query. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:CreateTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_globalx because no identity-based policy allows the glue:CreateTable action . You may need to manually clean the data at location 's3://global-x-task/athena-results/tables/ed05fc30-13df-4776-934d-f7cb2ed451ef' before retrying. Athena will not delete data in your account.
[0m01:23:39.553312 [info ] [MainThread]: 
[0m01:23:39.553465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m01:23:39.553704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b314970>]}
[0m01:23:39.553900 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 01:25:02.519568 | a1ccb0c9-697d-455f-a73a-48bfe53cc376 ==============================
[0m01:25:02.519583 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:25:02.519917 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:25:02.520013 [debug] [MainThread]: Tracking: tracking
[0m01:25:02.528910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106938220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106938f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106935490>]}
[0m01:25:02.556352 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m01:25:02.556547 [debug] [MainThread]: Partial parsing: deleted file: global_x_task://models/example/my_second_dbt_model.sql
[0m01:25:02.556618 [debug] [MainThread]: Partial parsing: deleted file: global_x_task://models/example/my_first_dbt_model.sql
[0m01:25:02.566150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1ccb0c9-697d-455f-a73a-48bfe53cc376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b020d0>]}
[0m01:25:02.569546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1ccb0c9-697d-455f-a73a-48bfe53cc376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa94c0>]}
[0m01:25:02.569695 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:25:02.569837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1ccb0c9-697d-455f-a73a-48bfe53cc376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106935d00>]}
[0m01:25:02.570493 [info ] [MainThread]: 
[0m01:25:02.570795 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:25:02.571268 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:25:02.577730 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:25:02.577920 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:25:02.578001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:04.353070 [debug] [ThreadPool]: SQL status: OK -1 in 1.77 seconds
[0m01:25:04.357181 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:25:04.358676 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:25:04.361602 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:25:04.361945 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:25:04.367916 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:25:04.368087 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:25:04.368222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:05.998971 [debug] [ThreadPool]: SQL status: OK -1 in 1.63 seconds
[0m01:25:06.001983 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:25:06.005147 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m01:25:06.015774 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m01:25:06.015993 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m01:25:06.016142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:07.762165 [debug] [ThreadPool]: SQL status: OK -1 in 1.75 seconds
[0m01:25:07.765655 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m01:25:07.766884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1ccb0c9-697d-455f-a73a-48bfe53cc376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a655e0>]}
[0m01:25:07.767812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:25:07.768205 [info ] [MainThread]: 
[0m01:25:07.771614 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m01:25:07.771984 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m01:25:07.772673 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m01:25:07.774917 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m01:25:07.775156 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m01:25:07.779029 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m01:25:07.779900 [debug] [Thread-1  ]: finished collecting timing info
[0m01:25:07.780074 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m01:25:07.795775 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m01:25:07.796307 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m01:25:07.796425 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:25:07.796526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:26:29.541446 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:26:29.542054 [debug] [Thread-1  ]: finished collecting timing info
[0m01:26:29.542293 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m01:26:29.543046 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  line 23:6: Table '975050278905.default.integrated_etf_data' does not exist
[0m01:26:29.543424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1ccb0c9-697d-455f-a73a-48bfe53cc376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5d20d0>]}
[0m01:26:29.543891 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.77s]
[0m01:26:29.544380 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m01:26:29.545100 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m01:26:29.545378 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m01:26:29.545537 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m01:26:29.545754 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m01:26:29.546100 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m01:26:29.546384 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m01:26:29.547809 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:26:29.548391 [info ] [MainThread]: 
[0m01:26:29.548653 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 26.98 seconds (86.98s).
[0m01:26:29.548867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:29.548988 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m01:26:29.555985 [info ] [MainThread]: 
[0m01:26:29.556229 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:26:29.556375 [info ] [MainThread]: 
[0m01:26:29.556497 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m01:26:29.556634 [error] [MainThread]:   line 23:6: Table '975050278905.default.integrated_etf_data' does not exist
[0m01:26:29.556753 [info ] [MainThread]: 
[0m01:26:29.556869 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:26:29.557096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b76940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a658e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5d2eb0>]}
[0m01:26:29.557318 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 01:32:38.364862 | 9f1ade29-1ff9-4691-8b30-075124e3f703 ==============================
[0m01:32:38.364882 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:32:38.365377 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:32:38.365473 [debug] [MainThread]: Tracking: tracking
[0m01:32:38.374953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104794430>]}
[0m01:32:38.410864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:32:38.411219 [debug] [MainThread]: Partial parsing: deleted source source.global_x_task.global_x_task.integrated_etf_data
[0m01:32:38.411300 [debug] [MainThread]: Partial parsing: update schema file: global_x_task://models/source.yml
[0m01:32:38.418505 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m01:32:38.424990 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m01:32:38.426278 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m01:32:38.442200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f1ade29-1ff9-4691-8b30-075124e3f703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b1fa0>]}
[0m01:32:38.445437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f1ade29-1ff9-4691-8b30-075124e3f703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fdf70>]}
[0m01:32:38.445593 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:32:38.445733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1ade29-1ff9-4691-8b30-075124e3f703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d5aa30>]}
[0m01:32:38.446325 [info ] [MainThread]: 
[0m01:32:38.446625 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:32:38.447114 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:32:38.453461 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:32:38.453607 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:32:38.453685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:40.262292 [debug] [ThreadPool]: SQL status: OK -1 in 1.81 seconds
[0m01:32:40.266150 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:32:40.267675 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:32:40.270779 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:32:40.271063 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:32:40.277057 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:32:40.277270 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:32:40.277413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:41.899980 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m01:32:41.900952 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:32:41.902190 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m01:32:41.908418 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m01:32:41.908581 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m01:32:41.908690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:43.573358 [debug] [ThreadPool]: SQL status: OK -1 in 1.66 seconds
[0m01:32:43.576817 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m01:32:43.577995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1ade29-1ff9-4691-8b30-075124e3f703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106366dc0>]}
[0m01:32:43.578831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:32:43.579214 [info ] [MainThread]: 
[0m01:32:43.583598 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m01:32:43.583964 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m01:32:43.584616 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m01:32:43.586800 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m01:32:43.587057 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m01:32:43.590990 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m01:32:43.591725 [debug] [Thread-1  ]: finished collecting timing info
[0m01:32:43.591915 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m01:32:43.608336 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m01:32:43.608900 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m01:32:43.609016 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from global_x_task.integrated_etf_data

[0m01:32:43.609145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:34:06.628031 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from global_x_task.integrated_etf_data

[0m01:34:06.628763 [debug] [Thread-1  ]: finished collecting timing info
[0m01:34:06.629048 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m01:34:06.629879 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/global_x_task because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: e18b7794-f629-460b-81c6-50f44756b64f; Proxy: null)
[0m01:34:06.630246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1ade29-1ff9-4691-8b30-075124e3f703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d4f40>]}
[0m01:34:06.630736 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 83.05s]
[0m01:34:06.631219 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m01:34:06.632045 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m01:34:06.632221 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m01:34:06.632479 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m01:34:06.632698 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m01:34:06.633082 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m01:34:06.633429 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m01:34:06.634949 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:34:06.635608 [info ] [MainThread]: 
[0m01:34:06.635917 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 28.19 seconds (88.19s).
[0m01:34:06.636154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:06.636271 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m01:34:06.643606 [info ] [MainThread]: 
[0m01:34:06.643892 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:34:06.644095 [info ] [MainThread]: 
[0m01:34:06.644268 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m01:34:06.644436 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/global_x_task because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: e18b7794-f629-460b-81c6-50f44756b64f; Proxy: null)
[0m01:34:06.644638 [info ] [MainThread]: 
[0m01:34:06.644803 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:34:06.645036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105613b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105293340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107911dc0>]}
[0m01:34:06.645218 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 01:39:22.229704 | 7be7f233-eaef-450e-8e88-4f75cbf48596 ==============================
[0m01:39:22.229718 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:39:22.230528 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:39:22.230628 [debug] [MainThread]: Tracking: tracking
[0m01:39:22.242104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a8220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a67c0>]}
[0m01:39:22.260265 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:39:22.260487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7be7f233-eaef-450e-8e88-4f75cbf48596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104182580>]}
[0m01:39:22.278948 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m01:39:22.279934 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m01:39:22.280442 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m01:39:22.284158 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m01:39:22.288673 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m01:39:22.289924 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m01:39:22.291838 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m01:39:22.292307 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m01:39:22.293957 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m01:39:22.294196 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m01:39:22.295924 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m01:39:22.296445 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m01:39:22.296617 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m01:39:22.300234 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m01:39:22.300917 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m01:39:22.302579 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m01:39:22.303626 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m01:39:22.304348 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m01:39:22.311563 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m01:39:22.318172 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m01:39:22.323986 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m01:39:22.326009 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m01:39:22.326809 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m01:39:22.327825 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m01:39:22.331662 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m01:39:22.339707 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m01:39:22.340558 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m01:39:22.343669 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m01:39:22.348573 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m01:39:22.356675 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m01:39:22.359168 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m01:39:22.360714 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m01:39:22.363206 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m01:39:22.363781 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m01:39:22.365284 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m01:39:22.366281 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m01:39:22.369427 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m01:39:22.378320 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m01:39:22.379045 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m01:39:22.380161 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m01:39:22.380847 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m01:39:22.381246 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m01:39:22.381600 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m01:39:22.381900 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m01:39:22.382738 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m01:39:22.385314 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m01:39:22.389373 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m01:39:22.389780 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m01:39:22.390330 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m01:39:22.390761 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m01:39:22.391175 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m01:39:22.391718 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m01:39:22.392073 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m01:39:22.392794 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m01:39:22.393775 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m01:39:22.394858 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m01:39:22.395410 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m01:39:22.395888 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m01:39:22.396355 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m01:39:22.396811 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m01:39:22.397213 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m01:39:22.397690 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m01:39:22.398100 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m01:39:22.401065 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m01:39:22.401531 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m01:39:22.401937 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m01:39:22.402739 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m01:39:22.403794 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m01:39:22.404277 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m01:39:22.404965 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m01:39:22.405449 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m01:39:22.406395 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m01:39:22.407837 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m01:39:22.409059 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m01:39:22.416346 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m01:39:22.417212 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m01:39:22.423616 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m01:39:22.425850 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m01:39:22.429126 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m01:39:22.433928 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m01:39:22.437043 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m01:39:22.560885 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m01:39:22.567719 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m01:39:22.569183 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m01:39:22.598340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7be7f233-eaef-450e-8e88-4f75cbf48596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475a0d0>]}
[0m01:39:22.601628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7be7f233-eaef-450e-8e88-4f75cbf48596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045da490>]}
[0m01:39:22.601787 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:39:22.601916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be7f233-eaef-450e-8e88-4f75cbf48596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ce580>]}
[0m01:39:22.602507 [info ] [MainThread]: 
[0m01:39:22.602792 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:39:22.603240 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:39:22.609505 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:39:22.609814 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:39:22.609934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:24.415910 [debug] [ThreadPool]: SQL status: OK -1 in 1.81 seconds
[0m01:39:24.416913 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:39:24.417610 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:39:24.418714 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:39:24.418836 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:39:24.421267 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:39:24.421350 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:39:24.421413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:26.025776 [debug] [ThreadPool]: SQL status: OK -1 in 1.6 seconds
[0m01:39:26.029321 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:39:26.032033 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m01:39:26.042401 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m01:39:26.042613 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m01:39:26.042764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:27.714291 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m01:39:27.717931 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m01:39:27.719091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be7f233-eaef-450e-8e88-4f75cbf48596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475a1c0>]}
[0m01:39:27.719980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:39:27.720374 [info ] [MainThread]: 
[0m01:39:27.723211 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m01:39:27.723608 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m01:39:27.724282 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m01:39:27.726430 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m01:39:27.726631 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m01:39:27.730783 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m01:39:27.731961 [debug] [Thread-1  ]: finished collecting timing info
[0m01:39:27.732181 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m01:39:27.747997 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m01:39:27.748558 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m01:39:27.748679 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from global_x_task.integrated_etf_data

[0m01:39:27.748786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:40:50.585591 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from global_x_task.integrated_etf_data

[0m01:40:50.588224 [debug] [Thread-1  ]: finished collecting timing info
[0m01:40:50.588509 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m01:40:50.589314 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/global_x_task because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 431b6c08-310a-445e-9c01-df3c2e0bd553; Proxy: null)
[0m01:40:50.589661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be7f233-eaef-450e-8e88-4f75cbf48596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465f3a0>]}
[0m01:40:50.590131 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 82.87s]
[0m01:40:50.590626 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m01:40:50.591400 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m01:40:50.591632 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m01:40:50.591851 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m01:40:50.592087 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m01:40:50.592527 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m01:40:50.592846 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m01:40:50.594221 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:40:50.594823 [info ] [MainThread]: 
[0m01:40:50.595102 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 27.99 seconds (87.99s).
[0m01:40:50.595355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:50.595487 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m01:40:50.602787 [info ] [MainThread]: 
[0m01:40:50.603028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:40:50.603230 [info ] [MainThread]: 
[0m01:40:50.603404 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m01:40:50.603575 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/global_x_task because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 431b6c08-310a-445e-9c01-df3c2e0bd553; Proxy: null)
[0m01:40:50.603754 [info ] [MainThread]: 
[0m01:40:50.603925 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:40:50.604174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f22d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f249dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f271ac0>]}
[0m01:40:50.604367 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 01:41:36.142601 | d1d3d303-5128-4446-87e5-7c79a0b4816b ==============================
[0m01:41:36.142619 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:41:36.143168 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:41:36.143272 [debug] [MainThread]: Tracking: tracking
[0m01:41:36.153135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108929430>]}
[0m01:41:36.188336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:41:36.188676 [debug] [MainThread]: Partial parsing: deleted source source.global_x_task.global_x_task.integrated_etf_data
[0m01:41:36.188757 [debug] [MainThread]: Partial parsing: update schema file: global_x_task://models/source.yml
[0m01:41:36.195407 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m01:41:36.201740 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m01:41:36.203034 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m01:41:36.218592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1d3d303-5128-4446-87e5-7c79a0b4816b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b430d0>]}
[0m01:41:36.221702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1d3d303-5128-4446-87e5-7c79a0b4816b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9dee0>]}
[0m01:41:36.221837 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:41:36.221967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1d3d303-5128-4446-87e5-7c79a0b4816b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef43a0>]}
[0m01:41:36.222574 [info ] [MainThread]: 
[0m01:41:36.222868 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:41:36.223334 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:41:36.229708 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:41:36.229855 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:41:36.229928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:38.052717 [debug] [ThreadPool]: SQL status: OK -1 in 1.82 seconds
[0m01:41:38.057988 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:41:38.059175 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:41:38.061210 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:41:38.061471 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:41:38.065853 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:41:38.066025 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:41:38.066189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:39.754155 [debug] [ThreadPool]: SQL status: OK -1 in 1.69 seconds
[0m01:41:39.755114 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:41:39.756328 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m01:41:39.762050 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m01:41:39.762188 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m01:41:39.762288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:41.473781 [debug] [ThreadPool]: SQL status: OK -1 in 1.71 seconds
[0m01:41:41.477380 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m01:41:41.478471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1d3d303-5128-4446-87e5-7c79a0b4816b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e80dcd0>]}
[0m01:41:41.479213 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:41:41.479535 [info ] [MainThread]: 
[0m01:41:41.483697 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m01:41:41.484129 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m01:41:41.484882 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m01:41:41.486907 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m01:41:41.487168 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m01:41:41.491378 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m01:41:41.492501 [debug] [Thread-1  ]: finished collecting timing info
[0m01:41:41.492696 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m01:41:41.508335 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m01:41:41.508954 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m01:41:41.509073 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:41:41.509172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:43:03.365779 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:43:03.367244 [debug] [Thread-1  ]: finished collecting timing info
[0m01:43:03.367419 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m01:43:03.367827 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  line 23:6: Table '975050278905.default.integrated_etf_data' does not exist
[0m01:43:03.367996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d3d303-5128-4446-87e5-7c79a0b4816b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe56340>]}
[0m01:43:03.368264 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.88s]
[0m01:43:03.368554 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m01:43:03.369002 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m01:43:03.369159 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m01:43:03.369315 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m01:43:03.369449 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m01:43:03.369706 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m01:43:03.369909 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m01:43:03.371147 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:43:03.371521 [info ] [MainThread]: 
[0m01:43:03.371692 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 27.15 seconds (87.15s).
[0m01:43:03.371846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:03.371933 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m01:43:03.376610 [info ] [MainThread]: 
[0m01:43:03.376814 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:43:03.376979 [info ] [MainThread]: 
[0m01:43:03.377120 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m01:43:03.377257 [error] [MainThread]:   line 23:6: Table '975050278905.default.integrated_etf_data' does not exist
[0m01:43:03.377398 [info ] [MainThread]: 
[0m01:43:03.377527 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:43:03.377722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8122b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b65cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5d2b80>]}
[0m01:43:03.377883 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 01:43:50.055870 | a6c3de7f-2eec-4e49-bcab-7046259364ce ==============================
[0m01:43:50.055890 [info ] [MainThread]: Running with dbt=1.3.0
[0m01:43:50.056499 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:43:50.056599 [debug] [MainThread]: Tracking: tracking
[0m01:43:50.067083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f49430>]}
[0m01:43:50.101025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:43:50.101177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:43:50.104623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6c3de7f-2eec-4e49-bcab-7046259364ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f30d0>]}
[0m01:43:50.108049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6c3de7f-2eec-4e49-bcab-7046259364ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c61c0>]}
[0m01:43:50.108205 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:43:50.108338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c3de7f-2eec-4e49-bcab-7046259364ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f494f0>]}
[0m01:43:50.109012 [info ] [MainThread]: 
[0m01:43:50.109313 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:43:50.109785 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m01:43:50.116153 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m01:43:50.116272 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m01:43:50.116342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:51.797104 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m01:43:51.798764 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m01:43:51.799685 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:43:51.801266 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m01:43:51.801460 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m01:43:51.805222 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m01:43:51.805381 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m01:43:51.805476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:53.669267 [debug] [ThreadPool]: SQL status: OK -1 in 1.86 seconds
[0m01:43:53.672116 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m01:43:53.674548 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m01:43:53.684463 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m01:43:53.684715 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m01:43:53.686022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:55.347760 [debug] [ThreadPool]: SQL status: OK -1 in 1.66 seconds
[0m01:43:55.352857 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m01:43:55.354550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c3de7f-2eec-4e49-bcab-7046259364ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa5c70>]}
[0m01:43:55.355584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:43:55.355987 [info ] [MainThread]: 
[0m01:43:55.359467 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m01:43:55.359828 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m01:43:55.360499 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m01:43:55.362625 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m01:43:55.362840 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m01:43:55.366735 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m01:43:55.367575 [debug] [Thread-1  ]: finished collecting timing info
[0m01:43:55.367749 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m01:43:55.383316 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m01:43:55.383808 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m01:43:55.383919 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:43:55.384016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:45:17.175435 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default.integrated_etf_data

[0m01:45:17.177564 [debug] [Thread-1  ]: finished collecting timing info
[0m01:45:17.177852 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m01:45:17.178555 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  line 23:6: Table '975050278905.default.integrated_etf_data' does not exist
[0m01:45:17.178852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c3de7f-2eec-4e49-bcab-7046259364ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b607190>]}
[0m01:45:17.179438 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.82s]
[0m01:45:17.179947 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m01:45:17.180701 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m01:45:17.180989 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m01:45:17.181141 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m01:45:17.181359 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m01:45:17.181744 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m01:45:17.182068 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m01:45:17.183555 [debug] [MainThread]: Acquiring new athena connection "master"
[0m01:45:17.184070 [info ] [MainThread]: 
[0m01:45:17.184307 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 27.07 seconds (87.07s).
[0m01:45:17.184519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:17.184633 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m01:45:17.191239 [info ] [MainThread]: 
[0m01:45:17.191504 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:45:17.191716 [info ] [MainThread]: 
[0m01:45:17.191892 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m01:45:17.192065 [error] [MainThread]:   line 23:6: Table '975050278905.default.integrated_etf_data' does not exist
[0m01:45:17.192236 [info ] [MainThread]: 
[0m01:45:17.192406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:45:17.192640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b677850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a0c10>]}
[0m01:45:17.192829 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 02:20:00.307238 | f122d5d9-cf4d-4b46-a1b7-6282b169d82c ==============================
[0m02:20:00.307256 [info ] [MainThread]: Running with dbt=1.3.0
[0m02:20:00.307887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:20:00.308029 [debug] [MainThread]: Tracking: tracking
[0m02:20:00.321801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c87c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c82b0>]}
[0m02:20:00.340637 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:20:00.340907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f122d5d9-cf4d-4b46-a1b7-6282b169d82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a28b0>]}
[0m02:20:00.361149 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:20:00.362246 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m02:20:00.362833 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m02:20:00.366865 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:20:00.371548 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:20:00.372939 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:20:00.374937 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:20:00.375424 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:20:00.377084 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:20:00.377332 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:20:00.379080 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:20:00.379630 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:20:00.379816 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:20:00.383568 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:20:00.384270 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:20:00.385973 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:20:00.387046 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:20:00.387798 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:20:00.395308 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:20:00.401747 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:20:00.407445 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:20:00.409453 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:20:00.410244 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:20:00.411037 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:20:00.414623 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:20:00.421994 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:20:00.422676 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:20:00.425670 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:20:00.430420 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:20:00.438400 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:20:00.440871 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:20:00.442416 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:20:00.444882 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:20:00.445443 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:20:00.446945 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:20:00.447941 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:20:00.451098 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:20:00.459648 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:20:00.460295 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:20:00.461373 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:20:00.462060 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:20:00.462457 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:20:00.462807 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:20:00.463107 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:20:00.463710 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:20:00.466091 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:20:00.469873 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:20:00.470252 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:20:00.470787 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:20:00.471219 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:20:00.471634 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:20:00.472173 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:20:00.472526 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:20:00.472980 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:20:00.473680 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:20:00.474712 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:20:00.475249 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:20:00.475742 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:20:00.476208 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:20:00.476654 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:20:00.477096 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:20:00.477614 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:20:00.478029 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:20:00.481041 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:20:00.481513 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:20:00.481917 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:20:00.482710 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:20:00.483715 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:20:00.484171 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:20:00.484830 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:20:00.485292 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:20:00.486233 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:20:00.487675 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:20:00.488884 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:20:00.495559 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:20:00.496420 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:20:00.502486 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:20:00.504520 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:20:00.507731 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:20:00.512164 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:20:00.514957 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:20:00.632232 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m02:20:00.638107 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m02:20:00.639502 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m02:20:00.667447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f122d5d9-cf4d-4b46-a1b7-6282b169d82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a58880>]}
[0m02:20:00.671283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f122d5d9-cf4d-4b46-a1b7-6282b169d82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c2dc0>]}
[0m02:20:00.671425 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:20:00.671563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f122d5d9-cf4d-4b46-a1b7-6282b169d82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a85eb0>]}
[0m02:20:00.672183 [info ] [MainThread]: 
[0m02:20:00.672509 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:20:00.672988 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m02:20:00.679520 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m02:20:00.679675 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m02:20:00.679752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:02.630505 [debug] [ThreadPool]: SQL status: OK -1 in 1.95 seconds
[0m02:20:02.631996 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m02:20:02.632878 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_default_globalx"
[0m02:20:02.634536 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_default_globalx"
[0m02:20:02.634724 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_default_globalx', identifier=None)"
[0m02:20:02.638645 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_default_globalx"
[0m02:20:02.638804 [debug] [ThreadPool]: On create_AwsDataCatalog_default_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_default_globalx"} */
create schema if not exists default_default_globalx
  
[0m02:20:02.638912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:05.274141 [debug] [ThreadPool]: SQL status: OK -1 in 2.64 seconds
[0m02:20:05.277572 [debug] [ThreadPool]: On create_AwsDataCatalog_default_default_globalx: Close
[0m02:20:05.280150 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_default_globalx"
[0m02:20:05.290406 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_default_globalx"
[0m02:20:05.290618 [debug] [ThreadPool]: On list_AwsDataCatalog_default_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m02:20:05.290768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:06.972898 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m02:20:06.975182 [debug] [ThreadPool]: On list_AwsDataCatalog_default_default_globalx: Close
[0m02:20:06.976020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f122d5d9-cf4d-4b46-a1b7-6282b169d82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a582b0>]}
[0m02:20:06.976724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:20:06.977026 [info ] [MainThread]: 
[0m02:20:06.980410 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m02:20:06.980782 [info ] [Thread-1  ]: 1 of 3 START sql view model default_default_globalx.integrated_etf_data ........ [RUN]
[0m02:20:06.981349 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m02:20:06.983247 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m02:20:06.983454 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m02:20:06.986772 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m02:20:06.987999 [debug] [Thread-1  ]: finished collecting timing info
[0m02:20:06.988207 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m02:20:07.002421 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m02:20:07.003005 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m02:20:07.003120 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m02:20:07.003213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:19.030721 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:20:19.032033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:19.032276 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was left open.
[0m02:20:19.032482 [debug] [MainThread]: On model.global_x_task.integrated_etf_data: Close
[0m02:20:19.032916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ac760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ac370>]}
[0m02:20:19.033335 [debug] [MainThread]: Flushing usage events
[0m02:20:19.424269 [error] [MainThread]: Encountered an error:
'Connection' object has no attribute 'cancel'
[0m02:20:19.431115 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/task/runnable.py", line 381, in execute_nodes
    self.run_queue(pool)
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/task/runnable.py", line 294, in run_queue
    node = self.job_queue.get()
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/graph/queue.py", line 121, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/Users/octavioelias/opt/anaconda3/lib/python3.9/queue.py", line 171, in get
    self.not_empty.wait()
  File "/Users/octavioelias/opt/anaconda3/lib/python3.9/threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/task/runnable.py", line 389, in execute_nodes
    self._cancel_connections(pool)
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/task/runnable.py", line 359, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 1082, in cancel_open_connections
    return self.connections.cancel_open()
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 43, in cancel_open
    self.cancel(connection)
  File "/Users/octavioelias/Documents/Documents - MacBook Pro (329)/2024/globalX/venv5jun/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 188, in cancel
    connection.handle.cancel()
AttributeError: 'Connection' object has no attribute 'cancel'



============================== 2024-06-06 02:20:34.751618 | 6c94630d-8b26-4edf-ac47-830c4af734cf ==============================
[0m02:20:34.751626 [info ] [MainThread]: Running with dbt=1.3.0
[0m02:20:34.751859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m02:20:34.751933 [debug] [MainThread]: Tracking: tracking
[0m02:20:34.759926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043be100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043befd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b2430>]}
[0m02:20:34.828878 [debug] [MainThread]: Executing "git --help"
[0m02:20:34.839908 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:20:34.840342 [debug] [MainThread]: STDERR: "b''"
[0m02:20:34.843219 [debug] [MainThread]: Acquiring new athena connection "debug"
[0m02:20:34.843614 [debug] [MainThread]: Using athena connection "debug"
[0m02:20:34.843700 [debug] [MainThread]: On debug: select 1 as id
[0m02:20:34.843793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:20:36.524317 [debug] [MainThread]: SQL status: OK -1 in 1.68 seconds
[0m02:20:36.527985 [debug] [MainThread]: On debug: Close
[0m02:20:36.528661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104806610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104806b20>]}
[0m02:20:36.529059 [debug] [MainThread]: Flushing usage events
[0m02:20:36.694471 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-06-06 02:20:41.459857 | 5e138e33-a3f2-423c-a61f-6d2ec1a81261 ==============================
[0m02:20:41.459878 [info ] [MainThread]: Running with dbt=1.3.0
[0m02:20:41.460349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:20:41.460438 [debug] [MainThread]: Tracking: tracking
[0m02:20:41.469634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a801f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a80fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a8d100>]}
[0m02:20:41.486317 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:20:41.486641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e138e33-a3f2-423c-a61f-6d2ec1a81261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a80250>]}
[0m02:20:41.503840 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:20:41.505134 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m02:20:41.505705 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m02:20:41.509638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:20:41.514207 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:20:41.515474 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:20:41.517744 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:20:41.518419 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:20:41.520316 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:20:41.520598 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:20:41.522491 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:20:41.523093 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:20:41.523298 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:20:41.527386 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:20:41.528278 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:20:41.530188 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:20:41.531451 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:20:41.532272 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:20:41.540386 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:20:41.546980 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:20:41.552989 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:20:41.555073 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:20:41.555933 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:20:41.556762 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:20:41.560471 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:20:41.568004 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:20:41.568706 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:20:41.571878 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:20:41.576834 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:20:41.585039 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:20:41.587589 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:20:41.589152 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:20:41.591623 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:20:41.592198 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:20:41.593693 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:20:41.594697 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:20:41.597895 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:20:41.606547 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:20:41.607201 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:20:41.608287 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:20:41.608963 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:20:41.609363 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:20:41.609716 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:20:41.610027 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:20:41.610640 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:20:41.612985 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:20:41.616761 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:20:41.617120 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:20:41.617661 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:20:41.618086 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:20:41.618496 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:20:41.619038 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:20:41.619392 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:20:41.619891 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:20:41.620601 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:20:41.621636 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:20:41.622186 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:20:41.622669 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:20:41.623134 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:20:41.623594 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:20:41.624010 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:20:41.624478 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:20:41.624876 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:20:41.627955 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:20:41.628443 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:20:41.628860 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:20:41.629680 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:20:41.630669 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:20:41.631126 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:20:41.631790 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:20:41.632265 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:20:41.633209 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:20:41.634753 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:20:41.636065 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:20:41.642897 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:20:41.643788 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:20:41.649875 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:20:41.651820 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:20:41.655011 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:20:41.659413 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:20:41.662172 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:20:41.778492 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m02:20:41.784530 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m02:20:41.785965 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m02:20:41.812606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e138e33-a3f2-423c-a61f-6d2ec1a81261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d1c670>]}
[0m02:20:41.816029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e138e33-a3f2-423c-a61f-6d2ec1a81261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ab1280>]}
[0m02:20:41.816168 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:20:41.816293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e138e33-a3f2-423c-a61f-6d2ec1a81261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aa8d60>]}
[0m02:20:41.816886 [info ] [MainThread]: 
[0m02:20:41.817183 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:20:41.817621 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m02:20:41.824236 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m02:20:41.824373 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m02:20:41.824454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:43.772833 [debug] [ThreadPool]: SQL status: OK -1 in 1.95 seconds
[0m02:20:43.774190 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m02:20:43.774964 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m02:20:43.776708 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_globalx"
[0m02:20:43.776876 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_globalx', identifier=None)"
[0m02:20:43.780599 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_globalx"
[0m02:20:43.780728 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_globalx"} */
create schema if not exists default_globalx
  
[0m02:20:43.780830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:45.400781 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m02:20:45.404598 [debug] [ThreadPool]: On create_AwsDataCatalog_default_globalx: Close
[0m02:20:45.407692 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m02:20:45.418311 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m02:20:45.418521 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m02:20:45.418669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:47.041368 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m02:20:47.044560 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m02:20:47.045757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e138e33-a3f2-423c-a61f-6d2ec1a81261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d1c5b0>]}
[0m02:20:47.046656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:20:47.047048 [info ] [MainThread]: 
[0m02:20:47.050500 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m02:20:47.050877 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m02:20:47.051572 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m02:20:47.053819 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m02:20:47.054195 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m02:20:47.058033 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m02:20:47.058721 [debug] [Thread-1  ]: finished collecting timing info
[0m02:20:47.058888 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m02:20:47.074592 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m02:20:47.075159 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m02:20:47.075338 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m02:20:47.075631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:22:08.770542 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m02:22:08.772635 [debug] [Thread-1  ]: finished collecting timing info
[0m02:22:08.772884 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m02:22:08.773688 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_globalx because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 74cafec6-247a-402a-8ced-2312e02a5769; Proxy: null)
[0m02:22:08.774019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e138e33-a3f2-423c-a61f-6d2ec1a81261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b42b8e0>]}
[0m02:22:08.774496 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.72s]
[0m02:22:08.775007 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m02:22:08.775920 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m02:22:08.776130 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m02:22:08.776307 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m02:22:08.776550 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m02:22:08.776949 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m02:22:08.777287 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m02:22:08.778955 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:22:08.779786 [info ] [MainThread]: 
[0m02:22:08.780068 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 26.96 seconds (86.96s).
[0m02:22:08.780293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:08.780413 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m02:22:08.787821 [info ] [MainThread]: 
[0m02:22:08.788163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:22:08.788385 [info ] [MainThread]: 
[0m02:22:08.788564 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m02:22:08.788747 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_globalx because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 74cafec6-247a-402a-8ced-2312e02a5769; Proxy: null)
[0m02:22:08.788979 [info ] [MainThread]: 
[0m02:22:08.789153 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:22:08.789453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b449e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b48adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b472b80>]}
[0m02:22:08.789723 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 02:23:39.439617 | 10450f56-c2c6-4d1d-9674-2080caac5b4d ==============================
[0m02:23:39.439640 [info ] [MainThread]: Running with dbt=1.3.0
[0m02:23:39.440143 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:23:39.440238 [debug] [MainThread]: Tracking: tracking
[0m02:23:39.449985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064122b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106424e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106424850>]}
[0m02:23:39.484716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:23:39.484873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:23:39.488207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10450f56-c2c6-4d1d-9674-2080caac5b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b9fa0>]}
[0m02:23:39.491431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10450f56-c2c6-4d1d-9674-2080caac5b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106686040>]}
[0m02:23:39.491578 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:23:39.491720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10450f56-c2c6-4d1d-9674-2080caac5b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106686070>]}
[0m02:23:39.492360 [info ] [MainThread]: 
[0m02:23:39.492663 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:23:39.493149 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m02:23:39.499609 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m02:23:39.499740 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m02:23:39.499816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:41.322874 [debug] [ThreadPool]: SQL status: OK -1 in 1.82 seconds
[0m02:23:41.324424 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m02:23:41.325320 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m02:23:41.332514 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m02:23:41.332755 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m02:23:41.332887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:43.033549 [debug] [ThreadPool]: SQL status: OK -1 in 1.7 seconds
[0m02:23:43.037265 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m02:23:43.038437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10450f56-c2c6-4d1d-9674-2080caac5b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106762490>]}
[0m02:23:43.039400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:23:43.039810 [info ] [MainThread]: 
[0m02:23:43.043420 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m02:23:43.043771 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m02:23:43.044446 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m02:23:43.046699 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m02:23:43.046951 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m02:23:43.050914 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m02:23:43.051778 [debug] [Thread-1  ]: finished collecting timing info
[0m02:23:43.051968 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m02:23:43.068281 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m02:23:43.068868 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m02:23:43.069005 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m02:23:43.069114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:25:04.859228 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m02:25:04.861150 [debug] [Thread-1  ]: finished collecting timing info
[0m02:25:04.861427 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m02:25:04.862095 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:table/default_globalx/integrated_etf_data because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 7c0d6ced-d167-48ca-8e9d-e136b061725f; Proxy: null)
[0m02:25:04.862389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10450f56-c2c6-4d1d-9674-2080caac5b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910f430>]}
[0m02:25:04.862827 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.82s]
[0m02:25:04.863323 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m02:25:04.864057 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m02:25:04.864332 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m02:25:04.864468 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m02:25:04.864669 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m02:25:04.865019 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m02:25:04.865294 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m02:25:04.866843 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:25:04.867477 [info ] [MainThread]: 
[0m02:25:04.868065 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 25.37 seconds (85.37s).
[0m02:25:04.868360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:25:04.868513 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m02:25:04.875356 [info ] [MainThread]: 
[0m02:25:04.875655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:25:04.875904 [info ] [MainThread]: 
[0m02:25:04.876112 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m02:25:04.876543 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:table/default_globalx/integrated_etf_data because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 7c0d6ced-d167-48ca-8e9d-e136b061725f; Proxy: null)
[0m02:25:04.876874 [info ] [MainThread]: 
[0m02:25:04.877063 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:25:04.877381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e042e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e04310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091212b0>]}
[0m02:25:04.877642 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 02:58:04.858374 | 022eb775-bcf4-4c68-9f8c-128484db615f ==============================
[0m02:58:04.858397 [info ] [MainThread]: Running with dbt=1.3.0
[0m02:58:04.859117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:58:04.859257 [debug] [MainThread]: Tracking: tracking
[0m02:58:04.876329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8ad90>]}
[0m02:58:04.893331 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:58:04.893527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '022eb775-bcf4-4c68-9f8c-128484db615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4b280>]}
[0m02:58:04.910454 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:58:04.911436 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m02:58:04.911951 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m02:58:04.915830 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:58:04.920518 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:58:04.921832 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:58:04.923769 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:58:04.924257 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:58:04.925917 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:58:04.926156 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:58:04.927906 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:58:04.928431 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:58:04.928604 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:58:04.932234 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:58:04.932929 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:58:04.934600 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:58:04.935658 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:58:04.936386 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:58:04.943625 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:58:04.949793 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:58:04.955568 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:58:04.957623 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:58:04.958420 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:58:04.959205 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:58:04.962945 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:58:04.970370 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:58:04.971048 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:58:04.974044 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:58:04.978771 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:58:04.986722 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:58:04.989183 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:58:04.990711 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:58:04.993199 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:58:04.993762 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:58:04.995235 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:58:04.996220 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:58:04.999356 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:58:05.007902 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:58:05.008550 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:58:05.009634 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:58:05.010315 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:58:05.010708 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:58:05.011057 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:58:05.011354 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:58:05.011953 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:58:05.014277 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:58:05.018032 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:58:05.018387 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:58:05.018918 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:58:05.019352 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:58:05.019830 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:58:05.020470 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:58:05.020899 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:58:05.021377 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:58:05.022089 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:58:05.023113 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:58:05.023651 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:58:05.024122 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:58:05.024583 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:58:05.025025 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:58:05.025427 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:58:05.025895 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:58:05.026288 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:58:05.029253 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:58:05.029724 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:58:05.030127 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:58:05.030921 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:58:05.031899 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:58:05.032361 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:58:05.033025 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:58:05.033489 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:58:05.034413 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:58:05.035851 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:58:05.037075 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:58:05.043754 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:58:05.044613 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:58:05.050647 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:58:05.052575 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:58:05.055743 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:58:05.060118 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:58:05.062867 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:58:05.182410 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m02:58:05.188222 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m02:58:05.189600 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m02:58:05.217239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022eb775-bcf4-4c68-9f8c-128484db615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603a0d0>]}
[0m02:58:05.220628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022eb775-bcf4-4c68-9f8c-128484db615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e902b0>]}
[0m02:58:05.220770 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:58:05.220899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022eb775-bcf4-4c68-9f8c-128484db615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106041dc0>]}
[0m02:58:05.221508 [info ] [MainThread]: 
[0m02:58:05.221802 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:58:05.222275 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m02:58:05.228507 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m02:58:05.228647 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m02:58:05.228719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:07.170351 [debug] [ThreadPool]: SQL status: OK -1 in 1.94 seconds
[0m02:58:07.171656 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m02:58:07.172805 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m02:58:07.179386 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m02:58:07.179534 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m02:58:07.179645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:58:08.833391 [debug] [ThreadPool]: SQL status: OK -1 in 1.65 seconds
[0m02:58:08.836653 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m02:58:08.837962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022eb775-bcf4-4c68-9f8c-128484db615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efad90>]}
[0m02:58:08.838886 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:58:08.839260 [info ] [MainThread]: 
[0m02:58:08.842459 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m02:58:08.842823 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m02:58:08.843515 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m02:58:08.845459 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m02:58:08.845646 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m02:58:08.849780 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m02:58:08.850963 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:08.851210 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m02:58:08.861517 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:08.862233 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m02:58:08.862515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022eb775-bcf4-4c68-9f8c-128484db615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe1850>]}
[0m02:58:08.862822 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.02s]
[0m02:58:08.863144 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m02:58:08.863531 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m02:58:08.863819 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m02:58:08.863929 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m02:58:08.864073 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m02:58:08.864319 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m02:58:08.864535 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m02:58:08.865423 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:58:08.865842 [info ] [MainThread]: 
[0m02:58:08.866038 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m02:58:08.866208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:08.866296 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m02:58:08.871998 [info ] [MainThread]: 
[0m02:58:08.872203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:58:08.872366 [info ] [MainThread]: 
[0m02:58:08.872507 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m02:58:08.872644 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m02:58:08.872775 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m02:58:08.872903 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m02:58:08.873030 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m02:58:08.873155 [error] [MainThread]:   
[0m02:58:08.873406 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m02:58:08.873552 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m02:58:08.873688 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m02:58:08.874101 [info ] [MainThread]: 
[0m02:58:08.874284 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:58:08.874508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ec6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7fa2e0>]}
[0m02:58:08.874676 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 02:59:32.213911 | 809ca6c7-54b0-4764-a554-796d341f83b2 ==============================
[0m02:59:32.213936 [info ] [MainThread]: Running with dbt=1.3.0
[0m02:59:32.214488 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:59:32.214582 [debug] [MainThread]: Tracking: tracking
[0m02:59:32.223254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d18100>]}
[0m02:59:32.256859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:59:32.257013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:59:32.260389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '809ca6c7-54b0-4764-a554-796d341f83b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb9f10>]}
[0m02:59:32.263590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '809ca6c7-54b0-4764-a554-796d341f83b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e87160>]}
[0m02:59:32.263731 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:59:32.263868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809ca6c7-54b0-4764-a554-796d341f83b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d18550>]}
[0m02:59:32.264485 [info ] [MainThread]: 
[0m02:59:32.264777 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:59:32.265280 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m02:59:32.271675 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m02:59:32.271805 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m02:59:32.271880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:59:34.044734 [debug] [ThreadPool]: SQL status: OK -1 in 1.77 seconds
[0m02:59:34.048185 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m02:59:34.050322 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m02:59:34.060012 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m02:59:34.060215 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m02:59:34.060439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:59:35.674178 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m02:59:35.678244 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m02:59:35.679594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809ca6c7-54b0-4764-a554-796d341f83b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f79130>]}
[0m02:59:35.680575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:59:35.680973 [info ] [MainThread]: 
[0m02:59:35.684710 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m02:59:35.685078 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m02:59:35.685736 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m02:59:35.687911 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m02:59:35.688135 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m02:59:35.692029 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m02:59:35.692800 [debug] [Thread-1  ]: finished collecting timing info
[0m02:59:35.692981 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m02:59:35.703366 [debug] [Thread-1  ]: finished collecting timing info
[0m02:59:35.703902 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m02:59:35.704119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '809ca6c7-54b0-4764-a554-796d341f83b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a755f40>]}
[0m02:59:35.704368 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.02s]
[0m02:59:35.704662 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m02:59:35.705090 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m02:59:35.705217 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m02:59:35.705422 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m02:59:35.705559 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m02:59:35.705804 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m02:59:35.706024 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m02:59:35.706940 [debug] [MainThread]: Acquiring new athena connection "master"
[0m02:59:35.707311 [info ] [MainThread]: 
[0m02:59:35.707494 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m02:59:35.707655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:59:35.707743 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m02:59:35.712160 [info ] [MainThread]: 
[0m02:59:35.712366 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:59:35.712531 [info ] [MainThread]: 
[0m02:59:35.712667 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m02:59:35.712807 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m02:59:35.712934 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m02:59:35.713062 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m02:59:35.713189 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m02:59:35.713313 [error] [MainThread]:   
[0m02:59:35.713439 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m02:59:35.713564 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m02:59:35.713689 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m02:59:35.713821 [info ] [MainThread]: 
[0m02:59:35.713951 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:59:35.714158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076da790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076da220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b21b50>]}
[0m02:59:35.714316 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:03:26.103853 | 0060e847-41f0-45ee-aeda-e4718828f2f9 ==============================
[0m03:03:26.103888 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:03:26.104644 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:03:26.104799 [debug] [MainThread]: Tracking: tracking
[0m03:03:26.114998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47730>]}
[0m03:03:26.152330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:03:26.152496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:03:26.156180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0060e847-41f0-45ee-aeda-e4718828f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf30d0>]}
[0m03:03:26.160184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0060e847-41f0-45ee-aeda-e4718828f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc6190>]}
[0m03:03:26.160381 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:03:26.160525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0060e847-41f0-45ee-aeda-e4718828f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47d90>]}
[0m03:03:26.161198 [info ] [MainThread]: 
[0m03:03:26.161515 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:03:26.162002 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:03:26.168679 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:03:26.168812 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:03:26.168887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:03:28.006856 [debug] [ThreadPool]: SQL status: OK -1 in 1.84 seconds
[0m03:03:28.010852 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:03:28.013066 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:03:28.022968 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:03:28.023188 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:03:28.023345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:29.640619 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m03:03:29.642116 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:03:29.642818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0060e847-41f0-45ee-aeda-e4718828f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da1250>]}
[0m03:03:29.643392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:03:29.643642 [info ] [MainThread]: 
[0m03:03:29.645522 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:03:29.645756 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m03:03:29.646241 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:03:29.647773 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:03:29.647928 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:03:29.650873 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:03:29.651325 [debug] [Thread-1  ]: finished collecting timing info
[0m03:03:29.651464 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:03:29.660702 [debug] [Thread-1  ]: finished collecting timing info
[0m03:03:29.661197 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:03:29.661453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0060e847-41f0-45ee-aeda-e4718828f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0636d0>]}
[0m03:03:29.661714 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.02s]
[0m03:03:29.662008 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:03:29.662567 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:03:29.662726 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:03:29.662907 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:03:29.663038 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:03:29.663371 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:03:29.663603 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:03:29.664608 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:03:29.664952 [info ] [MainThread]: 
[0m03:03:29.665117 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m03:03:29.665266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:03:29.665346 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:03:29.669503 [info ] [MainThread]: 
[0m03:03:29.669700 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:03:29.669862 [info ] [MainThread]: 
[0m03:03:29.670009 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:03:29.670151 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:03:29.670281 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m03:03:29.670411 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m03:03:29.670543 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m03:03:29.670672 [error] [MainThread]:   
[0m03:03:29.670802 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:03:29.670931 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:03:29.671058 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:03:29.671192 [info ] [MainThread]: 
[0m03:03:29.671328 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:03:29.671513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d060ca0>]}
[0m03:03:29.671662 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:06:03.276280 | 123a2f8f-aaef-4e41-af21-3cab3404bae5 ==============================
[0m03:06:03.276301 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:06:03.276828 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:06:03.276923 [debug] [MainThread]: Tracking: tracking
[0m03:06:03.287580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ccca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c9be0>]}
[0m03:06:03.321676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:06:03.321818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:06:03.325088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '123a2f8f-aaef-4e41-af21-3cab3404bae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c720d0>]}
[0m03:06:03.328547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '123a2f8f-aaef-4e41-af21-3cab3404bae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c45190>]}
[0m03:06:03.328691 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:06:03.328828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '123a2f8f-aaef-4e41-af21-3cab3404bae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c9c40>]}
[0m03:06:03.329448 [info ] [MainThread]: 
[0m03:06:03.329751 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:06:03.330248 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:06:03.336741 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:06:03.336903 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:06:03.336978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:05.095665 [debug] [ThreadPool]: SQL status: OK -1 in 1.76 seconds
[0m03:06:05.098691 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:06:05.100379 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:06:05.107894 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:06:05.108124 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:06:05.108328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:10.885276 [debug] [ThreadPool]: SQL status: OK -1 in 5.78 seconds
[0m03:06:10.888002 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:06:10.888743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '123a2f8f-aaef-4e41-af21-3cab3404bae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d20250>]}
[0m03:06:10.889469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:06:10.889871 [info ] [MainThread]: 
[0m03:06:10.892233 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:06:10.892525 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m03:06:10.892949 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:06:10.894023 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:06:10.894139 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:06:10.896329 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:06:10.897044 [debug] [Thread-1  ]: finished collecting timing info
[0m03:06:10.897271 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:06:10.907447 [debug] [Thread-1  ]: finished collecting timing info
[0m03:06:10.907967 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:06:10.908168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '123a2f8f-aaef-4e41-af21-3cab3404bae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e56d0>]}
[0m03:06:10.908396 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.02s]
[0m03:06:10.908671 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:06:10.909370 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:06:10.909595 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:06:10.909830 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:06:10.910072 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:06:10.910405 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:06:10.910758 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:06:10.911589 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:06:10.911922 [info ] [MainThread]: 
[0m03:06:10.912083 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m03:06:10.912218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:06:10.912291 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:06:10.916549 [info ] [MainThread]: 
[0m03:06:10.916836 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:06:10.917001 [info ] [MainThread]: 
[0m03:06:10.917131 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:06:10.917298 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:06:10.917418 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m03:06:10.917536 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m03:06:10.917652 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m03:06:10.917762 [error] [MainThread]:   
[0m03:06:10.917877 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:06:10.917994 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:06:10.918109 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:06:10.918234 [info ] [MainThread]: 
[0m03:06:10.918355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:06:10.918551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e0ca0>]}
[0m03:06:10.918704 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:06:49.233009 | 57036cce-6fc7-4ce6-bd4a-5d946db485fe ==============================
[0m03:06:49.233033 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:06:49.233403 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:06:49.233554 [debug] [MainThread]: Tracking: tracking
[0m03:06:49.242585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccc130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cccc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd5400>]}
[0m03:06:49.275920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:06:49.276078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:06:49.279551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57036cce-6fc7-4ce6-bd4a-5d946db485fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e730d0>]}
[0m03:06:49.282922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57036cce-6fc7-4ce6-bd4a-5d946db485fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e46190>]}
[0m03:06:49.283065 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:06:49.283196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57036cce-6fc7-4ce6-bd4a-5d946db485fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd54f0>]}
[0m03:06:49.283871 [info ] [MainThread]: 
[0m03:06:49.284179 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:06:49.284662 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:06:49.291017 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:06:49.291154 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:06:49.291229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:51.144556 [debug] [ThreadPool]: SQL status: OK -1 in 1.85 seconds
[0m03:06:51.148698 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:06:51.150916 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:06:51.161059 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:06:51.161274 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:06:51.161426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:52.775825 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m03:06:52.780015 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:06:52.781325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57036cce-6fc7-4ce6-bd4a-5d946db485fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f21250>]}
[0m03:06:52.782196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:06:52.782585 [info ] [MainThread]: 
[0m03:06:52.785223 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:06:52.785642 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m03:06:52.786344 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:06:52.788555 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:06:52.788771 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:06:52.792986 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:06:52.793879 [debug] [Thread-1  ]: finished collecting timing info
[0m03:06:52.794058 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:06:52.804742 [debug] [Thread-1  ]: finished collecting timing info
[0m03:06:52.805304 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:06:52.805512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57036cce-6fc7-4ce6-bd4a-5d946db485fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e82df40>]}
[0m03:06:52.805803 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.02s]
[0m03:06:52.806097 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:06:52.806635 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:06:52.806846 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:06:52.807046 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:06:52.807227 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:06:52.807516 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:06:52.807753 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:06:52.808714 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:06:52.809094 [info ] [MainThread]: 
[0m03:06:52.809279 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m03:06:52.809440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:06:52.809527 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:06:52.814264 [info ] [MainThread]: 
[0m03:06:52.814448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:06:52.814616 [info ] [MainThread]: 
[0m03:06:52.814753 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:06:52.814893 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:06:52.815022 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m03:06:52.815150 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m03:06:52.815277 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m03:06:52.815403 [error] [MainThread]:   
[0m03:06:52.815529 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:06:52.815654 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:06:52.815780 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:06:52.815912 [info ] [MainThread]: 
[0m03:06:52.816041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:06:52.816226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e46280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf93d0>]}
[0m03:06:52.816363 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:07:48.686093 | 7cd8e7df-9888-4eaf-b365-b21ce885a99e ==============================
[0m03:07:48.686115 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:07:48.686502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:07:48.686613 [debug] [MainThread]: Tracking: tracking
[0m03:07:48.695090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112749460>]}
[0m03:07:48.721173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:07:48.721515 [debug] [MainThread]: Partial parsing: deleted source source.global_x_task.global_x_task.integrated_etf_data
[0m03:07:48.721599 [debug] [MainThread]: Partial parsing: update schema file: global_x_task://models/source.yml
[0m03:07:48.730785 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:07:48.737182 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:07:48.738473 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m03:07:48.755727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cd8e7df-9888-4eaf-b365-b21ce885a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129640d0>]}
[0m03:07:48.759150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cd8e7df-9888-4eaf-b365-b21ce885a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128bdee0>]}
[0m03:07:48.759314 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:07:48.759453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cd8e7df-9888-4eaf-b365-b21ce885a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792c3a0>]}
[0m03:07:48.760091 [info ] [MainThread]: 
[0m03:07:48.760396 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:07:48.760896 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:07:48.767603 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:07:48.767740 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:07:48.767811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:50.461557 [debug] [ThreadPool]: SQL status: OK -1 in 1.69 seconds
[0m03:07:50.465826 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:07:50.468069 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:07:50.477975 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:07:50.478182 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:07:50.478333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:52.363953 [debug] [ThreadPool]: SQL status: OK -1 in 1.89 seconds
[0m03:07:52.365310 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:07:52.365895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cd8e7df-9888-4eaf-b365-b21ce885a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c6070>]}
[0m03:07:52.366322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:07:52.366521 [info ] [MainThread]: 
[0m03:07:52.367765 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:07:52.368003 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m03:07:52.368453 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:07:52.369781 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:07:52.369908 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:07:52.372366 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:07:52.372761 [debug] [Thread-1  ]: finished collecting timing info
[0m03:07:52.372880 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:07:52.380933 [debug] [Thread-1  ]: finished collecting timing info
[0m03:07:52.381406 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:07:52.381591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cd8e7df-9888-4eaf-b365-b21ce885a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115496490>]}
[0m03:07:52.381815 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.01s]
[0m03:07:52.382077 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:07:52.382508 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:07:52.382654 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:07:52.382857 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:07:52.382976 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:07:52.383209 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:07:52.383385 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:07:52.384193 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:07:52.384544 [info ] [MainThread]: 
[0m03:07:52.384698 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m03:07:52.384839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:52.384911 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:07:52.388573 [info ] [MainThread]: 
[0m03:07:52.388720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:07:52.388841 [info ] [MainThread]: 
[0m03:07:52.388946 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:07:52.389045 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:07:52.389145 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m03:07:52.389254 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m03:07:52.389421 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m03:07:52.389527 [error] [MainThread]:   
[0m03:07:52.389625 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:07:52.389720 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:07:52.389924 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:07:52.390057 [info ] [MainThread]: 
[0m03:07:52.390179 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:07:52.390355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112749d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148d68e0>]}
[0m03:07:52.390494 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:08:17.627128 | 4340a102-95bd-4f38-ae0e-179e70118d95 ==============================
[0m03:08:17.627153 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:08:17.627480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:08:17.627568 [debug] [MainThread]: Tracking: tracking
[0m03:08:17.635859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104102cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065245e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106524970>]}
[0m03:08:17.653229 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:08:17.653477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4340a102-95bd-4f38-ae0e-179e70118d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbe580>]}
[0m03:08:17.663142 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:08:17.663958 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:08:17.664490 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:08:17.668581 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:08:17.673307 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:08:17.674595 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:08:17.676874 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:08:17.677409 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:08:17.679117 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:08:17.679368 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:08:17.681145 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:08:17.681681 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:08:17.681863 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:08:17.685700 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:08:17.686471 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:08:17.688325 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:08:17.689481 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:08:17.690258 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:08:17.697859 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:08:17.704388 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:08:17.710371 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:08:17.712546 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:08:17.713397 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:08:17.714192 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:08:17.717783 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:08:17.725168 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:08:17.725850 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:08:17.728837 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:08:17.733600 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:08:17.741852 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:08:17.744521 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:08:17.746137 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:08:17.748726 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:08:17.749311 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:08:17.750848 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:08:17.751881 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:08:17.755205 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:08:17.764032 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:08:17.764695 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:08:17.765812 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:08:17.766517 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:08:17.766938 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:08:17.767310 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:08:17.767625 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:08:17.768238 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:08:17.770821 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:08:17.774864 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:08:17.775266 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:08:17.775822 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:08:17.776283 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:08:17.776720 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:08:17.777295 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:08:17.777673 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:08:17.778153 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:08:17.778933 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:08:17.780038 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:08:17.780605 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:08:17.781106 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:08:17.781735 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:08:17.782268 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:08:17.782759 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:08:17.783283 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:08:17.783735 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:08:17.787043 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:08:17.787596 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:08:17.788045 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:08:17.789107 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:08:17.790293 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:08:17.790791 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:08:17.791597 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:08:17.792243 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:08:17.793297 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:08:17.794807 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:08:17.796094 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:08:17.802858 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:08:17.803737 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:08:17.809849 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:08:17.811807 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:08:17.815005 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:08:17.819433 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:08:17.822240 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:08:17.941702 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m03:08:17.947649 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:08:17.949073 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:08:17.976536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4340a102-95bd-4f38-ae0e-179e70118d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c10d0>]}
[0m03:08:17.979873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4340a102-95bd-4f38-ae0e-179e70118d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065242e0>]}
[0m03:08:17.980017 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:08:17.980151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4340a102-95bd-4f38-ae0e-179e70118d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cae80>]}
[0m03:08:17.980748 [info ] [MainThread]: 
[0m03:08:17.981040 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:08:17.981499 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:08:17.988067 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:08:17.988209 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:08:17.988279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:19.787188 [debug] [ThreadPool]: SQL status: OK -1 in 1.8 seconds
[0m03:08:19.788595 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:08:19.789414 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_default_globalx"
[0m03:08:19.791217 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_default_globalx"
[0m03:08:19.791410 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_default_globalx', identifier=None)"
[0m03:08:19.795336 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_default_globalx"
[0m03:08:19.795467 [debug] [ThreadPool]: On create_AwsDataCatalog_default_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_default_globalx"} */
create schema if not exists default_default_globalx
  
[0m03:08:19.795571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:08:21.407290 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m03:08:21.410231 [debug] [ThreadPool]: On create_AwsDataCatalog_default_default_globalx: Close
[0m03:08:21.412778 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_default_globalx"
[0m03:08:21.423072 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_default_globalx"
[0m03:08:21.423296 [debug] [ThreadPool]: On list_AwsDataCatalog_default_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:08:21.423443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:08:23.106565 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m03:08:23.109556 [debug] [ThreadPool]: On list_AwsDataCatalog_default_default_globalx: Close
[0m03:08:23.110549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4340a102-95bd-4f38-ae0e-179e70118d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107225220>]}
[0m03:08:23.111200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:08:23.111480 [info ] [MainThread]: 
[0m03:08:23.113595 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:08:23.113990 [info ] [Thread-1  ]: 1 of 3 START sql view model default_default_globalx.integrated_etf_data ........ [RUN]
[0m03:08:23.114712 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:08:23.117016 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:08:23.117217 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:08:23.121522 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:08:23.122364 [debug] [Thread-1  ]: finished collecting timing info
[0m03:08:23.122563 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:08:23.139006 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m03:08:23.139544 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m03:08:23.139665 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:08:23.140002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:44.866206 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    default_default_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:09:44.867552 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:44.867750 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m03:09:44.868266 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_default_globalx because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: f77c860a-723a-43dc-9fcf-86cdee619165; Proxy: null)
[0m03:09:44.868500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4340a102-95bd-4f38-ae0e-179e70118d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065777f0>]}
[0m03:09:44.868856 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_default_globalx.integrated_etf_data  [[31mERROR[0m in 81.75s]
[0m03:09:44.869246 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:09:44.869862 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:09:44.870153 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:09:44.870422 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_default_globalx.fred_unemp ........................ [[33mSKIP[0m]
[0m03:09:44.870688 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_default_globalx.polygon ........................... [[33mSKIP[0m]
[0m03:09:44.871093 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:09:44.871456 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:09:44.872523 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:09:44.872962 [info ] [MainThread]: 
[0m03:09:44.873177 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 26.89 seconds (86.89s).
[0m03:09:44.873364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:44.873468 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:09:44.879227 [info ] [MainThread]: 
[0m03:09:44.879531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:09:44.880005 [info ] [MainThread]: 
[0m03:09:44.880236 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:09:44.880426 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_default_globalx because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: f77c860a-723a-43dc-9fcf-86cdee619165; Proxy: null)
[0m03:09:44.880605 [info ] [MainThread]: 
[0m03:09:44.880773 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:09:44.881098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0e0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b3be0>]}
[0m03:09:44.881300 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:14:45.927716 | 1de6ed62-5823-4eb9-9ef4-f1c3e1fd4e47 ==============================
[0m03:14:45.927733 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:14:45.928264 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:14:45.928360 [debug] [MainThread]: Tracking: tracking
[0m03:14:45.937244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087de2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f0940>]}
[0m03:14:45.955093 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:14:45.955353 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:14:45.955479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1de6ed62-5823-4eb9-9ef4-f1c3e1fd4e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de07c0>]}
[0m03:14:45.965483 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:14:45.966734 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:14:45.967289 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:14:45.971212 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:14:45.975791 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:14:45.977070 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:14:45.979013 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:14:45.979487 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:14:45.981144 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:14:45.981384 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:14:45.983119 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:14:45.983646 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:14:45.983820 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:14:45.987454 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:14:45.988141 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:14:45.989803 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:14:45.990860 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:14:45.991583 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:14:45.998815 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:14:46.005040 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:14:46.010661 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:14:46.012657 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:14:46.013476 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:14:46.014266 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:14:46.017850 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:14:46.025225 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:14:46.025897 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:14:46.028874 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:14:46.033595 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:14:46.041560 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:14:46.044026 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:14:46.045554 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:14:46.048009 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:14:46.048564 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:14:46.050044 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:14:46.051032 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:14:46.054173 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:14:46.062711 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:14:46.063356 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:14:46.064428 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:14:46.065122 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:14:46.065529 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:14:46.065874 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:14:46.066173 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:14:46.066768 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:14:46.069105 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:14:46.072860 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:14:46.073224 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:14:46.073764 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:14:46.074182 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:14:46.074587 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:14:46.075130 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:14:46.075478 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:14:46.075922 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:14:46.076593 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:14:46.077628 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:14:46.078157 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:14:46.078623 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:14:46.079085 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:14:46.079526 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:14:46.079920 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:14:46.080385 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:14:46.080776 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:14:46.083745 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:14:46.084199 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:14:46.084599 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:14:46.085387 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:14:46.086359 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:14:46.086813 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:14:46.087488 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:14:46.087945 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:14:46.088868 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:14:46.090299 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:14:46.091515 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:14:46.098450 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:14:46.099367 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:14:46.105484 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:14:46.107456 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:14:46.110634 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:14:46.115066 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:14:46.117835 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:14:46.234762 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m03:14:46.240536 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:14:46.241916 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:14:46.268004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1de6ed62-5823-4eb9-9ef4-f1c3e1fd4e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886efa0>]}
[0m03:14:46.270965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1de6ed62-5823-4eb9-9ef4-f1c3e1fd4e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087db100>]}
[0m03:14:46.271103 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:14:46.271229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de6ed62-5823-4eb9-9ef4-f1c3e1fd4e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de0a60>]}
[0m03:14:46.271824 [info ] [MainThread]: 
[0m03:14:46.272107 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:14:46.272593 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:14:46.279273 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:14:46.279413 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:14:46.279488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:14:48.043456 [debug] [ThreadPool]: SQL status: OK -1 in 1.76 seconds
[0m03:14:48.044780 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:14:48.045576 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_globalx_globalx"
[0m03:14:48.047271 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_globalx_globalx"
[0m03:14:48.047455 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='globalx_globalx', identifier=None)"
[0m03:14:48.051233 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_globalx_globalx"
[0m03:14:48.051365 [debug] [ThreadPool]: On create_AwsDataCatalog_globalx_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_globalx_globalx"} */
create schema if not exists globalx_globalx
  
[0m03:14:48.051470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:49.696518 [debug] [ThreadPool]: SQL status: OK -1 in 1.64 seconds
[0m03:14:49.700220 [debug] [ThreadPool]: On create_AwsDataCatalog_globalx_globalx: Close
[0m03:14:49.701646 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_globalx_globalx"
[0m03:14:49.706918 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_globalx_globalx"
[0m03:14:49.707033 [debug] [ThreadPool]: On list_AwsDataCatalog_globalx_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_globalx_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('globalx_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('globalx_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:14:49.707109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:51.372296 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m03:14:51.373866 [debug] [ThreadPool]: On list_AwsDataCatalog_globalx_globalx: Close
[0m03:14:51.374555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de6ed62-5823-4eb9-9ef4-f1c3e1fd4e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886edc0>]}
[0m03:14:51.375054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:14:51.375262 [info ] [MainThread]: 
[0m03:14:51.377500 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:14:51.377718 [info ] [Thread-1  ]: 1 of 3 START sql view model globalx_globalx.integrated_etf_data ................ [RUN]
[0m03:14:51.378145 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:14:51.379499 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:14:51.379639 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:14:51.382249 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:14:51.382662 [debug] [Thread-1  ]: finished collecting timing info
[0m03:14:51.382770 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:14:51.395381 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.integrated_etf_data"
[0m03:14:51.395868 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.integrated_etf_data"
[0m03:14:51.395965 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    globalx_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m03:14:51.396047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:16:13.100864 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.integrated_etf_data"} */
create or replace view
    globalx_globalx.integrated_etf_data
  as
    -- models/integrated_etf_data.sql
select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m03:16:13.102722 [debug] [Thread-1  ]: finished collecting timing info
[0m03:16:13.103019 [debug] [Thread-1  ]: On model.global_x_task.integrated_etf_data: Close
[0m03:16:13.103810 [debug] [Thread-1  ]: Runtime Error in model integrated_etf_data (models/integrated_etf_data.sql)
  line 23:6: Schema 'globalx' does not exist
[0m03:16:13.104101 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1de6ed62-5823-4eb9-9ef4-f1c3e1fd4e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11856e850>]}
[0m03:16:13.104548 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model globalx_globalx.integrated_etf_data ....... [[31mERROR[0m in 81.73s]
[0m03:16:13.105100 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:16:13.105804 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:16:13.106057 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:16:13.106193 [info ] [Thread-3  ]: 2 of 3 SKIP relation globalx_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:16:13.106392 [info ] [Thread-4  ]: 3 of 3 SKIP relation globalx_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:16:13.106767 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:16:13.107077 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:16:13.108480 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:16:13.109072 [info ] [MainThread]: 
[0m03:16:13.109345 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 26.84 seconds (86.84s).
[0m03:16:13.109596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:16:13.109731 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:16:13.116581 [info ] [MainThread]: 
[0m03:16:13.116866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:16:13.117108 [info ] [MainThread]: 
[0m03:16:13.117314 [error] [MainThread]: [33mRuntime Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:16:13.117485 [error] [MainThread]:   line 23:6: Schema 'globalx' does not exist
[0m03:16:13.117652 [info ] [MainThread]: 
[0m03:16:13.117828 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:16:13.118069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11856e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185cadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185b2a00>]}
[0m03:16:13.118257 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:18:40.523833 | e0ae6baa-1b0d-473d-9d03-90f2d6db29df ==============================
[0m03:18:40.523852 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:18:40.524203 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:18:40.524303 [debug] [MainThread]: Tracking: tracking
[0m03:18:40.534680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108000430>]}
[0m03:18:40.552136 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:18:40.552381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0ae6baa-1b0d-473d-9d03-90f2d6db29df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd2610>]}
[0m03:18:40.569844 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:18:40.570965 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:18:40.571503 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:18:40.575429 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:18:40.580137 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:18:40.581465 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:18:40.583409 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:18:40.583890 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:18:40.585558 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:18:40.585799 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:18:40.587559 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:18:40.588087 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:18:40.588263 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:18:40.591918 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:18:40.592613 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:18:40.594330 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:18:40.595572 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:18:40.596409 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:18:40.604081 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:18:40.610719 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:18:40.616756 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:18:40.619005 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:18:40.619953 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:18:40.620798 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:18:40.624465 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:18:40.632327 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:18:40.633144 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:18:40.636554 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:18:40.641693 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:18:40.650444 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:18:40.653130 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:18:40.654800 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:18:40.657325 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:18:40.658110 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:18:40.659878 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:18:40.661088 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:18:40.664558 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:18:40.673673 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:18:40.674490 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:18:40.675628 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:18:40.676345 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:18:40.676749 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:18:40.677110 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:18:40.677435 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:18:40.678113 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:18:40.680590 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:18:40.684456 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:18:40.684849 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:18:40.685569 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:18:40.686036 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:18:40.686458 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:18:40.687017 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:18:40.687372 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:18:40.687835 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:18:40.688586 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:18:40.689617 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:18:40.690152 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:18:40.690623 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:18:40.691081 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:18:40.691530 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:18:40.691930 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:18:40.692403 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:18:40.692798 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:18:40.696013 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:18:40.696650 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:18:40.697137 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:18:40.697970 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:18:40.699012 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:18:40.699482 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:18:40.700196 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:18:40.700679 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:18:40.701624 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:18:40.703139 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:18:40.704439 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:18:40.711294 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:18:40.712210 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:18:40.718504 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:18:40.720549 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:18:40.723882 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:18:40.728622 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:18:40.731515 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:18:40.848656 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m03:18:40.854561 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:18:40.855977 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:18:40.884071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0ae6baa-1b0d-473d-9d03-90f2d6db29df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108188160>]}
[0m03:18:40.887613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0ae6baa-1b0d-473d-9d03-90f2d6db29df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108028280>]}
[0m03:18:40.887782 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:18:40.887912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ae6baa-1b0d-473d-9d03-90f2d6db29df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080206d0>]}
[0m03:18:40.888510 [info ] [MainThread]: 
[0m03:18:40.888807 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:18:40.889249 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:18:40.895563 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:18:40.895719 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:18:40.895788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:42.668570 [debug] [ThreadPool]: SQL status: OK -1 in 1.77 seconds
[0m03:18:42.669795 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:18:42.670803 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:18:42.676512 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:18:42.676659 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:18:42.676747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:18:44.279349 [debug] [ThreadPool]: SQL status: OK -1 in 1.6 seconds
[0m03:18:44.282413 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:18:44.283734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ae6baa-1b0d-473d-9d03-90f2d6db29df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108210250>]}
[0m03:18:44.284168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:18:44.284317 [info ] [MainThread]: 
[0m03:18:44.285641 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:18:44.285792 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m03:18:44.286087 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:18:44.286958 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:18:44.287042 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:18:44.288712 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:18:44.289160 [debug] [Thread-1  ]: finished collecting timing info
[0m03:18:44.289241 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:18:44.295214 [debug] [Thread-1  ]: finished collecting timing info
[0m03:18:44.295641 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:18:44.295791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ae6baa-1b0d-473d-9d03-90f2d6db29df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea57460>]}
[0m03:18:44.295973 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.01s]
[0m03:18:44.296207 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:18:44.296696 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:18:44.296770 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:18:44.296939 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:18:44.297044 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:18:44.297506 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:18:44.297821 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:18:44.298670 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:18:44.298962 [info ] [MainThread]: 
[0m03:18:44.299092 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m03:18:44.299202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:18:44.299261 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:18:44.303085 [info ] [MainThread]: 
[0m03:18:44.303240 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:18:44.303362 [info ] [MainThread]: 
[0m03:18:44.303465 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:18:44.303567 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:18:44.303661 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m03:18:44.303753 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m03:18:44.303844 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m03:18:44.303935 [error] [MainThread]:   
[0m03:18:44.304025 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:18:44.304111 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:18:44.304199 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:18:44.304295 [info ] [MainThread]: 
[0m03:18:44.304390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:18:44.304534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108224760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108188190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea79220>]}
[0m03:18:44.304739 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:24:10.918343 | a2fe8dca-f2c5-46e3-890f-4838d26f1b58 ==============================
[0m03:24:10.918363 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:24:10.918914 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:24:10.919010 [debug] [MainThread]: Tracking: tracking
[0m03:24:10.929114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1a30>]}
[0m03:24:10.946929 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:24:10.947141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2fe8dca-f2c5-46e3-890f-4838d26f1b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846e250>]}
[0m03:24:10.965285 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:24:10.966564 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:24:10.967127 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:24:10.970851 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:24:10.975340 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:24:10.976812 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:24:10.979068 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:24:10.979686 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:24:10.981435 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:24:10.981702 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:24:10.983440 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:24:10.983973 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:24:10.984147 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:24:10.988281 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:24:10.989228 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:24:10.991138 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:24:10.992224 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:24:10.992952 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:24:11.000724 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:24:11.007553 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:24:11.013622 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:24:11.015773 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:24:11.016602 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:24:11.017428 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:24:11.021203 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:24:11.028915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:24:11.029685 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:24:11.032961 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:24:11.037931 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:24:11.046299 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:24:11.048928 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:24:11.050533 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:24:11.053079 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:24:11.053662 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:24:11.055202 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:24:11.056232 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:24:11.059465 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:24:11.068258 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:24:11.068935 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:24:11.070046 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:24:11.070747 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:24:11.071159 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:24:11.071521 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:24:11.071828 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:24:11.072444 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:24:11.074868 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:24:11.078748 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:24:11.079114 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:24:11.079670 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:24:11.080103 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:24:11.080536 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:24:11.081095 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:24:11.081455 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:24:11.081917 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:24:11.082644 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:24:11.083804 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:24:11.084442 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:24:11.084955 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:24:11.085459 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:24:11.085932 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:24:11.086353 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:24:11.086844 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:24:11.087278 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:24:11.090347 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:24:11.090829 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:24:11.091250 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:24:11.092075 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:24:11.093099 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:24:11.093579 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:24:11.094258 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:24:11.094733 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:24:11.095688 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:24:11.097171 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:24:11.098436 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:24:11.105291 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:24:11.106178 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:24:11.112437 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:24:11.114432 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:24:11.117778 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:24:11.122406 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:24:11.125319 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:24:11.244714 [debug] [MainThread]: 1699: static parser successfully parsed integrated_etf_data.sql
[0m03:24:11.250667 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:24:11.252085 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:24:11.279675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2fe8dca-f2c5-46e3-890f-4838d26f1b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108932700>]}
[0m03:24:11.283070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2fe8dca-f2c5-46e3-890f-4838d26f1b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ad5e0>]}
[0m03:24:11.283224 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:24:11.283361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2fe8dca-f2c5-46e3-890f-4838d26f1b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c6d30>]}
[0m03:24:11.284012 [info ] [MainThread]: 
[0m03:24:11.284322 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:24:11.284852 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:24:11.291716 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:24:11.291877 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:24:11.291952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:13.090852 [debug] [ThreadPool]: SQL status: OK -1 in 1.8 seconds
[0m03:24:13.091728 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:24:13.092488 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:24:13.096577 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:24:13.096700 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:24:13.096769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:14.720288 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m03:24:14.723069 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:24:14.724658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2fe8dca-f2c5-46e3-890f-4838d26f1b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aba250>]}
[0m03:24:14.725729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:24:14.726148 [info ] [MainThread]: 
[0m03:24:14.728463 [debug] [Thread-1  ]: Began running node model.global_x_task.integrated_etf_data
[0m03:24:14.728694 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.integrated_etf_data ................ [RUN]
[0m03:24:14.729051 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.integrated_etf_data"
[0m03:24:14.729942 [debug] [Thread-1  ]: Began compiling node model.global_x_task.integrated_etf_data
[0m03:24:14.730033 [debug] [Thread-1  ]: Compiling model.global_x_task.integrated_etf_data
[0m03:24:14.731775 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.integrated_etf_data"
[0m03:24:14.732105 [debug] [Thread-1  ]: finished collecting timing info
[0m03:24:14.732187 [debug] [Thread-1  ]: Began executing node model.global_x_task.integrated_etf_data
[0m03:24:14.737741 [debug] [Thread-1  ]: finished collecting timing info
[0m03:24:14.738111 [debug] [Thread-1  ]: Compilation Error in model integrated_etf_data (models/integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.integrated_etf_data
  Found: default_globalx.integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:24:14.738257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2fe8dca-f2c5-46e3-890f-4838d26f1b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd7370>]}
[0m03:24:14.738447 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.integrated_etf_data ....... [[31mERROR[0m in 0.01s]
[0m03:24:14.738650 [debug] [Thread-1  ]: Finished running node model.global_x_task.integrated_etf_data
[0m03:24:14.739058 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:24:14.739259 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:24:14.739409 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:24:14.739512 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:24:14.739697 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:24:14.739855 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:24:14.740949 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:24:14.741513 [info ] [MainThread]: 
[0m03:24:14.741768 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m03:24:14.741983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:24:14.742100 [debug] [MainThread]: Connection 'model.global_x_task.integrated_etf_data' was properly closed.
[0m03:24:14.747829 [info ] [MainThread]: 
[0m03:24:14.748023 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:24:14.748155 [info ] [MainThread]: 
[0m03:24:14.748259 [error] [MainThread]: [33mCompilation Error in model integrated_etf_data (models/integrated_etf_data.sql)[0m
[0m03:24:14.748362 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:24:14.748458 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.integrated_etf_data, or rename it to be less ambiguous.
[0m03:24:14.748550 [error] [MainThread]:   Searched for: default_globalx.integrated_etf_data
[0m03:24:14.748658 [error] [MainThread]:   Found: default_globalx.integrated_etf_data
[0m03:24:14.748753 [error] [MainThread]:   
[0m03:24:14.748848 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:24:14.748942 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:24:14.749031 [error] [MainThread]:   > called by model integrated_etf_data (models/integrated_etf_data.sql)
[0m03:24:14.749130 [info ] [MainThread]: 
[0m03:24:14.749225 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:24:14.749377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbfadf0>]}
[0m03:24:14.749497 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:25:20.878012 | d602665d-5433-4577-bf4c-24348ca61c7c ==============================
[0m03:25:20.878036 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:25:20.878424 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:25:20.878515 [debug] [MainThread]: Tracking: tracking
[0m03:25:20.886622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d94430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d90940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d90dc0>]}
[0m03:25:20.905054 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:25:20.905330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd602665d-5433-4577-bf4c-24348ca61c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d90940>]}
[0m03:25:20.916040 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:25:20.916871 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:25:20.917376 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:25:20.921431 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:25:20.926078 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:25:20.927347 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:25:20.929358 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:25:20.930081 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:25:20.931955 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:25:20.932240 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:25:20.934082 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:25:20.934649 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:25:20.934839 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:25:20.938602 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:25:20.939332 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:25:20.941088 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:25:20.942201 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:25:20.942986 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:25:20.950490 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:25:20.956922 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:25:20.962839 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:25:20.964970 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:25:20.965811 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:25:20.966644 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:25:20.970436 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:25:20.978322 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:25:20.979080 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:25:20.982306 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:25:20.987388 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:25:20.995920 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:25:20.998592 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:25:21.000263 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:25:21.002901 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:25:21.003512 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:25:21.005092 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:25:21.006170 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:25:21.009539 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:25:21.018420 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:25:21.019093 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:25:21.020210 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:25:21.020908 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:25:21.021318 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:25:21.021680 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:25:21.021992 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:25:21.022610 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:25:21.025015 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:25:21.028901 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:25:21.029275 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:25:21.029828 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:25:21.030260 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:25:21.030681 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:25:21.031237 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:25:21.031602 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:25:21.032067 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:25:21.032797 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:25:21.033865 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:25:21.034417 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:25:21.034901 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:25:21.035380 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:25:21.035841 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:25:21.036254 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:25:21.036743 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:25:21.037183 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:25:21.040224 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:25:21.040717 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:25:21.041148 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:25:21.041966 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:25:21.042979 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:25:21.043446 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:25:21.044123 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:25:21.044597 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:25:21.045553 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:25:21.047040 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:25:21.048302 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:25:21.055173 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:25:21.056063 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:25:21.062421 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:25:21.064478 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:25:21.067834 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:25:21.072498 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:25:21.075428 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:25:21.197815 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:25:21.203802 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m03:25:21.206458 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m03:25:21.207053 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:25:21.220276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f83490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f83520>]}
[0m03:25:21.220513 [debug] [MainThread]: Flushing usage events
[0m03:25:21.378693 [error] [MainThread]: Encountered an error:
Compilation Error in model fred_unemp (models/fred_unemp.sql)
  Model 'model.global_x_task.fred_unemp' (models/fred_unemp.sql) depends on a node named 'integrated_etf_data' which was not found


============================== 2024-06-06 03:25:52.975765 | e7f48340-7060-4cc9-a09d-5f6b65edf39b ==============================
[0m03:25:52.975783 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:25:52.977179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:25:52.977295 [debug] [MainThread]: Tracking: tracking
[0m03:25:52.986502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a4a00>]}
[0m03:25:53.003200 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:25:53.003424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7f48340-7060-4cc9-a09d-5f6b65edf39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108560760>]}
[0m03:25:53.013205 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:25:53.014179 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:25:53.014832 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:25:53.018715 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:25:53.023520 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:25:53.024916 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:25:53.026966 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:25:53.027484 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:25:53.029219 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:25:53.029483 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:25:53.031278 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:25:53.031829 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:25:53.032013 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:25:53.035801 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:25:53.036537 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:25:53.038439 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:25:53.039561 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:25:53.040306 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:25:53.047763 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:25:53.054749 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:25:53.060565 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:25:53.062684 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:25:53.063515 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:25:53.064324 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:25:53.067938 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:25:53.075585 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:25:53.076293 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:25:53.079471 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:25:53.084474 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:25:53.092670 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:25:53.095286 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:25:53.096884 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:25:53.099341 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:25:53.099912 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:25:53.101415 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:25:53.102622 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:25:53.106008 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:25:53.114863 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:25:53.115622 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:25:53.116724 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:25:53.117427 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:25:53.117856 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:25:53.118230 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:25:53.118587 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:25:53.119193 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:25:53.121558 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:25:53.125330 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:25:53.125699 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:25:53.126273 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:25:53.126735 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:25:53.127202 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:25:53.127799 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:25:53.128170 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:25:53.128625 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:25:53.129363 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:25:53.130420 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:25:53.130967 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:25:53.131435 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:25:53.131893 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:25:53.132340 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:25:53.132747 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:25:53.133210 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:25:53.133601 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:25:53.136651 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:25:53.137144 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:25:53.137553 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:25:53.138344 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:25:53.139326 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:25:53.139784 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:25:53.140447 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:25:53.140909 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:25:53.141839 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:25:53.143393 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:25:53.144727 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:25:53.151443 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:25:53.152506 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:25:53.158779 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:25:53.160823 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:25:53.164168 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:25:53.168868 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:25:53.171782 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:25:53.291038 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:25:53.297567 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m03:25:53.300640 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m03:25:53.301305 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:25:53.330092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f48340-7060-4cc9-a09d-5f6b65edf39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109424970>]}
[0m03:25:53.333477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f48340-7060-4cc9-a09d-5f6b65edf39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a4c10>]}
[0m03:25:53.333666 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:25:53.333805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f48340-7060-4cc9-a09d-5f6b65edf39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928aeb0>]}
[0m03:25:53.334457 [info ] [MainThread]: 
[0m03:25:53.334772 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:25:53.335286 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:25:53.341919 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:25:53.342068 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:25:53.342138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:55.200881 [debug] [ThreadPool]: SQL status: OK -1 in 1.86 seconds
[0m03:25:55.201754 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:25:55.202517 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:25:55.206577 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:25:55.206691 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:25:55.206759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:56.793989 [debug] [ThreadPool]: SQL status: OK -1 in 1.59 seconds
[0m03:25:56.795265 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:25:56.795831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f48340-7060-4cc9-a09d-5f6b65edf39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109424dc0>]}
[0m03:25:56.796295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:25:56.796526 [info ] [MainThread]: 
[0m03:25:56.798745 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:25:56.798937 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:25:56.799328 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:25:56.800490 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:25:56.800601 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:25:56.803110 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:25:56.803554 [debug] [Thread-1  ]: finished collecting timing info
[0m03:25:56.803677 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:25:56.814238 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:25:56.814417 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

        drop view if exists default_globalx.etl_integrated_etf_data
      
[0m03:25:56.814747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:25:58.405760 [debug] [Thread-1  ]: SQL status: OK -1 in 1.59 seconds
[0m03:25:58.414641 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m03:25:58.415851 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:25:58.416080 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m03:27:19.897727 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from globalx.integrated_etf_data

[0m03:27:19.899888 [debug] [Thread-1  ]: finished collecting timing info
[0m03:27:19.900205 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:27:19.901046 [debug] [Thread-1  ]: Runtime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  line 24:6: Schema 'globalx' does not exist
[0m03:27:19.901397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f48340-7060-4cc9-a09d-5f6b65edf39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112420c10>]}
[0m03:27:19.901944 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 83.10s]
[0m03:27:19.902456 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:27:19.903344 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:27:19.903529 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:27:19.903730 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:27:19.903918 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:27:19.904278 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:27:19.904594 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:27:19.906004 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:27:19.906614 [info ] [MainThread]: 
[0m03:27:19.906906 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 26.57 seconds (86.57s).
[0m03:27:19.907160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:19.907299 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:27:19.915286 [info ] [MainThread]: 
[0m03:27:19.915571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:27:19.915789 [info ] [MainThread]: 
[0m03:27:19.915968 [error] [MainThread]: [33mRuntime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:27:19.916143 [error] [MainThread]:   line 24:6: Schema 'globalx' does not exist
[0m03:27:19.916549 [info ] [MainThread]: 
[0m03:27:19.916718 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:27:19.916995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094df2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f5da60>]}
[0m03:27:19.917199 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:29:25.426351 | 9858daf7-6bc1-487d-97b4-2e165e63e054 ==============================
[0m03:29:25.426372 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:29:25.426765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:29:25.426863 [debug] [MainThread]: Tracking: tracking
[0m03:29:25.436156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104824730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813ee0>]}
[0m03:29:25.454603 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:29:25.454875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9858daf7-6bc1-487d-97b4-2e165e63e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ba670>]}
[0m03:29:25.473893 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:29:25.474912 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:29:25.475477 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:29:25.479472 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:29:25.484277 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:29:25.485657 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:29:25.487701 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:29:25.488220 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:29:25.489979 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:29:25.490244 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:29:25.492111 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:29:25.492688 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:29:25.492883 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:29:25.496862 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:29:25.497644 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:29:25.499420 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:29:25.500589 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:29:25.501359 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:29:25.509092 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:29:25.515733 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:29:25.521754 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:29:25.523889 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:29:25.524774 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:29:25.525616 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:29:25.529427 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:29:25.537229 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:29:25.537959 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:29:25.541149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:29:25.546192 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:29:25.554540 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:29:25.557151 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:29:25.558783 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:29:25.561364 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:29:25.561968 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:29:25.563518 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:29:25.564545 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:29:25.567733 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:29:25.576581 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:29:25.577281 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:29:25.578395 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:29:25.579092 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:29:25.579499 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:29:25.579856 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:29:25.580163 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:29:25.580774 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:29:25.583266 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:29:25.587278 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:29:25.587687 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:29:25.588265 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:29:25.588709 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:29:25.589138 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:29:25.589701 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:29:25.590071 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:29:25.590535 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:29:25.591310 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:29:25.592393 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:29:25.592960 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:29:25.593446 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:29:25.593925 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:29:25.594386 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:29:25.594800 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:29:25.595285 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:29:25.595694 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:29:25.598707 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:29:25.599191 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:29:25.599611 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:29:25.600620 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:29:25.601698 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:29:25.602176 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:29:25.602900 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:29:25.603383 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:29:25.604332 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:29:25.605794 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:29:25.607025 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:29:25.613811 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:29:25.614726 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:29:25.620879 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:29:25.622884 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:29:25.626089 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:29:25.630534 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:29:25.633331 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:29:25.748409 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:29:25.754227 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m03:29:25.756783 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m03:29:25.757363 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:29:25.784689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9858daf7-6bc1-487d-97b4-2e165e63e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ac5b0>]}
[0m03:29:25.788260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9858daf7-6bc1-487d-97b4-2e165e63e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104812760>]}
[0m03:29:25.788491 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:29:25.788649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9858daf7-6bc1-487d-97b4-2e165e63e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104824ac0>]}
[0m03:29:25.789315 [info ] [MainThread]: 
[0m03:29:25.789651 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:29:25.790187 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:29:25.796938 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:29:25.797108 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:29:25.797187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:27.697489 [debug] [ThreadPool]: SQL status: OK -1 in 1.9 seconds
[0m03:29:27.698998 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:29:27.699928 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_default_globalx"
[0m03:29:27.701664 [debug] [ThreadPool]: Acquiring new athena connection "create_AwsDataCatalog_default_default_globalx"
[0m03:29:27.701854 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='awsdatacatalog', schema='default_default_globalx', identifier=None)"
[0m03:29:27.706058 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_default_default_globalx"
[0m03:29:27.706206 [debug] [ThreadPool]: On create_AwsDataCatalog_default_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "create_AwsDataCatalog_default_default_globalx"} */
create schema if not exists default_default_globalx
  
[0m03:29:27.706322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:29.304089 [debug] [ThreadPool]: SQL status: OK -1 in 1.6 seconds
[0m03:29:29.308763 [debug] [ThreadPool]: On create_AwsDataCatalog_default_default_globalx: Close
[0m03:29:29.311305 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_default_globalx"
[0m03:29:29.321752 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_default_globalx"
[0m03:29:29.321963 [debug] [ThreadPool]: On list_AwsDataCatalog_default_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:29:29.322117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:30.995893 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m03:29:30.999631 [debug] [ThreadPool]: On list_AwsDataCatalog_default_default_globalx: Close
[0m03:29:31.000817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9858daf7-6bc1-487d-97b4-2e165e63e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104996a00>]}
[0m03:29:31.001748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:29:31.002148 [info ] [MainThread]: 
[0m03:29:31.006097 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:29:31.006449 [info ] [Thread-1  ]: 1 of 3 START sql view model default_default_globalx.etl_integrated_etf_data .... [RUN]
[0m03:29:31.007118 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:29:31.009353 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:29:31.009605 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:29:31.013953 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:29:31.014778 [debug] [Thread-1  ]: finished collecting timing info
[0m03:29:31.014937 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:29:31.029309 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:29:31.029539 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

        drop view if exists default_default_globalx.etl_integrated_etf_data
      
[0m03:29:31.029648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:52.871608 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

        drop view if exists default_default_globalx.etl_integrated_etf_data
      
[0m03:30:52.872393 [debug] [Thread-1  ]: finished collecting timing info
[0m03:30:52.872676 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:30:52.873544 [debug] [Thread-1  ]: Runtime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_default_globalx because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: e06a6c27-2312-437a-9385-672970573de4; Proxy: null)
[0m03:30:52.874010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9858daf7-6bc1-487d-97b4-2e165e63e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bc370>]}
[0m03:30:52.874564 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_default_globalx.etl_integrated_etf_data  [[31mERROR[0m in 81.87s]
[0m03:30:52.875158 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:30:52.876152 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:30:52.876392 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:30:52.876642 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_default_globalx.fred_unemp ........................ [[33mSKIP[0m]
[0m03:30:52.876850 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_default_globalx.polygon ........................... [[33mSKIP[0m]
[0m03:30:52.877205 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:30:52.877529 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:30:52.879077 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:30:52.879709 [info ] [MainThread]: 
[0m03:30:52.880001 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 27.09 seconds (87.09s).
[0m03:30:52.880252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:30:52.880387 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:30:52.888442 [info ] [MainThread]: 
[0m03:30:52.888769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:30:52.888992 [info ] [MainThread]: 
[0m03:30:52.889175 [error] [MainThread]: [33mRuntime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:30:52.889352 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:GetTable on resource: arn:aws:glue:us-east-2:975050278905:database/default_default_globalx because no identity-based policy allows the glue:GetTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: e06a6c27-2312-437a-9385-672970573de4; Proxy: null)
[0m03:30:52.889530 [info ] [MainThread]: 
[0m03:30:52.889695 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:30:52.889968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104978d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f48880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbc940>]}
[0m03:30:52.890176 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:31:48.980661 | fff90cf6-45cc-4b66-acaa-8d2799f66dea ==============================
[0m03:31:48.980681 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:31:48.981012 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:31:48.981104 [debug] [MainThread]: Tracking: tracking
[0m03:31:48.988588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844ce80>]}
[0m03:31:49.006375 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:31:49.006616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108014760>]}
[0m03:31:49.016282 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:31:49.017110 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m03:31:49.017641 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m03:31:49.021593 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:31:49.026326 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:31:49.027612 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:31:49.029538 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:31:49.030016 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:31:49.031740 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:31:49.032197 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:31:49.034100 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:31:49.034669 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:31:49.034855 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:31:49.038549 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:31:49.039255 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:31:49.040961 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:31:49.042050 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:31:49.042783 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:31:49.050063 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:31:49.056261 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:31:49.062161 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:31:49.064286 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:31:49.065132 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:31:49.065958 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:31:49.069701 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:31:49.077395 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:31:49.078132 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:31:49.081250 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:31:49.086262 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:31:49.094520 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:31:49.097057 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:31:49.098633 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:31:49.101122 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:31:49.101705 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:31:49.103200 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:31:49.104215 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:31:49.107438 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:31:49.116011 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:31:49.116662 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:31:49.117748 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:31:49.118432 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:31:49.118829 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:31:49.119187 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:31:49.119491 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:31:49.120101 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:31:49.122534 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:31:49.126355 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:31:49.126721 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:31:49.127262 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:31:49.127692 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:31:49.128106 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:31:49.128654 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:31:49.129009 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:31:49.129461 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:31:49.130180 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:31:49.131206 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:31:49.131743 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:31:49.132224 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:31:49.132685 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:31:49.133135 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:31:49.133536 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:31:49.134001 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:31:49.134398 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:31:49.137370 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:31:49.137836 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:31:49.138244 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:31:49.139036 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:31:49.140014 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:31:49.140464 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:31:49.141118 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:31:49.141578 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:31:49.142517 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:31:49.143948 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:31:49.145170 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:31:49.152026 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:31:49.152929 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:31:49.159028 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:31:49.160980 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:31:49.164147 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:31:49.168558 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:31:49.171326 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:31:49.286480 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:31:49.292362 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m03:31:49.294929 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m03:31:49.295530 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m03:31:49.322619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084af1c0>]}
[0m03:31:49.325769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844c580>]}
[0m03:31:49.325915 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:31:49.326045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843dbb0>]}
[0m03:31:49.326637 [info ] [MainThread]: 
[0m03:31:49.326936 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:31:49.327382 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:31:49.333772 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:31:49.333921 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:31:49.333990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:31:51.042835 [debug] [ThreadPool]: SQL status: OK -1 in 1.71 seconds
[0m03:31:51.044348 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:31:51.045663 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:31:51.052668 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:31:51.052841 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:31:51.052966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:31:52.699082 [debug] [ThreadPool]: SQL status: OK -1 in 1.65 seconds
[0m03:31:52.704173 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:31:52.705534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084dc1f0>]}
[0m03:31:52.706470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:31:52.706865 [info ] [MainThread]: 
[0m03:31:52.709251 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:31:52.709599 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:31:52.710260 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:31:52.712537 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:31:52.712737 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:31:52.717109 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:31:52.718008 [debug] [Thread-1  ]: finished collecting timing info
[0m03:31:52.718191 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:31:52.732998 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:31:52.733258 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

        drop view if exists default_globalx.etl_integrated_etf_data
      
[0m03:31:52.733413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:31:54.302741 [debug] [Thread-1  ]: SQL status: OK -1 in 1.57 seconds
[0m03:31:54.310602 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m03:31:54.311728 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:31:54.311909 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:31:55.730106 [debug] [Thread-1  ]: SQL status: OK -1 in 1.42 seconds
[0m03:31:55.743592 [debug] [Thread-1  ]: finished collecting timing info
[0m03:31:55.743967 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:31:55.744624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb8cf10>]}
[0m03:31:55.745065 [info ] [Thread-1  ]: 1 of 3 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.03s]
[0m03:31:55.745571 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:31:55.746278 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:31:55.746517 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:31:55.746805 [info ] [Thread-3  ]: 2 of 3 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m03:31:55.747044 [info ] [Thread-4  ]: 3 of 3 START sql table model default_globalx.polygon ........................... [RUN]
[0m03:31:55.747698 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m03:31:55.748206 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m03:31:55.748355 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m03:31:55.748486 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m03:31:55.748635 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m03:31:55.748755 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m03:31:55.751881 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m03:31:55.754455 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m03:31:55.755294 [debug] [Thread-3  ]: finished collecting timing info
[0m03:31:55.755456 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m03:31:55.755575 [debug] [Thread-4  ]: finished collecting timing info
[0m03:31:55.770141 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m03:31:55.770385 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m03:31:55.772358 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m03:31:55.772629 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m03:31:55.772744 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql
with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m03:31:55.772847 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:31:55.772942 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m03:31:55.778076 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql
with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m03:31:55.778189 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:31:57.455848 [debug] [Thread-4  ]: SQL status: OK 1506 in 1.68 seconds
[0m03:31:57.465151 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m03:31:57.465575 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m03:31:59.580419 [debug] [Thread-3  ]: SQL status: OK 48 in 3.81 seconds
[0m03:31:59.584249 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m03:31:59.584670 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m03:33:27.802962 [debug] [Thread-3  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m03:33:27.803637 [debug] [Thread-3  ]: finished collecting timing info
[0m03:33:27.803875 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m03:33:27.804539 [debug] [Thread-3  ]: Runtime Error in model fred_unemp (models/fred_unemp.sql)
  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:UpdateTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:UpdateTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 2e13d670-5a33-4171-a913-fcbf12cfa46a; Proxy: null)
[0m03:33:27.804827 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff1d310>]}
[0m03:33:27.805277 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 92.06s]
[0m03:33:27.805917 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:33:29.967751 [debug] [Thread-4  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m03:33:29.968287 [debug] [Thread-4  ]: finished collecting timing info
[0m03:33:29.968509 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m03:33:29.969160 [debug] [Thread-4  ]: Runtime Error in model polygon (models/polygon.sql)
  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:UpdateTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:UpdateTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 2d9efa10-d3fa-483a-8736-452633bdf373; Proxy: null)
[0m03:33:29.969448 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff90cf6-45cc-4b66-acaa-8d2799f66dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ef5e0>]}
[0m03:33:29.969899 [error] [Thread-4  ]: 3 of 3 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 94.22s]
[0m03:33:29.970359 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:33:29.971814 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:33:29.972392 [info ] [MainThread]: 
[0m03:33:29.972660 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 40.65 seconds (100.65s).
[0m03:33:29.972874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:33:29.972992 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:33:29.973103 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m03:33:29.973211 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m03:33:29.981677 [info ] [MainThread]: 
[0m03:33:29.981975 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:33:29.982198 [info ] [MainThread]: 
[0m03:33:29.982373 [error] [MainThread]: [33mRuntime Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m03:33:29.982551 [error] [MainThread]:   FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:UpdateTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:UpdateTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 2e13d670-5a33-4171-a913-fcbf12cfa46a; Proxy: null)
[0m03:33:29.982724 [info ] [MainThread]: 
[0m03:33:29.982889 [error] [MainThread]: [33mRuntime Error in model polygon (models/polygon.sql)[0m
[0m03:33:29.983051 [error] [MainThread]:   FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:UpdateTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:UpdateTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: 2d9efa10-d3fa-483a-8736-452633bdf373; Proxy: null)
[0m03:33:29.983225 [info ] [MainThread]: 
[0m03:33:29.983387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m03:33:29.983622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086129d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff1af40>]}
[0m03:33:29.983839 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:37:16.766031 | e2ebaaca-1e8c-47f7-b4ce-5449c1c2d29b ==============================
[0m03:37:16.766053 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:37:16.766833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:37:16.767015 [debug] [MainThread]: Tracking: tracking
[0m03:37:16.780003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914ff70>]}
[0m03:37:16.819283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:37:16.819449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:37:16.823388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ebaaca-1e8c-47f7-b4ce-5449c1c2d29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f20d0>]}
[0m03:37:16.827177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ebaaca-1e8c-47f7-b4ce-5449c1c2d29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c61f0>]}
[0m03:37:16.827402 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:37:16.827549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ebaaca-1e8c-47f7-b4ce-5449c1c2d29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109172e80>]}
[0m03:37:16.828234 [info ] [MainThread]: 
[0m03:37:16.828563 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:37:16.829162 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:37:16.836375 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:37:16.836552 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:37:16.836624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:37:18.524352 [debug] [ThreadPool]: SQL status: OK -1 in 1.69 seconds
[0m03:37:18.525407 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:37:18.526232 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:37:18.530788 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:37:18.530967 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:37:18.531077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:37:20.414728 [debug] [ThreadPool]: SQL status: OK -1 in 1.88 seconds
[0m03:37:20.417654 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:37:20.418852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ebaaca-1e8c-47f7-b4ce-5449c1c2d29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a0220>]}
[0m03:37:20.419700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:37:20.420084 [info ] [MainThread]: 
[0m03:37:20.424115 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:37:20.424522 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:37:20.425278 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:37:20.427406 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:37:20.427622 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:37:20.431901 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:37:20.432514 [debug] [Thread-1  ]: finished collecting timing info
[0m03:37:20.432691 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:37:20.442882 [debug] [Thread-1  ]: finished collecting timing info
[0m03:37:20.443412 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:37:20.443620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ebaaca-1e8c-47f7-b4ce-5449c1c2d29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b140fd0>]}
[0m03:37:20.443897 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 0.02s]
[0m03:37:20.444190 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:37:20.444672 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:37:20.444883 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:37:20.445087 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:37:20.445229 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:37:20.445540 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:37:20.445728 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:37:20.446680 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:37:20.446975 [info ] [MainThread]: 
[0m03:37:20.447107 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m03:37:20.447338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:37:20.447407 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:37:20.450629 [info ] [MainThread]: 
[0m03:37:20.450786 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:37:20.450909 [info ] [MainThread]: 
[0m03:37:20.451013 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:37:20.451115 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:37:20.451280 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m03:37:20.451393 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m03:37:20.451492 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m03:37:20.451585 [error] [MainThread]:   
[0m03:37:20.451678 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:37:20.451774 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:37:20.451866 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:37:20.451970 [info ] [MainThread]: 
[0m03:37:20.452072 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:37:20.452231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109159250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1408e0>]}
[0m03:37:20.452371 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:38:04.374077 | 09d0437c-df8a-4d95-bdd7-05d4d88f7b14 ==============================
[0m03:38:04.374095 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:38:04.374675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:38:04.374782 [debug] [MainThread]: Tracking: tracking
[0m03:38:04.383606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a0220>]}
[0m03:38:04.417477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:38:04.417637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:38:04.420930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d0437c-df8a-4d95-bdd7-05d4d88f7b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864df10>]}
[0m03:38:04.424075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d0437c-df8a-4d95-bdd7-05d4d88f7b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861a0d0>]}
[0m03:38:04.424216 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 275 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:38:04.424347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d0437c-df8a-4d95-bdd7-05d4d88f7b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861a0a0>]}
[0m03:38:04.424984 [info ] [MainThread]: 
[0m03:38:04.425286 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:38:04.425765 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:38:04.432138 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:38:04.432265 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:38:04.432338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:38:06.202226 [debug] [ThreadPool]: SQL status: OK -1 in 1.77 seconds
[0m03:38:06.206693 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:38:06.208935 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:38:06.218922 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:38:06.219132 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:38:06.219289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:38:07.874191 [debug] [ThreadPool]: SQL status: OK -1 in 1.65 seconds
[0m03:38:07.877212 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:38:07.878501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d0437c-df8a-4d95-bdd7-05d4d88f7b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870d130>]}
[0m03:38:07.879359 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:38:07.879711 [info ] [MainThread]: 
[0m03:38:07.882441 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:38:07.882844 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:38:07.883538 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:38:07.885829 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:38:07.886049 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:38:07.890367 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:38:07.892481 [debug] [Thread-1  ]: finished collecting timing info
[0m03:38:07.892698 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:38:07.902739 [debug] [Thread-1  ]: finished collecting timing info
[0m03:38:07.903290 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:38:07.903920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d0437c-df8a-4d95-bdd7-05d4d88f7b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c08e0>]}
[0m03:38:07.904266 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 0.02s]
[0m03:38:07.904592 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:38:07.905047 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:38:07.905166 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:38:07.905337 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:38:07.905482 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:38:07.905733 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:38:07.905955 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:38:07.906829 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:38:07.907170 [info ] [MainThread]: 
[0m03:38:07.907332 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m03:38:07.907476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:38:07.907552 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:38:07.912018 [info ] [MainThread]: 
[0m03:38:07.912243 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:38:07.912419 [info ] [MainThread]: 
[0m03:38:07.912561 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:38:07.912703 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:38:07.912833 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m03:38:07.912960 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m03:38:07.913089 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m03:38:07.913214 [error] [MainThread]:   
[0m03:38:07.913338 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:38:07.913462 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:38:07.913590 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:38:07.913724 [info ] [MainThread]: 
[0m03:38:07.913865 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:38:07.914070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084adb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c0ac0>]}
[0m03:38:07.914235 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:43:48.477022 | 46978b6a-a122-4ccb-8261-ea8e2e809106 ==============================
[0m03:43:48.477040 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:43:48.477545 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:43:48.477666 [debug] [MainThread]: Tracking: tracking
[0m03:43:48.486484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a04640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a04220>]}
[0m03:43:48.520818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m03:43:48.521028 [debug] [MainThread]: Partial parsing: added file: global_x_task://macros/drop_view.sql
[0m03:43:48.521158 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/etl_integrated_etf_data.sql
[0m03:43:48.521236 [debug] [MainThread]: Parsing macros/drop_view.sql
[0m03:43:48.528489 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m03:43:48.539451 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m03:43:48.548350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46978b6a-a122-4ccb-8261-ea8e2e809106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba0070>]}
[0m03:43:48.551315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46978b6a-a122-4ccb-8261-ea8e2e809106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b76f70>]}
[0m03:43:48.551448 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:43:48.551574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46978b6a-a122-4ccb-8261-ea8e2e809106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106971af0>]}
[0m03:43:48.552145 [info ] [MainThread]: 
[0m03:43:48.552434 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:43:48.552892 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:43:48.556468 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:43:48.556554 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:43:48.556620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:50.443765 [debug] [ThreadPool]: SQL status: OK -1 in 1.89 seconds
[0m03:43:50.447409 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:43:50.449648 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:43:50.460174 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:43:50.460418 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:43:50.460667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:52.172869 [debug] [ThreadPool]: SQL status: OK -1 in 1.71 seconds
[0m03:43:52.177458 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:43:52.178813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46978b6a-a122-4ccb-8261-ea8e2e809106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1cb80>]}
[0m03:43:52.179748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:43:52.180140 [info ] [MainThread]: 
[0m03:43:52.183796 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:43:52.184164 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:43:52.184818 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:43:52.186973 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:43:52.187201 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:43:52.236998 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:43:52.237197 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:43:52.237278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:45:14.085064 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:45:14.088214 [debug] [Thread-1  ]: finished collecting timing info
[0m03:45:14.088555 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:45:14.089358 [debug] [Thread-1  ]: Runtime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:DeleteTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:DeleteTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: e08366f5-ccbe-40b3-b970-3e374c46f5a0; Proxy: null)
[0m03:45:14.089736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46978b6a-a122-4ccb-8261-ea8e2e809106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea4d30>]}
[0m03:45:14.090277 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 81.91s]
[0m03:45:14.090769 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:45:14.091532 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:45:14.092045 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:45:14.092200 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:45:14.092414 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:45:14.092778 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:45:14.093095 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:45:14.094618 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:45:14.095248 [info ] [MainThread]: 
[0m03:45:14.095552 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 25.54 seconds (85.54s).
[0m03:45:14.095805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:14.095941 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:45:14.103725 [info ] [MainThread]: 
[0m03:45:14.104028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:45:14.104236 [info ] [MainThread]: 
[0m03:45:14.104408 [error] [MainThread]: [33mRuntime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:45:14.104575 [error] [MainThread]:   User: arn:aws:iam::975050278905:user/octavio_lima is not authorized to perform: glue:DeleteTable on resource: arn:aws:glue:us-east-2:975050278905:catalog because no identity-based policy allows the glue:DeleteTable action (Service: AmazonDataCatalog; Status Code: 400; Error Code: AccessDeniedException; Request ID: e08366f5-ccbe-40b3-b970-3e374c46f5a0; Proxy: null)
[0m03:45:14.104750 [info ] [MainThread]: 
[0m03:45:14.104912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:45:14.105154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e67f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e67e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e67be0>]}
[0m03:45:14.105348 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:47:45.986211 | b6a81d78-2937-4d5f-8f3f-f0d050335ef8 ==============================
[0m03:47:45.986227 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:47:45.986748 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:47:45.986835 [debug] [MainThread]: Tracking: tracking
[0m03:47:45.995921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bba30>]}
[0m03:47:46.032774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:47:46.032919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:47:46.036146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a81d78-2937-4d5f-8f3f-f0d050335ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042610d0>]}
[0m03:47:46.039484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a81d78-2937-4d5f-8f3f-f0d050335ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b5370>]}
[0m03:47:46.039629 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:47:46.039766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a81d78-2937-4d5f-8f3f-f0d050335ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b8a30>]}
[0m03:47:46.040421 [info ] [MainThread]: 
[0m03:47:46.040717 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:47:46.041206 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:47:46.047568 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:47:46.047705 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:47:46.047775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:47.788655 [debug] [ThreadPool]: SQL status: OK -1 in 1.74 seconds
[0m03:47:47.794042 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:47:47.796250 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:47:47.806171 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:47:47.806380 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:47:47.806522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:49.477458 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m03:47:49.480479 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:47:49.481420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a81d78-2937-4d5f-8f3f-f0d050335ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430c220>]}
[0m03:47:49.482025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:47:49.482277 [info ] [MainThread]: 
[0m03:47:49.485584 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:47:49.485860 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:47:49.486345 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:47:49.487954 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:47:49.488109 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:47:49.495895 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:47:49.496241 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:47:49.496626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:47:51.127982 [debug] [Thread-1  ]: SQL status: OK -1 in 1.63 seconds
[0m03:47:51.131441 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:47:51.131958 [debug] [Thread-1  ]: finished collecting timing info
[0m03:47:51.132092 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:47:51.138312 [debug] [Thread-1  ]: finished collecting timing info
[0m03:47:51.138547 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:47:51.138897 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:47:51.139077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a81d78-2937-4d5f-8f3f-f0d050335ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfcc10>]}
[0m03:47:51.139255 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.65s]
[0m03:47:51.139450 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:47:51.139898 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:47:51.140096 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:47:51.140228 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:47:51.140432 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:47:51.140718 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:47:51.140992 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:47:51.141882 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:47:51.142200 [info ] [MainThread]: 
[0m03:47:51.142332 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m03:47:51.142442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:51.142504 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:47:51.146814 [info ] [MainThread]: 
[0m03:47:51.147003 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:47:51.147129 [info ] [MainThread]: 
[0m03:47:51.147234 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:47:51.147339 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:47:51.147435 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m03:47:51.147534 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m03:47:51.147628 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m03:47:51.147719 [error] [MainThread]:   
[0m03:47:51.147811 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:47:51.147905 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:47:51.148000 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:47:51.148101 [info ] [MainThread]: 
[0m03:47:51.148246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:47:51.148499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfa4f0>]}
[0m03:47:51.148668 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:49:38.575278 | 031e649e-5142-4cb8-a507-08d2facefb50 ==============================
[0m03:49:38.575303 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:49:38.575801 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:49:38.575888 [debug] [MainThread]: Tracking: tracking
[0m03:49:38.585084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acc640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acc220>]}
[0m03:49:38.621395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:49:38.621555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:49:38.625067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '031e649e-5142-4cb8-a507-08d2facefb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c750d0>]}
[0m03:49:38.628780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '031e649e-5142-4cb8-a507-08d2facefb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b57400>]}
[0m03:49:38.628950 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:49:38.629089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031e649e-5142-4cb8-a507-08d2facefb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b57490>]}
[0m03:49:38.629751 [info ] [MainThread]: 
[0m03:49:38.630063 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:49:38.630558 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:49:38.637501 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:49:38.637661 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:49:38.637734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:40.401281 [debug] [ThreadPool]: SQL status: OK -1 in 1.76 seconds
[0m03:49:40.402657 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:49:40.403802 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:49:40.408728 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:49:40.408916 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:49:40.409047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:42.080061 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m03:49:42.082573 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:49:42.083409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031e649e-5142-4cb8-a507-08d2facefb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad4ee0>]}
[0m03:49:42.083816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:49:42.083974 [info ] [MainThread]: 
[0m03:49:42.085885 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:49:42.086057 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:49:42.086456 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:49:42.087421 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:49:42.087606 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:49:42.091187 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:49:42.091291 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:49:42.091363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:49:43.729692 [debug] [Thread-1  ]: SQL status: OK -1 in 1.64 seconds
[0m03:49:43.733440 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:49:43.734519 [debug] [Thread-1  ]: finished collecting timing info
[0m03:49:43.734725 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:49:43.754536 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m03:49:43.755552 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:49:43.755724 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:49:45.206325 [debug] [Thread-1  ]: SQL status: OK -1 in 1.45 seconds
[0m03:49:45.217410 [debug] [Thread-1  ]: finished collecting timing info
[0m03:49:45.217848 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:49:45.218502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031e649e-5142-4cb8-a507-08d2facefb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2b850>]}
[0m03:49:45.218920 [info ] [Thread-1  ]: 1 of 3 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.13s]
[0m03:49:45.219493 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:49:45.220310 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:49:45.220562 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:49:45.220857 [info ] [Thread-3  ]: 2 of 3 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m03:49:45.221071 [info ] [Thread-4  ]: 3 of 3 START sql table model default_globalx.polygon ........................... [RUN]
[0m03:49:45.221686 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m03:49:45.222209 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m03:49:45.222363 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m03:49:45.222495 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m03:49:45.222649 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m03:49:45.222773 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m03:49:45.226421 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m03:49:45.228947 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m03:49:45.229854 [debug] [Thread-3  ]: finished collecting timing info
[0m03:49:45.230027 [debug] [Thread-4  ]: finished collecting timing info
[0m03:49:45.230212 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m03:49:45.230353 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m03:49:45.237296 [debug] [Thread-3  ]: finished collecting timing info
[0m03:49:45.239092 [debug] [Thread-4  ]: finished collecting timing info
[0m03:49:45.239569 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m03:49:45.239918 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m03:49:45.240098 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031e649e-5142-4cb8-a507-08d2facefb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11011aeb0>]}
[0m03:49:45.240244 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031e649e-5142-4cb8-a507-08d2facefb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11011adc0>]}
[0m03:49:45.240494 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m03:49:45.240699 [error] [Thread-4  ]: 3 of 3 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m03:49:45.240981 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:49:45.241319 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:49:45.242468 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:49:45.242894 [info ] [MainThread]: 
[0m03:49:45.243072 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m03:49:45.243223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:45.243303 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:49:45.243418 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m03:49:45.243494 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m03:49:45.248308 [info ] [MainThread]: 
[0m03:49:45.248505 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:49:45.248670 [info ] [MainThread]: 
[0m03:49:45.248809 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m03:49:45.248946 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:49:45.249075 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m03:49:45.249203 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m03:49:45.249329 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m03:49:45.249455 [error] [MainThread]:   
[0m03:49:45.249580 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m03:49:45.249705 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m03:49:45.249832 [info ] [MainThread]: 
[0m03:49:45.249962 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m03:49:45.250091 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:49:45.250219 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m03:49:45.250345 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m03:49:45.250470 [error] [MainThread]:   Found: default_globalx.polygon
[0m03:49:45.250595 [error] [MainThread]:   
[0m03:49:45.250721 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m03:49:45.250844 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m03:49:45.250979 [info ] [MainThread]: 
[0m03:49:45.251110 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m03:49:45.251301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110416340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110416370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f91c0>]}
[0m03:49:45.251457 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:51:34.820460 | d8842ed3-7257-4c44-8797-be12dbd45995 ==============================
[0m03:51:34.820484 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:51:34.821180 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:51:34.821286 [debug] [MainThread]: Tracking: tracking
[0m03:51:34.832839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104350c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043502e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104350e80>]}
[0m03:51:34.867429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:51:34.867679 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/polygon.sql
[0m03:51:34.867797 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m03:51:34.876168 [debug] [MainThread]: 1603: static parser failed on polygon.sql
[0m03:51:34.883676 [debug] [MainThread]: 1602: parser fallback to jinja rendering on polygon.sql
[0m03:51:34.884392 [debug] [MainThread]: 1603: static parser failed on fred_unemp.sql
[0m03:51:34.886706 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fred_unemp.sql
[0m03:51:34.895647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8842ed3-7257-4c44-8797-be12dbd45995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ba4c0>]}
[0m03:51:34.899039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8842ed3-7257-4c44-8797-be12dbd45995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449b100>]}
[0m03:51:34.899188 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:51:34.899320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8842ed3-7257-4c44-8797-be12dbd45995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104368d30>]}
[0m03:51:34.899933 [info ] [MainThread]: 
[0m03:51:34.900227 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:51:34.900683 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:51:34.906800 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:51:34.906920 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:51:34.906999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:36.649920 [debug] [ThreadPool]: SQL status: OK -1 in 1.74 seconds
[0m03:51:36.654088 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:51:36.656297 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:51:36.666253 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:51:36.666465 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:51:36.666615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:38.413909 [debug] [ThreadPool]: SQL status: OK -1 in 1.75 seconds
[0m03:51:38.415155 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:51:38.415726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8842ed3-7257-4c44-8797-be12dbd45995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd9490>]}
[0m03:51:38.416155 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:51:38.416351 [info ] [MainThread]: 
[0m03:51:38.418578 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:51:38.418851 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:51:38.419292 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:51:38.420478 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:51:38.420585 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:51:38.425585 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:51:38.425753 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:51:38.425848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:51:40.013463 [debug] [Thread-1  ]: SQL status: OK -1 in 1.59 seconds
[0m03:51:40.017739 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:51:40.018769 [debug] [Thread-1  ]: finished collecting timing info
[0m03:51:40.019030 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:51:40.032671 [debug] [Thread-1  ]: finished collecting timing info
[0m03:51:40.032938 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:51:40.033450 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:51:40.033707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8842ed3-7257-4c44-8797-be12dbd45995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d52d90>]}
[0m03:51:40.034050 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.61s]
[0m03:51:40.034410 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:51:40.035016 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:51:40.035222 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:51:40.035328 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:51:40.035485 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:51:40.035759 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:51:40.035992 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:51:40.037165 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:51:40.037612 [info ] [MainThread]: 
[0m03:51:40.037812 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m03:51:40.038001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:40.038101 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:51:40.045336 [info ] [MainThread]: 
[0m03:51:40.045609 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:51:40.045806 [info ] [MainThread]: 
[0m03:51:40.045965 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:51:40.046140 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:51:40.046287 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m03:51:40.046432 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m03:51:40.046576 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m03:51:40.046802 [error] [MainThread]:   
[0m03:51:40.047008 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:51:40.047156 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:51:40.047299 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:51:40.047454 [info ] [MainThread]: 
[0m03:51:40.047607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:51:40.047816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10203e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104559640>]}
[0m03:51:40.047976 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:51:45.116936 | 83247912-21c7-479f-aba8-84d9bdd75d56 ==============================
[0m03:51:45.116950 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:51:45.117296 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:51:45.117385 [debug] [MainThread]: Tracking: tracking
[0m03:51:45.125044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cc670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cc730>]}
[0m03:51:45.151550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:51:45.151700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:51:45.154870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83247912-21c7-479f-aba8-84d9bdd75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5760d0>]}
[0m03:51:45.158730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83247912-21c7-479f-aba8-84d9bdd75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c4430>]}
[0m03:51:45.158862 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:51:45.158993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83247912-21c7-479f-aba8-84d9bdd75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d53a0>]}
[0m03:51:45.159604 [info ] [MainThread]: 
[0m03:51:45.159903 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:51:45.160423 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:51:45.166893 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:51:45.167072 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:51:45.167147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:46.903375 [debug] [ThreadPool]: SQL status: OK -1 in 1.74 seconds
[0m03:51:46.906787 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:51:46.909022 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:51:46.918900 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:51:46.919109 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:51:46.919257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:48.575112 [debug] [ThreadPool]: SQL status: OK -1 in 1.66 seconds
[0m03:51:48.578739 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:51:48.580089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83247912-21c7-479f-aba8-84d9bdd75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f2a90>]}
[0m03:51:48.581042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:51:48.581438 [info ] [MainThread]: 
[0m03:51:48.583816 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:51:48.584162 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:51:48.584826 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:51:48.587189 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:51:48.587401 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:51:48.595294 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:51:48.595503 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:51:48.595619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:51:50.233381 [debug] [Thread-1  ]: SQL status: OK -1 in 1.64 seconds
[0m03:51:50.237589 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:51:50.238644 [debug] [Thread-1  ]: finished collecting timing info
[0m03:51:50.238906 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:51:50.258761 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m03:51:50.259422 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:51:50.259587 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:51:51.722935 [debug] [Thread-1  ]: SQL status: OK -1 in 1.46 seconds
[0m03:51:51.734996 [debug] [Thread-1  ]: finished collecting timing info
[0m03:51:51.735348 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:51:51.735984 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83247912-21c7-479f-aba8-84d9bdd75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9db250>]}
[0m03:51:51.736401 [info ] [Thread-1  ]: 1 of 3 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.15s]
[0m03:51:51.736893 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:51:51.737587 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:51:51.737866 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:51:51.738066 [info ] [Thread-3  ]: 2 of 3 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m03:51:51.738307 [info ] [Thread-4  ]: 3 of 3 START sql table model default_globalx.polygon ........................... [RUN]
[0m03:51:51.738863 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m03:51:51.739345 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m03:51:51.739504 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m03:51:51.739643 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m03:51:51.739796 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m03:51:51.739922 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m03:51:51.743346 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m03:51:51.746258 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m03:51:51.746870 [debug] [Thread-4  ]: finished collecting timing info
[0m03:51:51.747015 [debug] [Thread-3  ]: finished collecting timing info
[0m03:51:51.747127 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m03:51:51.747255 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m03:51:51.753804 [debug] [Thread-4  ]: finished collecting timing info
[0m03:51:51.755622 [debug] [Thread-3  ]: finished collecting timing info
[0m03:51:51.756101 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m03:51:51.756448 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m03:51:51.756638 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83247912-21c7-479f-aba8-84d9bdd75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11946bbb0>]}
[0m03:51:51.756824 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83247912-21c7-479f-aba8-84d9bdd75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11946bca0>]}
[0m03:51:51.757079 [error] [Thread-4  ]: 3 of 3 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m03:51:51.757276 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m03:51:51.757545 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:51:51.757834 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:51:51.758876 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:51:51.759277 [info ] [MainThread]: 
[0m03:51:51.759465 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m03:51:51.759632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:51.759719 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:51:51.759803 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m03:51:51.759885 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m03:51:51.764980 [info ] [MainThread]: 
[0m03:51:51.765160 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:51:51.765322 [info ] [MainThread]: 
[0m03:51:51.765460 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m03:51:51.765592 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:51:51.765719 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m03:51:51.765842 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m03:51:51.765967 [error] [MainThread]:   Found: default_globalx.polygon
[0m03:51:51.766092 [error] [MainThread]:   
[0m03:51:51.766217 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m03:51:51.766341 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m03:51:51.766466 [info ] [MainThread]: 
[0m03:51:51.766594 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m03:51:51.766719 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:51:51.766846 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m03:51:51.766969 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m03:51:51.767092 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m03:51:51.767215 [error] [MainThread]:   
[0m03:51:51.767336 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m03:51:51.767459 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m03:51:51.767591 [info ] [MainThread]: 
[0m03:51:51.767716 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m03:51:51.767901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a545a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5459a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5330a0>]}
[0m03:51:51.768047 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:52:12.954882 | 94afa9da-87dc-4d3d-8dbe-c45a89ee8a63 ==============================
[0m03:52:12.954899 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:52:12.955234 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:52:12.955326 [debug] [MainThread]: Tracking: tracking
[0m03:52:12.963081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122cc430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ce940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122cedc0>]}
[0m03:52:12.990019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:52:12.990173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:52:12.993354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94afa9da-87dc-4d3d-8dbe-c45a89ee8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124760d0>]}
[0m03:52:12.996649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94afa9da-87dc-4d3d-8dbe-c45a89ee8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c9460>]}
[0m03:52:12.996786 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:52:12.996917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94afa9da-87dc-4d3d-8dbe-c45a89ee8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122cc430>]}
[0m03:52:12.997583 [info ] [MainThread]: 
[0m03:52:12.997917 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:52:12.998400 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:52:13.004804 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:52:13.004964 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:52:13.005044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:52:15.365902 [debug] [ThreadPool]: SQL status: OK -1 in 2.36 seconds
[0m03:52:15.370228 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:52:15.372453 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:52:15.382760 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:52:15.382972 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:52:15.383206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:52:16.994399 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m03:52:16.996029 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:52:16.996839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94afa9da-87dc-4d3d-8dbe-c45a89ee8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f2d00>]}
[0m03:52:16.997445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:52:16.997693 [info ] [MainThread]: 
[0m03:52:16.999394 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:52:16.999681 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:52:17.000145 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:52:17.001618 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:52:17.001754 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:52:17.007359 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:52:17.007528 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:52:17.007630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:52:18.616229 [debug] [Thread-1  ]: SQL status: OK -1 in 1.61 seconds
[0m03:52:18.620871 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:52:18.621758 [debug] [Thread-1  ]: finished collecting timing info
[0m03:52:18.622009 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:52:18.635464 [debug] [Thread-1  ]: finished collecting timing info
[0m03:52:18.635687 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:52:18.636155 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:52:18.636383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94afa9da-87dc-4d3d-8dbe-c45a89ee8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116001c70>]}
[0m03:52:18.636702 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.64s]
[0m03:52:18.637056 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:52:18.637562 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:52:18.637765 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:52:18.637875 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:52:18.638039 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:52:18.638320 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:52:18.638891 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:52:18.639840 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:52:18.640262 [info ] [MainThread]: 
[0m03:52:18.640476 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m03:52:18.640654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:52:18.640752 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:52:18.647108 [info ] [MainThread]: 
[0m03:52:18.647336 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:52:18.647517 [info ] [MainThread]: 
[0m03:52:18.647671 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:52:18.647823 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:52:18.647967 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m03:52:18.648109 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m03:52:18.648248 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m03:52:18.648388 [error] [MainThread]:   
[0m03:52:18.648530 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:52:18.648671 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:52:18.648809 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:52:18.648954 [info ] [MainThread]: 
[0m03:52:18.649102 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:52:18.649310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124459d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112521220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c73100>]}
[0m03:52:18.649477 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:52:37.884346 | 1f145140-83a6-450c-a2ad-ce4a279903c8 ==============================
[0m03:52:37.884367 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:52:37.884712 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:52:37.884809 [debug] [MainThread]: Tracking: tracking
[0m03:52:37.893272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa4700>]}
[0m03:52:37.920987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:52:37.921145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:52:37.924363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f145140-83a6-450c-a2ad-ce4a279903c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d360d0>]}
[0m03:52:37.927624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f145140-83a6-450c-a2ad-ce4a279903c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8a400>]}
[0m03:52:37.927780 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:52:37.927913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f145140-83a6-450c-a2ad-ce4a279903c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a86640>]}
[0m03:52:37.928528 [info ] [MainThread]: 
[0m03:52:37.928816 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:52:37.929275 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:52:37.935595 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:52:37.935735 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:52:37.935809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:52:39.631002 [debug] [ThreadPool]: SQL status: OK -1 in 1.7 seconds
[0m03:52:39.635344 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:52:39.637541 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:52:39.647601 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:52:39.647809 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:52:39.647956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:52:41.311015 [debug] [ThreadPool]: SQL status: OK -1 in 1.66 seconds
[0m03:52:41.314860 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:52:41.316205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f145140-83a6-450c-a2ad-ce4a279903c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abed90>]}
[0m03:52:41.317154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:52:41.317563 [info ] [MainThread]: 
[0m03:52:41.320079 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:52:41.320441 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:52:41.321095 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:52:41.323339 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:52:41.323554 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:52:41.331490 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:52:41.331715 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:52:41.331907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:52:42.914316 [debug] [Thread-1  ]: SQL status: OK -1 in 1.58 seconds
[0m03:52:42.918627 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:52:42.919791 [debug] [Thread-1  ]: finished collecting timing info
[0m03:52:42.920059 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:52:42.939551 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m03:52:42.940115 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:52:42.940249 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:52:44.352200 [debug] [Thread-1  ]: SQL status: OK -1 in 1.41 seconds
[0m03:52:44.363986 [debug] [Thread-1  ]: finished collecting timing info
[0m03:52:44.364329 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:52:44.365100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f145140-83a6-450c-a2ad-ce4a279903c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122982af0>]}
[0m03:52:44.365567 [info ] [Thread-1  ]: 1 of 3 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.04s]
[0m03:52:44.366065 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:52:44.366778 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:52:44.367012 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:52:44.367245 [info ] [Thread-3  ]: 2 of 3 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m03:52:44.367457 [info ] [Thread-4  ]: 3 of 3 START sql table model default_globalx.polygon ........................... [RUN]
[0m03:52:44.368021 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m03:52:44.368531 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m03:52:44.368677 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m03:52:44.368816 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m03:52:44.368968 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m03:52:44.369095 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m03:52:44.372569 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m03:52:44.375166 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m03:52:44.375885 [debug] [Thread-3  ]: finished collecting timing info
[0m03:52:44.376024 [debug] [Thread-4  ]: finished collecting timing info
[0m03:52:44.376134 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m03:52:44.376285 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m03:52:44.382512 [debug] [Thread-3  ]: finished collecting timing info
[0m03:52:44.384101 [debug] [Thread-4  ]: finished collecting timing info
[0m03:52:44.384598 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m03:52:44.384963 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m03:52:44.385193 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f145140-83a6-450c-a2ad-ce4a279903c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d25820>]}
[0m03:52:44.385345 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f145140-83a6-450c-a2ad-ce4a279903c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d25340>]}
[0m03:52:44.385604 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m03:52:44.385804 [error] [Thread-4  ]: 3 of 3 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m03:52:44.386063 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:52:44.386306 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:52:44.387302 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:52:44.387673 [info ] [MainThread]: 
[0m03:52:44.387863 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m03:52:44.388025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:52:44.388117 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:52:44.388204 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m03:52:44.388288 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m03:52:44.393659 [info ] [MainThread]: 
[0m03:52:44.393889 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:52:44.394070 [info ] [MainThread]: 
[0m03:52:44.394296 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m03:52:44.394464 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:52:44.394604 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m03:52:44.394744 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m03:52:44.394877 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m03:52:44.395008 [error] [MainThread]:   
[0m03:52:44.395137 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m03:52:44.395265 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m03:52:44.395400 [info ] [MainThread]: 
[0m03:52:44.395535 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m03:52:44.395671 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:52:44.395799 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m03:52:44.395924 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m03:52:44.396095 [error] [MainThread]:   Found: default_globalx.polygon
[0m03:52:44.396226 [error] [MainThread]:   
[0m03:52:44.396363 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m03:52:44.396492 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m03:52:44.396628 [info ] [MainThread]: 
[0m03:52:44.396752 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m03:52:44.396948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12283f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d05910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225baa30>]}
[0m03:52:44.397106 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:55:08.061434 | 026c1c1e-e9d2-44d5-8206-47372f04b578 ==============================
[0m03:55:08.061452 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:55:08.061922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:55:08.062013 [debug] [MainThread]: Tracking: tracking
[0m03:55:08.072940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d86940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d86a30>]}
[0m03:55:08.106755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:55:08.106902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:55:08.110141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '026c1c1e-e9d2-44d5-8206-47372f04b578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f360d0>]}
[0m03:55:08.113512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '026c1c1e-e9d2-44d5-8206-47372f04b578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e89430>]}
[0m03:55:08.113661 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:55:08.113793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '026c1c1e-e9d2-44d5-8206-47372f04b578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8ca30>]}
[0m03:55:08.114410 [info ] [MainThread]: 
[0m03:55:08.114705 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:55:08.115171 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:55:08.121422 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:55:08.121562 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:55:08.121634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:09.924348 [debug] [ThreadPool]: SQL status: OK -1 in 1.8 seconds
[0m03:55:09.927264 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:55:09.928839 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:55:09.932947 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:55:09.933058 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:55:09.933130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:11.817402 [debug] [ThreadPool]: SQL status: OK -1 in 1.88 seconds
[0m03:55:11.821047 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:55:11.822331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '026c1c1e-e9d2-44d5-8206-47372f04b578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db2c40>]}
[0m03:55:11.823283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:55:11.823686 [info ] [MainThread]: 
[0m03:55:11.826400 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:55:11.826754 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:55:11.827429 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:55:11.829538 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:55:11.829756 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:55:11.837751 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:55:11.837953 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:55:11.838071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:55:13.487445 [debug] [Thread-1  ]: SQL status: OK -1 in 1.65 seconds
[0m03:55:13.491264 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:55:13.492397 [debug] [Thread-1  ]: finished collecting timing info
[0m03:55:13.492654 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:55:13.512183 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m03:55:13.512705 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:55:13.512842 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:55:15.033379 [debug] [Thread-1  ]: SQL status: OK -1 in 1.52 seconds
[0m03:55:15.044714 [debug] [Thread-1  ]: finished collecting timing info
[0m03:55:15.045078 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:55:15.045728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '026c1c1e-e9d2-44d5-8206-47372f04b578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffaf10>]}
[0m03:55:15.046145 [info ] [Thread-1  ]: 1 of 3 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.22s]
[0m03:55:15.046646 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:55:15.047356 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:55:15.047550 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:55:15.047863 [info ] [Thread-3  ]: 2 of 3 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m03:55:15.048093 [info ] [Thread-4  ]: 3 of 3 START sql table model default_globalx.polygon ........................... [RUN]
[0m03:55:15.048687 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m03:55:15.049167 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m03:55:15.049311 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m03:55:15.049439 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m03:55:15.049584 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m03:55:15.049714 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m03:55:15.053085 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m03:55:15.055937 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m03:55:15.056695 [debug] [Thread-3  ]: finished collecting timing info
[0m03:55:15.056829 [debug] [Thread-4  ]: finished collecting timing info
[0m03:55:15.056964 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m03:55:15.057107 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m03:55:15.064575 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m03:55:15.067076 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m03:55:15.067227 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

        DROP TABLE IF EXISTS default_globalx.fred_unemp
      
[0m03:55:15.067346 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

        DROP TABLE IF EXISTS default_globalx.polygon
      
[0m03:55:15.067457 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:55:15.067567 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:56:38.863737 [debug] [Thread-4  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

        DROP TABLE IF EXISTS default_globalx.polygon
      
[0m03:56:38.865981 [debug] [Thread-4  ]: finished collecting timing info
[0m03:56:38.866334 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m03:56:38.867176 [debug] [Thread-4  ]: Runtime Error in model polygon (models/polygon.sql)
  FAILED: ParseException line 1:189 cannot recognize input near '<EOF>' '<EOF>' '<EOF>'
[0m03:56:38.867512 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '026c1c1e-e9d2-44d5-8206-47372f04b578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e21ee0>]}
[0m03:56:38.868177 [error] [Thread-4  ]: 3 of 3 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 83.82s]
[0m03:56:38.868763 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:56:39.906940 [debug] [Thread-3  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

        DROP TABLE IF EXISTS default_globalx.fred_unemp
      
[0m03:56:39.907249 [debug] [Thread-3  ]: finished collecting timing info
[0m03:56:39.907376 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m03:56:39.907732 [debug] [Thread-3  ]: Runtime Error in model fred_unemp (models/fred_unemp.sql)
  FAILED: ParseException line 1:195 cannot recognize input near '<EOF>' '<EOF>' '<EOF>'
[0m03:56:39.907895 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '026c1c1e-e9d2-44d5-8206-47372f04b578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057609a0>]}
[0m03:56:39.908135 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 84.86s]
[0m03:56:39.908405 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:56:39.909345 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:56:39.909694 [info ] [MainThread]: 
[0m03:56:39.909864 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 31.80 seconds (91.80s).
[0m03:56:39.910012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:39.910094 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:56:39.910171 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m03:56:39.910247 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m03:56:39.916823 [info ] [MainThread]: 
[0m03:56:39.917091 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:56:39.917262 [info ] [MainThread]: 
[0m03:56:39.917408 [error] [MainThread]: [33mRuntime Error in model polygon (models/polygon.sql)[0m
[0m03:56:39.917543 [error] [MainThread]:   FAILED: ParseException line 1:189 cannot recognize input near '<EOF>' '<EOF>' '<EOF>'
[0m03:56:39.917667 [info ] [MainThread]: 
[0m03:56:39.917786 [error] [MainThread]: [33mRuntime Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m03:56:39.917910 [error] [MainThread]:   FAILED: ParseException line 1:195 cannot recognize input near '<EOF>' '<EOF>' '<EOF>'
[0m03:56:39.918033 [info ] [MainThread]: 
[0m03:56:39.918156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m03:56:39.918346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d86f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c60c70>]}
[0m03:56:39.918515 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:58:59.605202 | da6f280c-bef8-4d32-851c-c34a7668eb84 ==============================
[0m03:58:59.605223 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:58:59.605555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:58:59.605637 [debug] [MainThread]: Tracking: tracking
[0m03:58:59.615526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a99f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a98670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a98730>]}
[0m03:58:59.650922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:58:59.651167 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m03:58:59.658584 [debug] [MainThread]: 1603: static parser failed on fred_unemp.sql
[0m03:58:59.659956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b96af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4b8b0>]}
[0m03:58:59.660089 [debug] [MainThread]: Flushing usage events
[0m03:58:59.905274 [error] [MainThread]: Encountered an error:
Compilation Error in model fred_unemp (models/fred_unemp.sql)
  expected token ',', got '='
    line 4
      --     materialized='table',


============================== 2024-06-06 03:59:25.074416 | 9d410b9f-7006-489a-b0d1-efcb36eb4cca ==============================
[0m03:59:25.074438 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:59:25.074815 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:59:25.074919 [debug] [MainThread]: Tracking: tracking
[0m03:59:25.082878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0c730>]}
[0m03:59:25.109208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:59:25.109463 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m03:59:25.117510 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m03:59:25.131621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d410b9f-7006-489a-b0d1-efcb36eb4cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f300d0>]}
[0m03:59:25.135018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d410b9f-7006-489a-b0d1-efcb36eb4cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eda160>]}
[0m03:59:25.135160 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:59:25.135303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d410b9f-7006-489a-b0d1-efcb36eb4cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e72040>]}
[0m03:59:25.135925 [info ] [MainThread]: 
[0m03:59:25.136247 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:59:25.136725 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:59:25.143455 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:59:25.143628 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:59:25.143764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:26.956209 [debug] [ThreadPool]: SQL status: OK -1 in 1.81 seconds
[0m03:59:26.959833 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:59:26.962062 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:59:26.971764 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:59:26.971977 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:59:26.972123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:59:28.673844 [debug] [ThreadPool]: SQL status: OK -1 in 1.7 seconds
[0m03:59:28.676507 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:59:28.677458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d410b9f-7006-489a-b0d1-efcb36eb4cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea2fa0>]}
[0m03:59:28.678160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:59:28.678449 [info ] [MainThread]: 
[0m03:59:28.682080 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:59:28.682393 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:59:28.682984 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:59:28.684976 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:59:28.685208 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:59:28.693070 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:59:28.693268 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:59:28.693377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:59:30.623950 [debug] [Thread-1  ]: SQL status: OK -1 in 1.93 seconds
[0m03:59:30.626663 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:59:30.627541 [debug] [Thread-1  ]: finished collecting timing info
[0m03:59:30.627760 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:59:30.639652 [debug] [Thread-1  ]: finished collecting timing info
[0m03:59:30.639899 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:59:30.640288 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:59:30.640522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d410b9f-7006-489a-b0d1-efcb36eb4cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119f84c0>]}
[0m03:59:30.640774 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.96s]
[0m03:59:30.641039 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:59:30.641511 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:59:30.641704 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:59:30.641885 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m03:59:30.642023 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m03:59:30.642281 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m03:59:30.642500 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m03:59:30.643603 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:59:30.644001 [info ] [MainThread]: 
[0m03:59:30.644180 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m03:59:30.644344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:59:30.644424 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m03:59:30.649632 [info ] [MainThread]: 
[0m03:59:30.649812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:59:30.649961 [info ] [MainThread]: 
[0m03:59:30.650084 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m03:59:30.650205 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m03:59:30.650322 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m03:59:30.650437 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m03:59:30.650551 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m03:59:30.650666 [error] [MainThread]:   
[0m03:59:30.650779 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m03:59:30.650892 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m03:59:30.651005 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m03:59:30.651123 [info ] [MainThread]: 
[0m03:59:30.651239 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:59:30.651409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e995fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e995f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd35520>]}
[0m03:59:30.651547 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 03:59:41.224661 | 76e94dfd-f358-4c68-a3de-60f94a59717f ==============================
[0m03:59:41.224678 [info ] [MainThread]: Running with dbt=1.3.0
[0m03:59:41.225046 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:59:41.225164 [debug] [MainThread]: Tracking: tracking
[0m03:59:41.233168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045244f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104524e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104524280>]}
[0m03:59:41.260126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:59:41.260275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:59:41.263476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e94dfd-f358-4c68-a3de-60f94a59717f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b60d0>]}
[0m03:59:41.267881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e94dfd-f358-4c68-a3de-60f94a59717f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458c3a0>]}
[0m03:59:41.268030 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m03:59:41.268166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e94dfd-f358-4c68-a3de-60f94a59717f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10453cd30>]}
[0m03:59:41.268809 [info ] [MainThread]: 
[0m03:59:41.269110 [debug] [MainThread]: Acquiring new athena connection "master"
[0m03:59:41.269621 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m03:59:41.276231 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m03:59:41.276367 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m03:59:41.276441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:43.029311 [debug] [ThreadPool]: SQL status: OK -1 in 1.75 seconds
[0m03:59:43.033916 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m03:59:43.036202 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m03:59:43.046013 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m03:59:43.046221 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m03:59:43.046364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:59:44.669561 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m03:59:44.673144 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m03:59:44.674378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e94dfd-f358-4c68-a3de-60f94a59717f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450ce20>]}
[0m03:59:44.675237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:59:44.675610 [info ] [MainThread]: 
[0m03:59:44.678160 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m03:59:44.678537 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m03:59:44.679232 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:59:44.681403 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m03:59:44.681617 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m03:59:44.689716 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:59:44.689942 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m03:59:44.690060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:59:46.397474 [debug] [Thread-1  ]: SQL status: OK -1 in 1.71 seconds
[0m03:59:46.401279 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m03:59:46.402366 [debug] [Thread-1  ]: finished collecting timing info
[0m03:59:46.402631 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m03:59:46.422325 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m03:59:46.422848 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m03:59:46.422982 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m03:59:47.846655 [debug] [Thread-1  ]: SQL status: OK -1 in 1.42 seconds
[0m03:59:47.859212 [debug] [Thread-1  ]: finished collecting timing info
[0m03:59:47.859586 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m03:59:47.860229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e94dfd-f358-4c68-a3de-60f94a59717f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506cfa0>]}
[0m03:59:47.860660 [info ] [Thread-1  ]: 1 of 3 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.18s]
[0m03:59:47.861168 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m03:59:47.861900 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m03:59:47.862081 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m03:59:47.862356 [info ] [Thread-3  ]: 2 of 3 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m03:59:47.862590 [info ] [Thread-4  ]: 3 of 3 START sql table model default_globalx.polygon ........................... [RUN]
[0m03:59:47.863284 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m03:59:47.863798 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m03:59:47.864039 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m03:59:47.864175 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m03:59:47.864319 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m03:59:47.864442 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m03:59:47.867485 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m03:59:47.870391 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m03:59:47.871119 [debug] [Thread-4  ]: finished collecting timing info
[0m03:59:47.871318 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m03:59:47.871446 [debug] [Thread-3  ]: finished collecting timing info
[0m03:59:47.878766 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m03:59:47.878973 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m03:59:47.879128 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

        DROP TABLE IF EXISTS default_globalx.polygon
      
[0m03:59:47.888780 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m03:59:47.888985 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:59:47.894826 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m03:59:47.895201 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m03:59:47.895334 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:59:50.595562 [debug] [Thread-3  ]: SQL status: OK 48 in 2.7 seconds
[0m03:59:50.600000 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m03:59:50.600281 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m03:59:52.004841 [debug] [Thread-3  ]: SQL status: OK -1 in 1.4 seconds
[0m03:59:52.009497 [debug] [Thread-3  ]: finished collecting timing info
[0m03:59:52.009982 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m03:59:52.010755 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e94dfd-f358-4c68-a3de-60f94a59717f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ad640>]}
[0m03:59:52.011257 [info ] [Thread-3  ]: 2 of 3 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.15s]
[0m03:59:52.011826 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m04:01:17.041217 [debug] [Thread-4  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

        DROP TABLE IF EXISTS default_globalx.polygon
      
[0m04:01:17.042615 [debug] [Thread-4  ]: finished collecting timing info
[0m04:01:17.043033 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m04:01:17.044129 [debug] [Thread-4  ]: Runtime Error in model polygon (models/polygon.sql)
  FAILED: ParseException line 1:189 cannot recognize input near '<EOF>' '<EOF>' '<EOF>'
[0m04:01:17.044587 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e94dfd-f358-4c68-a3de-60f94a59717f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107839ee0>]}
[0m04:01:17.045253 [error] [Thread-4  ]: 3 of 3 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 89.18s]
[0m04:01:17.046074 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m04:01:17.048351 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:01:17.049078 [info ] [MainThread]: 
[0m04:01:17.049367 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 1 minutes and 35.78 seconds (95.78s).
[0m04:01:17.049596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:01:17.049722 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m04:01:17.049835 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m04:01:17.049944 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m04:01:17.062355 [info ] [MainThread]: 
[0m04:01:17.062661 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:01:17.062895 [info ] [MainThread]: 
[0m04:01:17.063079 [error] [MainThread]: [33mRuntime Error in model polygon (models/polygon.sql)[0m
[0m04:01:17.063258 [error] [MainThread]:   FAILED: ParseException line 1:189 cannot recognize input near '<EOF>' '<EOF>' '<EOF>'
[0m04:01:17.063450 [info ] [MainThread]: 
[0m04:01:17.063630 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m04:01:17.063892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10453cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104784910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106463460>]}
[0m04:01:17.064093 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 04:01:50.967054 | 0ba7ba37-ac35-4324-95c1-1ace0aa25e94 ==============================
[0m04:01:50.967072 [info ] [MainThread]: Running with dbt=1.3.0
[0m04:01:50.967410 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:01:50.967505 [debug] [MainThread]: Tracking: tracking
[0m04:01:50.980398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060da940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060daa30>]}
[0m04:01:51.014201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m04:01:51.014438 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/polygon.sql
[0m04:01:51.014557 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m04:01:51.021201 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m04:01:51.027387 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m04:01:51.036386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba7ba37-ac35-4324-95c1-1ace0aa25e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106305940>]}
[0m04:01:51.039889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba7ba37-ac35-4324-95c1-1ace0aa25e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062aa190>]}
[0m04:01:51.040031 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m04:01:51.040162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba7ba37-ac35-4324-95c1-1ace0aa25e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e0a30>]}
[0m04:01:51.040757 [info ] [MainThread]: 
[0m04:01:51.041051 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:01:51.041513 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m04:01:51.047791 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m04:01:51.047946 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m04:01:51.048027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:01:52.717638 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m04:01:52.721184 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m04:01:52.723433 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m04:01:52.733411 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m04:01:52.733640 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m04:01:52.733814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:54.338481 [debug] [ThreadPool]: SQL status: OK -1 in 1.6 seconds
[0m04:01:54.341802 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m04:01:54.343119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba7ba37-ac35-4324-95c1-1ace0aa25e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dff40>]}
[0m04:01:54.343997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:01:54.344388 [info ] [MainThread]: 
[0m04:01:54.347964 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m04:01:54.348358 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m04:01:54.349097 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:01:54.351329 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m04:01:54.351617 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m04:01:54.359955 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:01:54.360184 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m04:01:54.360390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:01:55.968994 [debug] [Thread-1  ]: SQL status: OK -1 in 1.61 seconds
[0m04:01:55.972642 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m04:01:55.975030 [debug] [Thread-1  ]: finished collecting timing info
[0m04:01:55.975285 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m04:01:55.989287 [debug] [Thread-1  ]: finished collecting timing info
[0m04:01:55.989548 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m04:01:55.989999 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m04:01:55.990222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ba7ba37-ac35-4324-95c1-1ace0aa25e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275f5490>]}
[0m04:01:55.990519 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.64s]
[0m04:01:55.990867 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m04:01:55.991466 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m04:01:55.991675 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m04:01:55.991783 [info ] [Thread-3  ]: 2 of 3 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m04:01:55.991939 [info ] [Thread-4  ]: 3 of 3 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m04:01:55.992226 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m04:01:55.992466 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m04:01:55.993633 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:01:55.994099 [info ] [MainThread]: 
[0m04:01:55.994288 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m04:01:55.994457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:01:55.994547 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m04:01:56.001003 [info ] [MainThread]: 
[0m04:01:56.001222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:01:56.001400 [info ] [MainThread]: 
[0m04:01:56.001550 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m04:01:56.001702 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m04:01:56.001846 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m04:01:56.001984 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m04:01:56.002111 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m04:01:56.002234 [error] [MainThread]:   
[0m04:01:56.002400 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m04:01:56.002558 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m04:01:56.002686 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m04:01:56.002824 [info ] [MainThread]: 
[0m04:01:56.002957 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m04:01:56.003155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a16580>]}
[0m04:01:56.003320 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 04:01:58.168931 | 3450f044-1d71-4fd3-896a-8a6b17f1ddfb ==============================
[0m04:01:58.168952 [info ] [MainThread]: Running with dbt=1.3.0
[0m04:01:58.169319 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:01:58.169411 [debug] [MainThread]: Tracking: tracking
[0m04:01:58.177971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c88940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c88a30>]}
[0m04:01:58.204365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:01:58.204517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:01:58.207911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3450f044-1d71-4fd3-896a-8a6b17f1ddfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e360d0>]}
[0m04:01:58.211581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3450f044-1d71-4fd3-896a-8a6b17f1ddfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d85370>]}
[0m04:01:58.211761 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m04:01:58.211903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3450f044-1d71-4fd3-896a-8a6b17f1ddfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8ca30>]}
[0m04:01:58.212643 [info ] [MainThread]: 
[0m04:01:58.212980 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:01:58.213498 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m04:01:58.220335 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m04:01:58.220492 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m04:01:58.220571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:01:59.905233 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m04:01:59.906707 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m04:01:59.907852 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m04:01:59.913979 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m04:01:59.914153 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m04:01:59.914253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:02:02.578589 [debug] [ThreadPool]: SQL status: OK -1 in 2.66 seconds
[0m04:02:02.582008 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m04:02:02.583324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3450f044-1d71-4fd3-896a-8a6b17f1ddfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee0220>]}
[0m04:02:02.584275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:02:02.584688 [info ] [MainThread]: 
[0m04:02:02.587183 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m04:02:02.587552 [info ] [Thread-1  ]: 1 of 3 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m04:02:02.588225 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:02:02.590410 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m04:02:02.590624 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m04:02:02.598739 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:02:02.598972 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m04:02:02.599093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:02:04.205308 [debug] [Thread-1  ]: SQL status: OK -1 in 1.61 seconds
[0m04:02:04.206587 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m04:02:04.207037 [debug] [Thread-1  ]: finished collecting timing info
[0m04:02:04.207157 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m04:02:04.218670 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m04:02:04.219118 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:02:04.219215 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m04:02:05.957821 [debug] [Thread-1  ]: SQL status: OK -1 in 1.74 seconds
[0m04:02:05.967773 [debug] [Thread-1  ]: finished collecting timing info
[0m04:02:05.968177 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m04:02:05.968742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f044-1d71-4fd3-896a-8a6b17f1ddfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed48b0>]}
[0m04:02:05.969113 [info ] [Thread-1  ]: 1 of 3 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.38s]
[0m04:02:05.969529 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m04:02:05.970300 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m04:02:05.970600 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m04:02:05.970854 [info ] [Thread-3  ]: 2 of 3 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m04:02:05.971058 [info ] [Thread-4  ]: 3 of 3 START sql table model default_globalx.polygon ........................... [RUN]
[0m04:02:05.971866 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m04:02:05.972475 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m04:02:05.972659 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m04:02:05.972790 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m04:02:05.972930 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m04:02:05.973046 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m04:02:05.976326 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m04:02:05.979109 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m04:02:05.979710 [debug] [Thread-3  ]: finished collecting timing info
[0m04:02:05.979910 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m04:02:05.980091 [debug] [Thread-4  ]: finished collecting timing info
[0m04:02:05.993388 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m04:02:05.993637 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m04:02:05.995605 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m04:02:05.995934 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m04:02:05.996060 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql


with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m04:02:05.996154 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:02:05.996257 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m04:02:06.001105 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql


with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m04:02:06.001388 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:02:08.688297 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.69 seconds
[0m04:02:08.690931 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m04:02:08.691076 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m04:02:08.703209 [debug] [Thread-3  ]: SQL status: OK 48 in 2.71 seconds
[0m04:02:08.707282 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m04:02:08.707490 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m04:02:10.078526 [debug] [Thread-4  ]: SQL status: OK -1 in 1.39 seconds
[0m04:02:10.079813 [debug] [Thread-4  ]: finished collecting timing info
[0m04:02:10.079997 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m04:02:10.080330 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f044-1d71-4fd3-896a-8a6b17f1ddfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e1790>]}
[0m04:02:10.080545 [info ] [Thread-4  ]: 3 of 3 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.11s]
[0m04:02:10.080788 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m04:02:10.092875 [debug] [Thread-3  ]: SQL status: OK -1 in 1.39 seconds
[0m04:02:10.094098 [debug] [Thread-3  ]: finished collecting timing info
[0m04:02:10.094319 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m04:02:10.094647 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f044-1d71-4fd3-896a-8a6b17f1ddfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1cfa0>]}
[0m04:02:10.094854 [info ] [Thread-3  ]: 2 of 3 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.12s]
[0m04:02:10.095079 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m04:02:10.095858 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:02:10.096177 [info ] [MainThread]: 
[0m04:02:10.096319 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 11.88 seconds (11.88s).
[0m04:02:10.096444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:10.096510 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m04:02:10.096576 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m04:02:10.096637 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m04:02:10.103013 [info ] [MainThread]: 
[0m04:02:10.103219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:02:10.103369 [info ] [MainThread]: 
[0m04:02:10.103485 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:02:10.103654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12541eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ee2ca0>]}
[0m04:02:10.103785 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 04:09:43.360653 | 799db6cc-acfa-429b-941d-d4591f270b78 ==============================
[0m04:09:43.360679 [info ] [MainThread]: Running with dbt=1.3.0
[0m04:09:43.361115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:09:43.361239 [debug] [MainThread]: Tracking: tracking
[0m04:09:43.370508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a4280>]}
[0m04:09:43.406996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m04:09:43.407206 [debug] [MainThread]: Partial parsing: added file: global_x_task://models/extra_metrics.sql
[0m04:09:43.407342 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m04:09:43.407460 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/polygon.sql
[0m04:09:43.414972 [debug] [MainThread]: 1603: static parser failed on extra_metrics.sql
[0m04:09:43.426256 [debug] [MainThread]: 1602: parser fallback to jinja rendering on extra_metrics.sql
[0m04:09:43.427467 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m04:09:43.428749 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m04:09:43.438580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '799db6cc-acfa-429b-941d-d4591f270b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097c520>]}
[0m04:09:43.441856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '799db6cc-acfa-429b-941d-d4591f270b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108f1100>]}
[0m04:09:43.441997 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m04:09:43.442130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '799db6cc-acfa-429b-941d-d4591f270b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106bcd30>]}
[0m04:09:43.442778 [info ] [MainThread]: 
[0m04:09:43.443074 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:09:43.443589 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m04:09:43.447575 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m04:09:43.447671 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m04:09:43.447746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:09:45.395213 [debug] [ThreadPool]: SQL status: OK -1 in 1.95 seconds
[0m04:09:45.400642 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m04:09:45.404033 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m04:09:45.412833 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m04:09:45.412994 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m04:09:45.413130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:09:47.022821 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m04:09:47.025820 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m04:09:47.027108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '799db6cc-acfa-429b-941d-d4591f270b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a1d30>]}
[0m04:09:47.028018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:09:47.028412 [info ] [MainThread]: 
[0m04:09:47.032436 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m04:09:47.032834 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m04:09:47.033590 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:09:47.035769 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m04:09:47.036056 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m04:09:47.099437 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:09:47.099629 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m04:09:47.099705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:09:51.891604 [debug] [Thread-1  ]: SQL status: OK -1 in 4.79 seconds
[0m04:09:51.894473 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m04:09:51.895536 [debug] [Thread-1  ]: finished collecting timing info
[0m04:09:51.895753 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m04:09:51.908566 [debug] [Thread-1  ]: finished collecting timing info
[0m04:09:51.908891 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m04:09:51.909376 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m04:09:51.909609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '799db6cc-acfa-429b-941d-d4591f270b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130f97cd0>]}
[0m04:09:51.909935 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 4.88s]
[0m04:09:51.910308 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m04:09:51.910928 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m04:09:51.911081 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m04:09:51.911273 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m04:09:51.911479 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m04:09:51.911744 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m04:09:51.911971 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m04:09:51.912321 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m04:09:51.912557 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m04:09:51.912886 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m04:09:51.913846 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:09:51.914455 [info ] [MainThread]: 
[0m04:09:51.914906 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m04:09:51.915109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:09:51.915209 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m04:09:51.921167 [info ] [MainThread]: 
[0m04:09:51.921369 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:09:51.921545 [info ] [MainThread]: 
[0m04:09:51.921695 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m04:09:51.921846 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m04:09:51.921989 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m04:09:51.922132 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m04:09:51.922272 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m04:09:51.922413 [error] [MainThread]:   
[0m04:09:51.922553 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m04:09:51.922691 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m04:09:51.922829 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m04:09:51.922972 [info ] [MainThread]: 
[0m04:09:51.923100 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m04:09:51.923283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11741f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11741af10>]}
[0m04:09:51.923480 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 04:10:01.842285 | ecb4a382-d8c5-4007-82fd-f428e8d7ef7d ==============================
[0m04:10:01.842307 [info ] [MainThread]: Running with dbt=1.3.0
[0m04:10:01.842945 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:10:01.843151 [debug] [MainThread]: Tracking: tracking
[0m04:10:01.853972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dab940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dabdc0>]}
[0m04:10:01.887075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:10:01.887224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:10:01.890711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb4a382-d8c5-4007-82fd-f428e8d7ef7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060790d0>]}
[0m04:10:01.893983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb4a382-d8c5-4007-82fd-f428e8d7ef7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0730>]}
[0m04:10:01.894125 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m04:10:01.894257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb4a382-d8c5-4007-82fd-f428e8d7ef7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436e3a0>]}
[0m04:10:01.894933 [info ] [MainThread]: 
[0m04:10:01.895236 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:10:01.895738 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m04:10:01.902326 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m04:10:01.902477 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m04:10:01.902559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:10:03.596730 [debug] [ThreadPool]: SQL status: OK -1 in 1.69 seconds
[0m04:10:03.601176 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m04:10:03.603497 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m04:10:03.613542 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m04:10:03.613768 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m04:10:03.613922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:05.310248 [debug] [ThreadPool]: SQL status: OK -1 in 1.7 seconds
[0m04:10:05.311543 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m04:10:05.312098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb4a382-d8c5-4007-82fd-f428e8d7ef7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106124340>]}
[0m04:10:05.312539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:10:05.312715 [info ] [MainThread]: 
[0m04:10:05.314742 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m04:10:05.314925 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m04:10:05.315324 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:10:05.316411 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m04:10:05.316517 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m04:10:05.321078 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:10:05.321239 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m04:10:05.321318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:10:06.959669 [debug] [Thread-1  ]: SQL status: OK -1 in 1.64 seconds
[0m04:10:06.961016 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m04:10:06.962676 [debug] [Thread-1  ]: finished collecting timing info
[0m04:10:06.962886 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m04:10:06.975903 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m04:10:06.976445 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:10:06.976545 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m04:10:08.395055 [debug] [Thread-1  ]: SQL status: OK -1 in 1.42 seconds
[0m04:10:08.403167 [debug] [Thread-1  ]: finished collecting timing info
[0m04:10:08.403510 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m04:10:08.403986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb4a382-d8c5-4007-82fd-f428e8d7ef7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106125fa0>]}
[0m04:10:08.404319 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.09s]
[0m04:10:08.404660 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m04:10:08.405130 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m04:10:08.405304 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m04:10:08.405439 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m04:10:08.405606 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m04:10:08.406578 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m04:10:08.407258 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m04:10:08.407419 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m04:10:08.407531 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m04:10:08.407648 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m04:10:08.407750 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m04:10:08.410440 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m04:10:08.413319 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m04:10:08.414141 [debug] [Thread-3  ]: finished collecting timing info
[0m04:10:08.414418 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m04:10:08.414659 [debug] [Thread-4  ]: finished collecting timing info
[0m04:10:08.421862 [debug] [Thread-3  ]: finished collecting timing info
[0m04:10:08.422167 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m04:10:08.422807 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m04:10:08.424517 [debug] [Thread-4  ]: finished collecting timing info
[0m04:10:08.424733 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb4a382-d8c5-4007-82fd-f428e8d7ef7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11081ecd0>]}
[0m04:10:08.425091 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m04:10:08.425484 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m04:10:08.425767 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb4a382-d8c5-4007-82fd-f428e8d7ef7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11081ebe0>]}
[0m04:10:08.426089 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m04:10:08.426316 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m04:10:08.426750 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m04:10:08.427179 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m04:10:08.427313 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m04:10:08.427555 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m04:10:08.428443 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:10:08.428865 [info ] [MainThread]: 
[0m04:10:08.429056 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m04:10:08.429218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:10:08.429309 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m04:10:08.429396 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m04:10:08.429479 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m04:10:08.435374 [info ] [MainThread]: 
[0m04:10:08.435614 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:10:08.435793 [info ] [MainThread]: 
[0m04:10:08.435938 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m04:10:08.436079 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m04:10:08.436211 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m04:10:08.436362 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m04:10:08.436491 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m04:10:08.436619 [error] [MainThread]:   
[0m04:10:08.436745 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m04:10:08.436870 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m04:10:08.436999 [info ] [MainThread]: 
[0m04:10:08.437128 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m04:10:08.437257 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m04:10:08.437383 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m04:10:08.437509 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m04:10:08.437635 [error] [MainThread]:   Found: default_globalx.polygon
[0m04:10:08.437761 [error] [MainThread]:   
[0m04:10:08.437885 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m04:10:08.438011 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m04:10:08.438321 [info ] [MainThread]: 
[0m04:10:08.438503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m04:10:08.438728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106043160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106831be0>]}
[0m04:10:08.438902 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 04:11:03.894411 | b1614007-3af5-443b-ac3a-31ed77c0a259 ==============================
[0m04:11:03.894432 [info ] [MainThread]: Running with dbt=1.3.0
[0m04:11:03.894916 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'profile': 'global_x_task', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:11:03.895016 [debug] [MainThread]: Tracking: tracking
[0m04:11:03.906546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a564c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a564700>]}
[0m04:11:03.944803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:11:03.944957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:11:03.948490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6f90d0>]}
[0m04:11:03.951816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a644760>]}
[0m04:11:03.951954 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m04:11:03.952086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a57cd30>]}
[0m04:11:03.952772 [info ] [MainThread]: 
[0m04:11:03.953073 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:11:03.953563 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m04:11:03.959953 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m04:11:03.960117 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m04:11:03.960201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:05.773693 [debug] [ThreadPool]: SQL status: OK -1 in 1.81 seconds
[0m04:11:05.777159 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m04:11:05.779088 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m04:11:05.787471 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m04:11:05.787653 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m04:11:05.787783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:11:07.452577 [debug] [ThreadPool]: SQL status: OK -1 in 1.66 seconds
[0m04:11:07.456465 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m04:11:07.457766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8a42e0>]}
[0m04:11:07.458692 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:11:07.459090 [info ] [MainThread]: 
[0m04:11:07.462740 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m04:11:07.463129 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m04:11:07.463822 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:11:07.465964 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m04:11:07.466203 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m04:11:07.474187 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:11:07.474394 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m04:11:07.474562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:11:09.093805 [debug] [Thread-1  ]: SQL status: OK -1 in 1.62 seconds
[0m04:11:09.097688 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m04:11:09.098791 [debug] [Thread-1  ]: finished collecting timing info
[0m04:11:09.099052 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m04:11:09.118493 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m04:11:09.119007 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m04:11:09.119141 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m04:11:10.567172 [debug] [Thread-1  ]: SQL status: OK -1 in 1.45 seconds
[0m04:11:10.579005 [debug] [Thread-1  ]: finished collecting timing info
[0m04:11:10.579379 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m04:11:10.580059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8af220>]}
[0m04:11:10.580517 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.12s]
[0m04:11:10.581020 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m04:11:10.581789 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m04:11:10.582001 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m04:11:10.582196 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m04:11:10.582402 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m04:11:10.582978 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m04:11:10.583478 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m04:11:10.583637 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m04:11:10.583814 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m04:11:10.584000 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m04:11:10.584143 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m04:11:10.587561 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m04:11:10.590639 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m04:11:10.591542 [debug] [Thread-3  ]: finished collecting timing info
[0m04:11:10.591689 [debug] [Thread-4  ]: finished collecting timing info
[0m04:11:10.591824 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m04:11:10.591968 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m04:11:10.612490 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m04:11:10.613645 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m04:11:10.614102 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m04:11:10.614211 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m04:11:10.614291 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql

with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m04:11:10.614383 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql

with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m04:11:10.614484 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:11:10.614572 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:11:13.312952 [debug] [Thread-3  ]: SQL status: OK 48 in 2.7 seconds
[0m04:11:13.315526 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m04:11:13.315657 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m04:11:13.433425 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.82 seconds
[0m04:11:13.435190 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m04:11:13.435400 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m04:11:14.826478 [debug] [Thread-3  ]: SQL status: OK -1 in 1.51 seconds
[0m04:11:14.829538 [debug] [Thread-3  ]: finished collecting timing info
[0m04:11:14.829955 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m04:11:14.830741 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6d9760>]}
[0m04:11:14.831242 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.25s]
[0m04:11:14.831807 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m04:11:14.864233 [debug] [Thread-4  ]: SQL status: OK -1 in 1.43 seconds
[0m04:11:14.866105 [debug] [Thread-4  ]: finished collecting timing info
[0m04:11:14.866380 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m04:11:14.866856 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d656af0>]}
[0m04:11:14.867159 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.28s]
[0m04:11:14.867492 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m04:11:14.867921 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m04:11:14.868203 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m04:11:14.868683 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m04:11:14.870220 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m04:11:14.870358 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m04:11:14.874232 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m04:11:14.874519 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m04:11:14.874682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:11:16.518678 [debug] [Thread-1  ]: SQL status: OK -1 in 1.64 seconds
[0m04:11:16.523511 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m04:11:16.524630 [debug] [Thread-1  ]: finished collecting timing info
[0m04:11:16.524915 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m04:11:16.528945 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m04:11:16.529610 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m04:11:16.529780 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        p.daily_return,
        p.moving_avg_50,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    date,
    symbol,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    number_of_trades,
    daily_return,
    moving_avg_50,
    unemployment_rate,
    -- Additional metrics calculations
    (close_price - opening_price) as price_change,
    (highest_price - lowest_price) / lowest_price * 100 as intraday_volatility,
    (daily_return * unemployment_rate) as weighted_return
from
    joined_data

[0m04:11:17.966549 [debug] [Thread-1  ]: SQL status: OK -1 in 1.44 seconds
[0m04:11:17.971379 [debug] [Thread-1  ]: finished collecting timing info
[0m04:11:17.971786 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m04:11:17.972594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1614007-3af5-443b-ac3a-31ed77c0a259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd42640>]}
[0m04:11:17.973108 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 3.10s]
[0m04:11:17.973683 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m04:11:17.975511 [debug] [MainThread]: Acquiring new athena connection "master"
[0m04:11:17.976275 [info ] [MainThread]: 
[0m04:11:17.976570 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 14.02 seconds (14.02s).
[0m04:11:17.976836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:11:17.976983 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m04:11:17.977127 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m04:11:17.977262 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m04:11:17.990596 [info ] [MainThread]: 
[0m04:11:17.991219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:11:17.991496 [info ] [MainThread]: 
[0m04:11:17.991689 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:11:17.992094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a026250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e886df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0bd160>]}
[0m04:11:17.992346 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 13:50:12.957242 | b0bc5a93-3cba-4722-8e39-47e7d3a3967f ==============================
[0m13:50:12.957259 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:50:12.957873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:50:12.957968 [debug] [MainThread]: Tracking: tracking
[0m13:50:12.976837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea8250>]}
[0m13:50:12.994840 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:50:12.995062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0bc5a93-3cba-4722-8e39-47e7d3a3967f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6a7f0>]}
[0m13:50:13.012717 [debug] [MainThread]: Parsing macros/drop_view.sql
[0m13:50:13.013287 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:50:13.014512 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m13:50:13.015074 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m13:50:13.018937 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:50:13.023554 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:50:13.024855 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:50:13.026774 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:50:13.027246 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:50:13.028881 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:50:13.029119 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:50:13.030860 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:50:13.031382 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:50:13.031559 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:50:13.035187 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:50:13.035874 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:50:13.037545 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:50:13.038605 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:50:13.039338 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:50:13.046568 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:50:13.052759 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:50:13.058375 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:50:13.060351 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:50:13.061173 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:50:13.061950 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:50:13.065512 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:50:13.072872 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:50:13.073543 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:50:13.076743 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:50:13.081518 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:50:13.089656 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:50:13.092272 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:50:13.093863 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:50:13.096369 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:50:13.096974 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:50:13.098469 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:50:13.099542 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:50:13.102769 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:50:13.111704 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:50:13.112469 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:50:13.113576 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:50:13.114263 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:50:13.114666 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:50:13.115024 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:50:13.115332 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:50:13.115939 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:50:13.118535 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:50:13.122465 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:50:13.122851 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:50:13.123416 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:50:13.123915 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:50:13.124475 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:50:13.125068 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:50:13.125426 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:50:13.125886 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:50:13.126646 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:50:13.127772 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:50:13.128419 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:50:13.128922 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:50:13.129398 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:50:13.129871 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:50:13.130322 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:50:13.130847 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:50:13.131260 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:50:13.134372 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:50:13.134874 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:50:13.135291 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:50:13.136105 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:50:13.137097 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:50:13.137574 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:50:13.138287 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:50:13.138755 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:50:13.139698 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:50:13.141238 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:50:13.142543 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:50:13.149419 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:50:13.150327 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:50:13.156437 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:50:13.158577 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:50:13.161964 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:50:13.166653 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:50:13.169524 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:50:13.279185 [debug] [MainThread]: 1699: static parser successfully parsed fred_unemp.sql
[0m13:50:13.284937 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m13:50:13.291224 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m13:50:13.291845 [debug] [MainThread]: 1603: static parser failed on extra_metrics.sql
[0m13:50:13.294165 [debug] [MainThread]: 1602: parser fallback to jinja rendering on extra_metrics.sql
[0m13:50:13.294830 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m13:50:13.323364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0bc5a93-3cba-4722-8e39-47e7d3a3967f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802aa00>]}
[0m13:50:13.327446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0bc5a93-3cba-4722-8e39-47e7d3a3967f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e91130>]}
[0m13:50:13.327597 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:50:13.327737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0bc5a93-3cba-4722-8e39-47e7d3a3967f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108080a90>]}
[0m13:50:13.328387 [info ] [MainThread]: 
[0m13:50:13.328684 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:50:13.329169 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m13:50:13.332927 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m13:50:13.333028 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m13:50:13.333103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:15.162310 [debug] [ThreadPool]: SQL status: OK -1 in 1.83 seconds
[0m13:50:15.166372 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:50:15.168615 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m13:50:15.178764 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m13:50:15.178976 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m13:50:15.179217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:16.889767 [debug] [ThreadPool]: SQL status: OK -1 in 1.71 seconds
[0m13:50:16.893970 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m13:50:16.895209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0bc5a93-3cba-4722-8e39-47e7d3a3967f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c6310>]}
[0m13:50:16.896085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:16.896422 [info ] [MainThread]: 
[0m13:50:16.900378 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m13:50:16.900745 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m13:50:16.901453 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:50:16.903710 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m13:50:16.903962 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m13:50:16.908570 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:50:16.908823 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m13:50:16.908954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:18.551586 [debug] [Thread-1  ]: SQL status: OK -1 in 1.64 seconds
[0m13:50:18.556478 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m13:50:18.559006 [debug] [Thread-1  ]: finished collecting timing info
[0m13:50:18.559276 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m13:50:18.578149 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m13:50:18.578740 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:50:18.578875 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m13:51:40.181911 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    daily_return,
    moving_avg_50,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m13:51:40.184281 [debug] [Thread-1  ]: finished collecting timing info
[0m13:51:40.184781 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m13:51:40.185695 [debug] [Thread-1  ]: Runtime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  line 19:5: Column 'daily_return' cannot be resolved
[0m13:51:40.186058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0bc5a93-3cba-4722-8e39-47e7d3a3967f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f274760>]}
[0m13:51:40.186616 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 83.28s]
[0m13:51:40.187188 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m13:51:40.188209 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m13:51:40.188443 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m13:51:40.188602 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m13:51:40.188812 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m13:51:40.189210 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m13:51:40.190844 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m13:51:40.191434 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m13:51:40.191637 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m13:51:40.191923 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m13:51:40.193450 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:51:40.194100 [info ] [MainThread]: 
[0m13:51:40.194387 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 1 minutes and 26.87 seconds (86.87s).
[0m13:51:40.194615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:40.194744 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m13:51:40.201669 [info ] [MainThread]: 
[0m13:51:40.201946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:51:40.202161 [info ] [MainThread]: 
[0m13:51:40.202341 [error] [MainThread]: [33mRuntime Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m13:51:40.202513 [error] [MainThread]:   line 19:5: Column 'daily_return' cannot be resolved
[0m13:51:40.202690 [info ] [MainThread]: 
[0m13:51:40.202860 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m13:51:40.203111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108008f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7e09d0>]}
[0m13:51:40.203309 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 13:52:23.657875 | eb906b29-455b-41a4-91d3-0ba9c7cd9035 ==============================
[0m13:52:23.657894 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:52:23.658387 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:52:23.658485 [debug] [MainThread]: Tracking: tracking
[0m13:52:23.668912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2490>]}
[0m13:52:23.706650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:23.706902 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/etl_integrated_etf_data.sql
[0m13:52:23.714396 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m13:52:23.725415 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m13:52:23.734273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb906b29-455b-41a4-91d3-0ba9c7cd9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107865f70>]}
[0m13:52:23.737690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb906b29-455b-41a4-91d3-0ba9c7cd9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844c70>]}
[0m13:52:23.737849 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:52:23.737980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb906b29-455b-41a4-91d3-0ba9c7cd9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0caf0>]}
[0m13:52:23.738616 [info ] [MainThread]: 
[0m13:52:23.738911 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:52:23.739401 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m13:52:23.743011 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m13:52:23.743114 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m13:52:23.743184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:25.448516 [debug] [ThreadPool]: SQL status: OK -1 in 1.71 seconds
[0m13:52:25.452600 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:52:25.454523 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m13:52:25.463447 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m13:52:25.463638 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m13:52:25.463767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:27.194854 [debug] [ThreadPool]: SQL status: OK -1 in 1.73 seconds
[0m13:52:27.197647 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m13:52:27.198842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb906b29-455b-41a4-91d3-0ba9c7cd9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eb250>]}
[0m13:52:27.199792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:27.200167 [info ] [MainThread]: 
[0m13:52:27.203778 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m13:52:27.204161 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m13:52:27.204880 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:52:27.206972 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m13:52:27.207207 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m13:52:27.259593 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:52:27.259773 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m13:52:27.259846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:28.848089 [debug] [Thread-1  ]: SQL status: OK -1 in 1.59 seconds
[0m13:52:28.850847 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m13:52:28.851890 [debug] [Thread-1  ]: finished collecting timing info
[0m13:52:28.852239 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m13:52:28.871235 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m13:52:28.871776 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:52:28.871908 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m13:52:30.377959 [debug] [Thread-1  ]: SQL status: OK -1 in 1.51 seconds
[0m13:52:30.389284 [debug] [Thread-1  ]: finished collecting timing info
[0m13:52:30.389678 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m13:52:30.390346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb906b29-455b-41a4-91d3-0ba9c7cd9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789cdf0>]}
[0m13:52:30.390817 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.19s]
[0m13:52:30.391327 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m13:52:30.392053 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m13:52:30.392244 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m13:52:30.392553 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m13:52:30.392753 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m13:52:30.393303 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m13:52:30.393798 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m13:52:30.393952 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m13:52:30.394086 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m13:52:30.394232 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m13:52:30.394357 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m13:52:30.397491 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m13:52:30.400198 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m13:52:30.402000 [debug] [Thread-4  ]: finished collecting timing info
[0m13:52:30.402146 [debug] [Thread-3  ]: finished collecting timing info
[0m13:52:30.402271 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m13:52:30.402410 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m13:52:30.417680 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m13:52:30.419380 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m13:52:30.420024 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m13:52:30.420144 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m13:52:30.420253 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql

with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m13:52:30.420349 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql

with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m13:52:30.420438 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:52:30.420526 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:52:33.130982 [debug] [Thread-3  ]: SQL status: OK 48 in 2.71 seconds
[0m13:52:33.135891 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m13:52:33.136149 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m13:52:34.601955 [debug] [Thread-3  ]: SQL status: OK -1 in 1.47 seconds
[0m13:52:34.605809 [debug] [Thread-3  ]: finished collecting timing info
[0m13:52:34.606242 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m13:52:34.606919 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb906b29-455b-41a4-91d3-0ba9c7cd9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ea8e0>]}
[0m13:52:34.607370 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.21s]
[0m13:52:34.607878 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m13:53:52.173033 [debug] [Thread-4  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql

with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m13:53:52.175493 [debug] [Thread-4  ]: finished collecting timing info
[0m13:53:52.175788 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m13:53:52.176625 [debug] [Thread-4  ]: Runtime Error in model polygon (models/polygon.sql)
  COLUMN_NOT_FOUND: line 18:6: Column 'daily_return' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://global-x-task/athena-results/tables/cf3ac026-21e0-484c-b91c-5f56126bbc53' before retrying. Athena will not delete data in your account.
[0m13:53:52.176976 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb906b29-455b-41a4-91d3-0ba9c7cd9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b55910>]}
[0m13:53:52.177517 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 81.78s]
[0m13:53:52.178014 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m13:53:52.178765 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m13:53:52.179041 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m13:53:52.179534 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m13:53:52.180858 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:53:52.181445 [info ] [MainThread]: 
[0m13:53:52.181723 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 1 minutes and 28.44 seconds (88.44s).
[0m13:53:52.181975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:52.182117 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m13:53:52.182246 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m13:53:52.182372 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m13:53:52.194719 [info ] [MainThread]: 
[0m13:53:52.195110 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:53:52.195348 [info ] [MainThread]: 
[0m13:53:52.195542 [error] [MainThread]: [33mRuntime Error in model polygon (models/polygon.sql)[0m
[0m13:53:52.195732 [error] [MainThread]:   COLUMN_NOT_FOUND: line 18:6: Column 'daily_return' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://global-x-task/athena-results/tables/cf3ac026-21e0-484c-b91c-5f56126bbc53' before retrying. Athena will not delete data in your account.
[0m13:53:52.195920 [info ] [MainThread]: 
[0m13:53:52.196091 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:53:52.196387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e4c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112766eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e0ee80>]}
[0m13:53:52.196626 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 13:56:45.175612 | b0a258d4-7de7-4cdf-913b-cea544c2ffb2 ==============================
[0m13:56:45.175629 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:56:45.175984 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:56:45.176128 [debug] [MainThread]: Tracking: tracking
[0m13:56:45.184473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104992160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104992040>]}
[0m13:56:45.218524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:56:45.218777 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/polygon.sql
[0m13:56:45.226188 [debug] [MainThread]: 1699: static parser successfully parsed polygon.sql
[0m13:56:45.240324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0a258d4-7de7-4cdf-913b-cea544c2ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba8f70>]}
[0m13:56:45.243830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0a258d4-7de7-4cdf-913b-cea544c2ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5d220>]}
[0m13:56:45.243972 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:56:45.244107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a258d4-7de7-4cdf-913b-cea544c2ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af2460>]}
[0m13:56:45.244714 [info ] [MainThread]: 
[0m13:56:45.245004 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:56:45.245476 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m13:56:45.251671 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m13:56:45.251822 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m13:56:45.251898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:47.182197 [debug] [ThreadPool]: SQL status: OK -1 in 1.93 seconds
[0m13:56:47.186601 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:56:47.188981 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m13:56:47.199277 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m13:56:47.199490 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m13:56:47.199642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:48.877864 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m13:56:48.881518 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m13:56:48.882906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a258d4-7de7-4cdf-913b-cea544c2ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8cf40>]}
[0m13:56:48.883821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:48.884214 [info ] [MainThread]: 
[0m13:56:48.887765 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m13:56:48.888091 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m13:56:48.888749 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:56:48.890904 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m13:56:48.891135 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m13:56:48.900388 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:56:48.900628 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m13:56:48.900752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:50.567204 [debug] [Thread-1  ]: SQL status: OK -1 in 1.67 seconds
[0m13:56:50.571235 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m13:56:50.572268 [debug] [Thread-1  ]: finished collecting timing info
[0m13:56:50.572564 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m13:56:50.579727 [debug] [Thread-1  ]: finished collecting timing info
[0m13:56:50.579884 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m13:56:50.580123 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m13:56:50.580246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a258d4-7de7-4cdf-913b-cea544c2ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a427cd0>]}
[0m13:56:50.580406 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.69s]
[0m13:56:50.580591 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m13:56:50.580901 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m13:56:50.581016 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m13:56:50.581111 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m13:56:50.581222 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m13:56:50.581396 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m13:56:50.581547 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m13:56:50.581765 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m13:56:50.581871 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m13:56:50.582046 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m13:56:50.582745 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:56:50.582994 [info ] [MainThread]: 
[0m13:56:50.583111 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m13:56:50.583221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:50.583294 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m13:56:50.587741 [info ] [MainThread]: 
[0m13:56:50.587911 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:50.588033 [info ] [MainThread]: 
[0m13:56:50.588137 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m13:56:50.588402 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m13:56:50.588684 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m13:56:50.588887 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m13:56:50.589080 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m13:56:50.589266 [error] [MainThread]:   
[0m13:56:50.589450 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m13:56:50.589636 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m13:56:50.589818 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m13:56:50.590018 [info ] [MainThread]: 
[0m13:56:50.590217 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m13:56:50.590483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c50c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9cfb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9cfe80>]}
[0m13:56:50.590694 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 13:56:55.467215 | 40e9216c-cffb-44c5-9597-12ba104afc6c ==============================
[0m13:56:55.467236 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:56:55.467611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:56:55.467696 [debug] [MainThread]: Tracking: tracking
[0m13:56:55.475877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076247f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076066d0>]}
[0m13:56:55.502809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:55.502960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:55.506215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40e9216c-cffb-44c5-9597-12ba104afc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b90d0>]}
[0m13:56:55.510864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40e9216c-cffb-44c5-9597-12ba104afc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110002790>]}
[0m13:56:55.511039 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:56:55.511177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e9216c-cffb-44c5-9597-12ba104afc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110002820>]}
[0m13:56:55.511844 [info ] [MainThread]: 
[0m13:56:55.512144 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:56:55.512634 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m13:56:55.518995 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m13:56:55.519123 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m13:56:55.519199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:57.295956 [debug] [ThreadPool]: SQL status: OK -1 in 1.78 seconds
[0m13:56:57.301253 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:56:57.303514 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m13:56:57.313381 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m13:56:57.313596 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m13:56:57.313742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:58.989438 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m13:56:58.990461 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m13:56:58.990909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e9216c-cffb-44c5-9597-12ba104afc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110164250>]}
[0m13:56:58.991246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:58.991398 [info ] [MainThread]: 
[0m13:56:58.992333 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m13:56:58.992508 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m13:56:58.992842 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:56:58.993839 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m13:56:58.993935 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m13:56:58.998002 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:56:58.998134 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m13:56:58.998259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:00.633676 [debug] [Thread-1  ]: SQL status: OK -1 in 1.64 seconds
[0m13:57:00.639286 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m13:57:00.640339 [debug] [Thread-1  ]: finished collecting timing info
[0m13:57:00.640616 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m13:57:00.660805 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m13:57:00.661533 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:57:00.661673 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m13:57:02.168846 [debug] [Thread-1  ]: SQL status: OK -1 in 1.51 seconds
[0m13:57:02.180366 [debug] [Thread-1  ]: finished collecting timing info
[0m13:57:02.180739 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m13:57:02.181387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e9216c-cffb-44c5-9597-12ba104afc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aed580>]}
[0m13:57:02.181821 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.19s]
[0m13:57:02.182321 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m13:57:02.183117 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m13:57:02.183297 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m13:57:02.183589 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m13:57:02.183805 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m13:57:02.184348 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m13:57:02.184846 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m13:57:02.184989 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m13:57:02.185117 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m13:57:02.185263 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m13:57:02.185386 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m13:57:02.188466 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m13:57:02.191018 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m13:57:02.191805 [debug] [Thread-3  ]: finished collecting timing info
[0m13:57:02.191921 [debug] [Thread-4  ]: finished collecting timing info
[0m13:57:02.192125 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m13:57:02.192275 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m13:57:02.198926 [debug] [Thread-3  ]: finished collecting timing info
[0m13:57:02.208698 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m13:57:02.209151 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m13:57:02.209489 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e9216c-cffb-44c5-9597-12ba104afc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110510970>]}
[0m13:57:02.209781 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.03s]
[0m13:57:02.210062 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m13:57:02.210197 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m13:57:02.210409 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql

with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m13:57:02.210509 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:57:03.832292 [debug] [Thread-4  ]: SQL status: OK 1506 in 1.62 seconds
[0m13:57:03.838979 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m13:57:03.839422 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m13:57:05.376039 [debug] [Thread-4  ]: SQL status: OK -1 in 1.54 seconds
[0m13:57:05.381559 [debug] [Thread-4  ]: finished collecting timing info
[0m13:57:05.382055 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m13:57:05.382841 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e9216c-cffb-44c5-9597-12ba104afc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112642c10>]}
[0m13:57:05.383343 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.20s]
[0m13:57:05.383915 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m13:57:05.384698 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m13:57:05.385040 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m13:57:05.385567 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m13:57:05.387052 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:57:05.387661 [info ] [MainThread]: 
[0m13:57:05.387944 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 9.88 seconds (9.88s).
[0m13:57:05.388201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:05.388339 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m13:57:05.388473 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m13:57:05.388600 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m13:57:05.399095 [info ] [MainThread]: 
[0m13:57:05.399354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:05.399563 [info ] [MainThread]: 
[0m13:57:05.399737 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m13:57:05.399938 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m13:57:05.400105 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m13:57:05.400264 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m13:57:05.400420 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m13:57:05.400581 [error] [MainThread]:   
[0m13:57:05.400739 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m13:57:05.400901 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m13:57:05.401069 [info ] [MainThread]: 
[0m13:57:05.401233 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:57:05.401462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110171190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110515670>]}
[0m13:57:05.401646 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 13:58:23.866348 | 00028496-bfdb-4648-8a1e-748a35aafd67 ==============================
[0m13:58:23.866370 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:58:23.867223 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:58:23.867324 [debug] [MainThread]: Tracking: tracking
[0m13:58:23.879560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b48e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b48a00>]}
[0m13:58:23.917706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:23.917862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:23.921412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdd0d0>]}
[0m13:58:23.924989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c26820>]}
[0m13:58:23.925146 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:58:23.925291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c268b0>]}
[0m13:58:23.926007 [info ] [MainThread]: 
[0m13:58:23.926308 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:58:23.926825 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m13:58:23.933310 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m13:58:23.933447 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m13:58:23.933574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:25.662781 [debug] [ThreadPool]: SQL status: OK -1 in 1.73 seconds
[0m13:58:25.666880 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:58:25.669262 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m13:58:25.679449 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m13:58:25.679731 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m13:58:25.679896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:27.539666 [debug] [ThreadPool]: SQL status: OK -1 in 1.86 seconds
[0m13:58:27.543859 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m13:58:27.545271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8a2b0>]}
[0m13:58:27.546148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:58:27.546529 [info ] [MainThread]: 
[0m13:58:27.549628 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m13:58:27.550039 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m13:58:27.550780 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:58:27.553195 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m13:58:27.553488 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m13:58:27.561901 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:58:27.562137 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m13:58:27.562263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:58:29.143029 [debug] [Thread-1  ]: SQL status: OK -1 in 1.58 seconds
[0m13:58:29.147151 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m13:58:29.148182 [debug] [Thread-1  ]: finished collecting timing info
[0m13:58:29.148445 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m13:58:29.168579 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m13:58:29.169167 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m13:58:29.169308 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m13:58:30.599777 [debug] [Thread-1  ]: SQL status: OK -1 in 1.43 seconds
[0m13:58:30.609377 [debug] [Thread-1  ]: finished collecting timing info
[0m13:58:30.609680 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m13:58:30.610266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d89e20>]}
[0m13:58:30.610659 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.06s]
[0m13:58:30.611086 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m13:58:30.611716 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m13:58:30.611932 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m13:58:30.612075 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m13:58:30.612705 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m13:58:30.612935 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m13:58:30.613082 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m13:58:30.613530 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m13:58:30.613674 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m13:58:30.613792 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m13:58:30.616573 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m13:58:30.616783 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m13:58:30.619441 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m13:58:30.619835 [debug] [Thread-3  ]: finished collecting timing info
[0m13:58:30.620042 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m13:58:30.620159 [debug] [Thread-4  ]: finished collecting timing info
[0m13:58:30.633563 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m13:58:30.633761 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m13:58:30.635532 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m13:58:30.635813 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m13:58:30.635933 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql

with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m13:58:30.636019 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:58:30.640837 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m13:58:30.641112 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql

with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m13:58:30.641689 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:58:33.372327 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.73 seconds
[0m13:58:33.375734 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m13:58:33.375965 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m13:58:33.421435 [debug] [Thread-3  ]: SQL status: OK 48 in 2.79 seconds
[0m13:58:33.422967 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m13:58:33.423169 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m13:58:34.798873 [debug] [Thread-4  ]: SQL status: OK -1 in 1.42 seconds
[0m13:58:34.802225 [debug] [Thread-4  ]: finished collecting timing info
[0m13:58:34.802570 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m13:58:34.803295 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de3c40>]}
[0m13:58:34.803760 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.19s]
[0m13:58:34.804325 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m13:58:34.835809 [debug] [Thread-3  ]: SQL status: OK -1 in 1.41 seconds
[0m13:58:34.838159 [debug] [Thread-3  ]: finished collecting timing info
[0m13:58:34.838470 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m13:58:34.839021 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4197f0>]}
[0m13:58:34.839366 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.23s]
[0m13:58:34.839734 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m13:58:34.840230 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m13:58:34.840529 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m13:58:34.841153 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m13:58:34.842654 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m13:58:34.842797 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m13:58:34.847145 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m13:58:34.847427 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m13:58:34.847542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:58:36.416413 [debug] [Thread-1  ]: SQL status: OK -1 in 1.57 seconds
[0m13:58:36.419728 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m13:58:36.420764 [debug] [Thread-1  ]: finished collecting timing info
[0m13:58:36.420935 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m13:58:36.423317 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m13:58:36.423677 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m13:58:36.423788 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        p.daily_return,
        p.moving_avg_50,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    jd.unemployment_rate,
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m13:59:58.445553 [debug] [Thread-1  ]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol,
        daily_return,
        moving_avg_50
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        p.daily_return,
        p.moving_avg_50,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    jd.unemployment_rate,
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m13:59:58.446722 [debug] [Thread-1  ]: finished collecting timing info
[0m13:59:58.446970 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m13:59:58.447514 [debug] [Thread-1  ]: Runtime Error in model extra_metrics (models/extra_metrics.sql)
  line 26:9: Column 'daily_return' cannot be resolved
[0m13:59:58.447799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00028496-bfdb-4648-8a1e-748a35aafd67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc9160>]}
[0m13:59:58.448561 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model default_globalx.extra_metrics ............. [[31mERROR[0m in 83.61s]
[0m13:59:58.449015 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m13:59:58.450548 [debug] [MainThread]: Acquiring new athena connection "master"
[0m13:59:58.451029 [info ] [MainThread]: 
[0m13:59:58.451239 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 1 minutes and 34.52 seconds (94.52s).
[0m13:59:58.451406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:58.451489 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m13:59:58.451568 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m13:59:58.451646 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m13:59:58.462182 [info ] [MainThread]: 
[0m13:59:58.462460 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:59:58.462641 [info ] [MainThread]: 
[0m13:59:58.462787 [error] [MainThread]: [33mRuntime Error in model extra_metrics (models/extra_metrics.sql)[0m
[0m13:59:58.462932 [error] [MainThread]:   line 26:9: Column 'daily_return' cannot be resolved
[0m13:59:58.463178 [info ] [MainThread]: 
[0m13:59:58.463449 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:59:58.463706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f27d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111299cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d22af0>]}
[0m13:59:58.463877 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 14:04:12.845197 | a1947343-c1e4-4cbf-809a-9018ec6b4dc6 ==============================
[0m14:04:12.845217 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:04:12.845708 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:04:12.845799 [debug] [MainThread]: Tracking: tracking
[0m14:04:12.863655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abe160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abe040>]}
[0m14:04:12.900281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:12.900538 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/extra_metrics.sql
[0m14:04:12.907191 [debug] [MainThread]: 1603: static parser failed on extra_metrics.sql
[0m14:04:12.918513 [debug] [MainThread]: 1602: parser fallback to jinja rendering on extra_metrics.sql
[0m14:04:12.929659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1947343-c1e4-4cbf-809a-9018ec6b4dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4e580>]}
[0m14:04:12.934659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1947343-c1e4-4cbf-809a-9018ec6b4dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd70a0>]}
[0m14:04:12.934867 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:04:12.935010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1947343-c1e4-4cbf-809a-9018ec6b4dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1d370>]}
[0m14:04:12.935735 [info ] [MainThread]: 
[0m14:04:12.936063 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:04:12.936595 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:04:12.940680 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:04:12.940840 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:04:12.940920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:14.826954 [debug] [ThreadPool]: SQL status: OK -1 in 1.89 seconds
[0m14:04:14.833130 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:04:14.835027 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m14:04:14.845461 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m14:04:14.845693 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m14:04:14.845844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:16.526229 [debug] [ThreadPool]: SQL status: OK -1 in 1.68 seconds
[0m14:04:16.529735 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m14:04:16.531020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1947343-c1e4-4cbf-809a-9018ec6b4dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd6250>]}
[0m14:04:16.531940 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:04:16.532340 [info ] [MainThread]: 
[0m14:04:16.535542 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m14:04:16.535888 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m14:04:16.536553 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:04:16.538713 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m14:04:16.539029 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m14:04:16.594695 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:04:16.594885 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m14:04:16.594963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:18.159511 [debug] [Thread-1  ]: SQL status: OK -1 in 1.56 seconds
[0m14:04:18.165209 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m14:04:18.167758 [debug] [Thread-1  ]: finished collecting timing info
[0m14:04:18.168028 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m14:04:18.181553 [debug] [Thread-1  ]: finished collecting timing info
[0m14:04:18.181817 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m14:04:18.182355 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m14:04:18.182617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1947343-c1e4-4cbf-809a-9018ec6b4dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f400ac0>]}
[0m14:04:18.182930 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.65s]
[0m14:04:18.183273 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m14:04:18.183875 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m14:04:18.184092 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m14:04:18.184204 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m14:04:18.184375 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m14:04:18.184671 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m14:04:18.184918 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m14:04:18.185254 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m14:04:18.185455 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m14:04:18.185710 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m14:04:18.186649 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:04:18.187090 [info ] [MainThread]: 
[0m14:04:18.187292 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m14:04:18.187480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:18.187584 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m14:04:18.194766 [info ] [MainThread]: 
[0m14:04:18.194987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:04:18.195165 [info ] [MainThread]: 
[0m14:04:18.195320 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m14:04:18.195490 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m14:04:18.195637 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m14:04:18.195780 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m14:04:18.195920 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m14:04:18.196061 [error] [MainThread]:   
[0m14:04:18.196201 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m14:04:18.196341 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m14:04:18.196479 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m14:04:18.196828 [info ] [MainThread]: 
[0m14:04:18.197042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m14:04:18.197280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108badc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e861100>]}
[0m14:04:18.197463 [debug] [MainThread]: Flushing usage events
[0m14:04:23.433098 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2024-06-06 14:06:13.085577 | 2933f344-ed99-4b0e-bbb9-d1a7737b0330 ==============================
[0m14:06:13.085602 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:06:13.086120 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:06:13.086218 [debug] [MainThread]: Tracking: tracking
[0m14:06:13.094739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f84700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f72160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f72040>]}
[0m14:06:13.133415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:13.133598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:13.137192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2933f344-ed99-4b0e-bbb9-d1a7737b0330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061190d0>]}
[0m14:06:13.140750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2933f344-ed99-4b0e-bbb9-d1a7737b0330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060617c0>]}
[0m14:06:13.140911 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:06:13.141045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2933f344-ed99-4b0e-bbb9-d1a7737b0330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106061850>]}
[0m14:06:13.141883 [info ] [MainThread]: 
[0m14:06:13.142272 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:06:13.142899 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:06:13.149650 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:06:13.149807 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:06:13.149884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:15.021227 [debug] [ThreadPool]: SQL status: OK -1 in 1.87 seconds
[0m14:06:15.022272 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:06:15.023189 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m14:06:15.028728 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m14:06:15.028923 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m14:06:15.029002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:16.662938 [debug] [ThreadPool]: SQL status: OK -1 in 1.63 seconds
[0m14:06:16.666172 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m14:06:16.667261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2933f344-ed99-4b0e-bbb9-d1a7737b0330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6250>]}
[0m14:06:16.667911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:16.668163 [info ] [MainThread]: 
[0m14:06:16.671261 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m14:06:16.671583 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m14:06:16.672133 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:06:16.673766 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m14:06:16.673953 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m14:06:16.680860 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:06:16.681108 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m14:06:16.681240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:06:18.298879 [debug] [Thread-1  ]: SQL status: OK -1 in 1.62 seconds
[0m14:06:18.303603 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m14:06:18.305047 [debug] [Thread-1  ]: finished collecting timing info
[0m14:06:18.305317 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m14:06:18.324717 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m14:06:18.325304 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:06:18.325441 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m14:06:19.725958 [debug] [Thread-1  ]: SQL status: OK -1 in 1.4 seconds
[0m14:06:19.736243 [debug] [Thread-1  ]: finished collecting timing info
[0m14:06:19.736611 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m14:06:19.737297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2933f344-ed99-4b0e-bbb9-d1a7737b0330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cddea00>]}
[0m14:06:19.737754 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.07s]
[0m14:06:19.738249 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m14:06:19.738991 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m14:06:19.739239 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m14:06:19.739496 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m14:06:19.739699 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m14:06:19.740254 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m14:06:19.740743 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m14:06:19.740888 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m14:06:19.741016 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m14:06:19.741159 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m14:06:19.741280 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m14:06:19.744444 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m14:06:19.747020 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m14:06:19.748360 [debug] [Thread-4  ]: finished collecting timing info
[0m14:06:19.748504 [debug] [Thread-3  ]: finished collecting timing info
[0m14:06:19.748634 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m14:06:19.748771 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m14:06:19.755160 [debug] [Thread-4  ]: finished collecting timing info
[0m14:06:19.756765 [debug] [Thread-3  ]: finished collecting timing info
[0m14:06:19.757205 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m14:06:19.757792 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m14:06:19.758013 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2933f344-ed99-4b0e-bbb9-d1a7737b0330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd7e80>]}
[0m14:06:19.758207 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2933f344-ed99-4b0e-bbb9-d1a7737b0330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd7fd0>]}
[0m14:06:19.758523 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m14:06:19.758821 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m14:06:19.759199 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m14:06:19.759567 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m14:06:19.760065 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m14:06:19.760332 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m14:06:19.760661 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m14:06:19.761508 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:06:19.761882 [info ] [MainThread]: 
[0m14:06:19.762051 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m14:06:19.762202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:19.762282 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m14:06:19.762357 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m14:06:19.762434 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m14:06:19.767828 [info ] [MainThread]: 
[0m14:06:19.768034 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:06:19.768203 [info ] [MainThread]: 
[0m14:06:19.768342 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m14:06:19.768481 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m14:06:19.768609 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m14:06:19.768738 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m14:06:19.768863 [error] [MainThread]:   Found: default_globalx.polygon
[0m14:06:19.768988 [error] [MainThread]:   
[0m14:06:19.769115 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m14:06:19.769229 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m14:06:19.769345 [info ] [MainThread]: 
[0m14:06:19.769462 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m14:06:19.769577 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m14:06:19.769690 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m14:06:19.769802 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m14:06:19.769914 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m14:06:19.770029 [error] [MainThread]:   
[0m14:06:19.770141 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m14:06:19.770255 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m14:06:19.770378 [info ] [MainThread]: 
[0m14:06:19.770499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m14:06:19.770732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cceb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f0670>]}
[0m14:06:19.770896 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 14:09:43.772815 | bfa0f783-dd30-4e30-b8d9-d496f5856694 ==============================
[0m14:09:43.772840 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:09:43.773471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:09:43.773588 [debug] [MainThread]: Tracking: tracking
[0m14:09:43.785856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115365400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a82a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153521c0>]}
[0m14:09:43.823405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:43.823572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:43.827314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa0f783-dd30-4e30-b8d9-d496f5856694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154f90d0>]}
[0m14:09:43.830558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa0f783-dd30-4e30-b8d9-d496f5856694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154415b0>]}
[0m14:09:43.830698 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:09:43.830828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa0f783-dd30-4e30-b8d9-d496f5856694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154c1fa0>]}
[0m14:09:43.831459 [info ] [MainThread]: 
[0m14:09:43.831747 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:09:43.832205 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:09:43.839004 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:09:43.839093 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:09:43.839158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:44.924289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:44.924663 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was left open.
[0m14:09:44.924878 [debug] [MainThread]: On list_AwsDataCatalog: Close
[0m14:09:44.925085 [debug] [MainThread]: Flushing usage events
[0m14:09:45.091628 [info ] [MainThread]: ctrl-c


============================== 2024-06-06 14:10:17.711508 | 9c02e002-1705-4fd6-beed-4b0c4e8e7418 ==============================
[0m14:10:17.711534 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:10:17.712125 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:10:17.712256 [debug] [MainThread]: Tracking: tracking
[0m14:10:17.722184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a147f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f66d0>]}
[0m14:10:17.756559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:10:17.756704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:10:17.759933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba90d0>]}
[0m14:10:17.763253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af1790>]}
[0m14:10:17.763392 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:10:17.763524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af1820>]}
[0m14:10:17.764180 [info ] [MainThread]: 
[0m14:10:17.764476 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:10:17.764972 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:10:17.771633 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:10:17.771797 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:10:17.771874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:19.530001 [debug] [ThreadPool]: SQL status: OK -1 in 1.76 seconds
[0m14:10:19.532629 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:10:19.533663 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m14:10:19.540412 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m14:10:19.540649 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m14:10:19.540816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:21.181903 [debug] [ThreadPool]: SQL status: OK -1 in 1.64 seconds
[0m14:10:21.185328 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m14:10:21.186748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c56250>]}
[0m14:10:21.187625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:10:21.188010 [info ] [MainThread]: 
[0m14:10:21.190568 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m14:10:21.190914 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m14:10:21.191568 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:10:21.193995 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m14:10:21.194211 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m14:10:21.202262 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:10:21.202530 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m14:10:21.202659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:10:22.878942 [debug] [Thread-1  ]: SQL status: OK -1 in 1.68 seconds
[0m14:10:22.883072 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m14:10:22.884104 [debug] [Thread-1  ]: finished collecting timing info
[0m14:10:22.884372 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m14:10:22.904222 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m14:10:22.904799 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:10:22.904935 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m14:10:24.350504 [debug] [Thread-1  ]: SQL status: OK -1 in 1.45 seconds
[0m14:10:24.361129 [debug] [Thread-1  ]: finished collecting timing info
[0m14:10:24.361516 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m14:10:24.362209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c68040>]}
[0m14:10:24.362663 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.17s]
[0m14:10:24.363157 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m14:10:24.363862 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m14:10:24.364157 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m14:10:24.364361 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m14:10:24.364604 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m14:10:24.365238 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m14:10:24.365727 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m14:10:24.365867 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m14:10:24.366090 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m14:10:24.366234 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m14:10:24.366358 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m14:10:24.369455 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m14:10:24.372170 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m14:10:24.372997 [debug] [Thread-3  ]: finished collecting timing info
[0m14:10:24.373167 [debug] [Thread-4  ]: finished collecting timing info
[0m14:10:24.373301 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m14:10:24.373450 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m14:10:24.388655 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m14:10:24.390415 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m14:10:24.390883 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:10:24.391007 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:10:24.391098 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql

with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m14:10:24.391199 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql

with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m14:10:24.391294 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:10:24.391386 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:10:27.113629 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.72 seconds
[0m14:10:27.115527 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:10:27.115641 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m14:10:27.158120 [debug] [Thread-3  ]: SQL status: OK 48 in 2.77 seconds
[0m14:10:27.158886 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:10:27.158998 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m14:10:28.538478 [debug] [Thread-4  ]: SQL status: OK -1 in 1.42 seconds
[0m14:10:28.541771 [debug] [Thread-4  ]: finished collecting timing info
[0m14:10:28.542131 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m14:10:28.543036 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fdca0>]}
[0m14:10:28.543693 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.18s]
[0m14:10:28.545861 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m14:10:28.544771 [debug] [Thread-3  ]: SQL status: OK -1 in 1.39 seconds
[0m14:10:28.547642 [debug] [Thread-3  ]: finished collecting timing info
[0m14:10:28.547825 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m14:10:28.548191 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce0f6a0>]}
[0m14:10:28.548367 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.18s]
[0m14:10:28.548552 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m14:10:28.548789 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m14:10:28.548894 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m14:10:28.549160 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m14:10:28.550093 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m14:10:28.550174 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m14:10:28.552275 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:10:28.552363 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m14:10:28.552426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:10:30.137707 [debug] [Thread-1  ]: SQL status: OK -1 in 1.59 seconds
[0m14:10:30.141355 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m14:10:30.142991 [debug] [Thread-1  ]: finished collecting timing info
[0m14:10:30.143322 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m14:10:30.147153 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m14:10:30.148179 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:10:30.148403 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    jd.unemployment_rate,
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m14:10:31.560113 [debug] [Thread-1  ]: SQL status: OK -1 in 1.41 seconds
[0m14:10:31.561480 [debug] [Thread-1  ]: finished collecting timing info
[0m14:10:31.561626 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m14:10:31.562014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c02e002-1705-4fd6-beed-4b0c4e8e7418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec41640>]}
[0m14:10:31.562252 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 3.01s]
[0m14:10:31.562515 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m14:10:31.563338 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:10:31.563668 [info ] [MainThread]: 
[0m14:10:31.563826 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 13.80 seconds (13.80s).
[0m14:10:31.563972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:31.564054 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m14:10:31.564133 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m14:10:31.564206 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m14:10:31.571509 [info ] [MainThread]: 
[0m14:10:31.571706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:31.571865 [info ] [MainThread]: 
[0m14:10:31.571992 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:10:31.572175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c43760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c43790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde71c0>]}
[0m14:10:31.572326 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:06:44.793029 | f9607d07-d910-4142-b077-4c017a7078cb ==============================
[0m17:06:44.793036 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:06:44.793863 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:06:44.793945 [debug] [MainThread]: Tracking: tracking
[0m17:06:44.813955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d6fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ca1c0>]}
[0m17:06:44.921304 [debug] [MainThread]: Executing "git --help"
[0m17:06:44.937362 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:06:44.937766 [debug] [MainThread]: STDERR: "b''"
[0m17:06:44.948759 [debug] [MainThread]: Acquiring new athena connection "debug"
[0m17:06:44.949322 [debug] [MainThread]: Using athena connection "debug"
[0m17:06:44.949428 [debug] [MainThread]: On debug: select 1 as id
[0m17:06:44.949526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:46.511057 [debug] [MainThread]: SQL status: OK -1 in 1.56 seconds
[0m17:06:46.512126 [debug] [MainThread]: On debug: Close
[0m17:06:46.512407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108586cd0>]}
[0m17:06:46.512634 [debug] [MainThread]: Flushing usage events
[0m17:06:46.796177 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-06-06 17:06:53.680004 | f1b78785-f706-419b-a702-99a094f0db67 ==============================
[0m17:06:53.680025 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:06:53.680432 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:06:53.680523 [debug] [MainThread]: Tracking: tracking
[0m17:06:53.689335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b922b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b92490>]}
[0m17:06:53.731180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:06:53.731450 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/extra_metrics.sql
[0m17:06:53.739364 [debug] [MainThread]: 1603: static parser failed on extra_metrics.sql
[0m17:06:53.752541 [debug] [MainThread]: 1602: parser fallback to jinja rendering on extra_metrics.sql
[0m17:06:53.763605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1b78785-f706-419b-a702-99a094f0db67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d22130>]}
[0m17:06:53.767979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1b78785-f706-419b-a702-99a094f0db67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d04c70>]}
[0m17:06:53.768140 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:06:53.768299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b78785-f706-419b-a702-99a094f0db67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db8af0>]}
[0m17:06:53.768990 [info ] [MainThread]: 
[0m17:06:53.769323 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:06:53.769871 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:06:53.774236 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:06:53.774377 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:06:53.774462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:55.373626 [debug] [ThreadPool]: SQL status: OK -1 in 1.6 seconds
[0m17:06:55.375987 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:06:55.377826 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:06:55.387419 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:06:55.387620 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:06:55.387752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:57.017519 [debug] [ThreadPool]: SQL status: OK -1 in 1.63 seconds
[0m17:06:57.021245 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:06:57.022584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b78785-f706-419b-a702-99a094f0db67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112daa250>]}
[0m17:06:57.023434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:57.023808 [info ] [MainThread]: 
[0m17:06:57.028481 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:06:57.028861 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:06:57.029594 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:06:57.032019 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:06:57.032284 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:06:57.083733 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:06:57.083925 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:06:57.084007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:06:58.625955 [debug] [Thread-1  ]: SQL status: OK -1 in 1.54 seconds
[0m17:06:58.630437 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:06:58.633135 [debug] [Thread-1  ]: finished collecting timing info
[0m17:06:58.633396 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:06:58.646720 [debug] [Thread-1  ]: finished collecting timing info
[0m17:06:58.647017 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:06:58.647530 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:06:58.647761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b78785-f706-419b-a702-99a094f0db67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bb88b0>]}
[0m17:06:58.648063 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.62s]
[0m17:06:58.648400 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:06:58.648972 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:06:58.649172 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:06:58.649273 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m17:06:58.649417 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m17:06:58.649687 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:06:58.649915 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:06:58.650260 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:06:58.650478 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:06:58.650809 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:06:58.651782 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:06:58.652231 [info ] [MainThread]: 
[0m17:06:58.652439 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m17:06:58.652626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:58.652729 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:06:58.660236 [info ] [MainThread]: 
[0m17:06:58.660562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:06:58.660800 [info ] [MainThread]: 
[0m17:06:58.660963 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m17:06:58.661125 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:06:58.661274 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m17:06:58.661416 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m17:06:58.661544 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m17:06:58.661672 [error] [MainThread]:   
[0m17:06:58.661800 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m17:06:58.661928 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m17:06:58.662055 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:06:58.662190 [info ] [MainThread]: 
[0m17:06:58.662324 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m17:06:58.662517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b99df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c22be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cee3a0>]}
[0m17:06:58.662685 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:07:56.651800 | e6028b93-3a89-4a48-a712-15d29d5b96a6 ==============================
[0m17:07:56.651820 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:07:56.652246 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:07:56.652347 [debug] [MainThread]: Tracking: tracking
[0m17:07:56.661177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d86b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da4df0>]}
[0m17:07:56.692540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:56.692700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:56.696491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6028b93-3a89-4a48-a712-15d29d5b96a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f390d0>]}
[0m17:07:56.701428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6028b93-3a89-4a48-a712-15d29d5b96a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e836d0>]}
[0m17:07:56.701605 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:07:56.701765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6028b93-3a89-4a48-a712-15d29d5b96a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f5ee0>]}
[0m17:07:56.702574 [info ] [MainThread]: 
[0m17:07:56.702935 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:07:56.703549 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:07:56.711515 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:07:56.711700 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:07:56.711809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:58.302773 [debug] [ThreadPool]: SQL status: OK -1 in 1.59 seconds
[0m17:07:58.305342 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:07:58.306848 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:07:58.314425 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:07:58.314710 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:07:58.314825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:59.988662 [debug] [ThreadPool]: SQL status: OK -1 in 1.67 seconds
[0m17:07:59.989955 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:07:59.990553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6028b93-3a89-4a48-a712-15d29d5b96a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe62e0>]}
[0m17:07:59.991040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:59.991227 [info ] [MainThread]: 
[0m17:07:59.992538 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:07:59.992725 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:07:59.993102 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:07:59.994342 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:07:59.994462 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:07:59.999087 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:07:59.999239 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:07:59.999326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:08:01.656469 [debug] [Thread-1  ]: SQL status: OK -1 in 1.66 seconds
[0m17:08:01.660585 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:08:01.661838 [debug] [Thread-1  ]: finished collecting timing info
[0m17:08:01.662114 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:08:01.681560 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:08:01.682194 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:08:01.682370 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:08:03.225639 [debug] [Thread-1  ]: SQL status: OK -1 in 1.54 seconds
[0m17:08:03.237692 [debug] [Thread-1  ]: finished collecting timing info
[0m17:08:03.238075 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:08:03.238736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6028b93-3a89-4a48-a712-15d29d5b96a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f713a30>]}
[0m17:08:03.239171 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.25s]
[0m17:08:03.239672 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:08:03.240350 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:08:03.240515 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:08:03.240800 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:08:03.241004 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:08:03.241564 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:08:03.242059 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:08:03.242199 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:08:03.242330 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:08:03.242478 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:08:03.242603 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:08:03.245633 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:08:03.248324 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:08:03.250854 [debug] [Thread-4  ]: finished collecting timing info
[0m17:08:03.251073 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:08:03.251200 [debug] [Thread-3  ]: finished collecting timing info
[0m17:08:03.257735 [debug] [Thread-4  ]: finished collecting timing info
[0m17:08:03.257892 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:08:03.258316 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m17:08:03.259907 [debug] [Thread-3  ]: finished collecting timing info
[0m17:08:03.260169 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6028b93-3a89-4a48-a712-15d29d5b96a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f38c670>]}
[0m17:08:03.260544 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m17:08:03.260813 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m17:08:03.261061 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6028b93-3a89-4a48-a712-15d29d5b96a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f38c6d0>]}
[0m17:08:03.261335 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:08:03.261580 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m17:08:03.261971 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:08:03.262242 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:08:03.262468 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:08:03.262696 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:08:03.263460 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:08:03.263804 [info ] [MainThread]: 
[0m17:08:03.263965 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m17:08:03.264112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:03.264192 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:08:03.264268 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:08:03.264343 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:08:03.269574 [info ] [MainThread]: 
[0m17:08:03.269763 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:08:03.269933 [info ] [MainThread]: 
[0m17:08:03.270074 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m17:08:03.270210 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:08:03.270340 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m17:08:03.270468 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m17:08:03.270595 [error] [MainThread]:   Found: default_globalx.polygon
[0m17:08:03.270720 [error] [MainThread]:   
[0m17:08:03.270847 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:08:03.270975 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m17:08:03.271106 [info ] [MainThread]: 
[0m17:08:03.271235 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m17:08:03.271361 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:08:03.271474 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m17:08:03.271590 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m17:08:03.271703 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m17:08:03.271817 [error] [MainThread]:   
[0m17:08:03.271929 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:08:03.272043 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m17:08:03.272166 [info ] [MainThread]: 
[0m17:08:03.272284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m17:08:03.272485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f04100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8f2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6edd60>]}
[0m17:08:03.272622 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:10:21.061977 | a7b6c992-d58b-4a44-99ee-6c608608f5a1 ==============================
[0m17:10:21.061995 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:10:21.062407 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:10:21.062509 [debug] [MainThread]: Tracking: tracking
[0m17:10:21.072963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106062e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110624e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110624a00>]}
[0m17:10:21.111493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:21.111802 [debug] [MainThread]: Partial parsing: update schema file: global_x_task://models/source.yml
[0m17:10:21.129578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b6c992-d58b-4a44-99ee-6c608608f5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d10d0>]}
[0m17:10:21.133974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b6c992-d58b-4a44-99ee-6c608608f5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b2a60>]}
[0m17:10:21.134153 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:10:21.134309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b6c992-d58b-4a44-99ee-6c608608f5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106062e0>]}
[0m17:10:21.135007 [info ] [MainThread]: 
[0m17:10:21.135341 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:10:21.135948 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:10:21.143631 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:10:21.143825 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:10:21.143911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:22.727868 [debug] [ThreadPool]: SQL status: OK -1 in 1.58 seconds
[0m17:10:22.730320 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:10:22.732522 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:10:22.737442 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:10:22.737579 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:10:22.737695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:24.302044 [debug] [ThreadPool]: SQL status: OK -1 in 1.56 seconds
[0m17:10:24.304382 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:10:24.305969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b6c992-d58b-4a44-99ee-6c608608f5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110904c40>]}
[0m17:10:24.306504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:10:24.306686 [info ] [MainThread]: 
[0m17:10:24.307976 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:10:24.308172 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:10:24.308536 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:10:24.309582 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:10:24.309707 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:10:24.315920 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:10:24.316214 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:10:24.316401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:25.846431 [debug] [Thread-1  ]: SQL status: OK -1 in 1.53 seconds
[0m17:10:25.850812 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:10:25.852010 [debug] [Thread-1  ]: finished collecting timing info
[0m17:10:25.852302 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:10:25.865999 [debug] [Thread-1  ]: finished collecting timing info
[0m17:10:25.866283 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:10:25.866825 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:10:25.867094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b6c992-d58b-4a44-99ee-6c608608f5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178034f0>]}
[0m17:10:25.867433 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.56s]
[0m17:10:25.867814 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:10:25.868443 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:10:25.868662 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:10:25.868777 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m17:10:25.868942 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m17:10:25.869244 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:10:25.869513 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:10:25.869857 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:10:25.869995 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:10:25.870336 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:10:25.871324 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:10:25.871780 [info ] [MainThread]: 
[0m17:10:25.871986 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m17:10:25.872180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:25.872288 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:10:25.880429 [info ] [MainThread]: 
[0m17:10:25.880682 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:25.880878 [info ] [MainThread]: 
[0m17:10:25.881039 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m17:10:25.881401 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:10:25.881571 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m17:10:25.881723 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m17:10:25.881867 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m17:10:25.882008 [error] [MainThread]:   
[0m17:10:25.882150 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m17:10:25.882293 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m17:10:25.882433 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:10:25.882591 [info ] [MainThread]: 
[0m17:10:25.882740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m17:10:25.882943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203e8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203e8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11608e9d0>]}
[0m17:10:25.883109 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:10:33.649271 | 6e88c417-53de-46c0-ac3b-2b6eaf92a379 ==============================
[0m17:10:33.649298 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:10:33.649709 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:10:33.649811 [debug] [MainThread]: Tracking: tracking
[0m17:10:33.660648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d2040>]}
[0m17:10:33.702227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:33.702404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:33.706318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e88c417-53de-46c0-ac3b-2b6eaf92a379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097d0d0>]}
[0m17:10:33.710748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e88c417-53de-46c0-ac3b-2b6eaf92a379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c7cd0>]}
[0m17:10:33.710907 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:10:33.711056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e88c417-53de-46c0-ac3b-2b6eaf92a379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c7d60>]}
[0m17:10:33.711768 [info ] [MainThread]: 
[0m17:10:33.712108 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:10:33.712681 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:10:33.720426 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:10:33.720582 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:10:33.720678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:35.330530 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m17:10:35.332263 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:10:35.333721 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:10:35.341192 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:10:35.341384 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:10:35.341519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:36.877271 [debug] [ThreadPool]: SQL status: OK -1 in 1.54 seconds
[0m17:10:36.879171 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:10:36.880228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e88c417-53de-46c0-ac3b-2b6eaf92a379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b2ad60>]}
[0m17:10:36.880941 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:10:36.881235 [info ] [MainThread]: 
[0m17:10:36.884406 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:10:36.884813 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:10:36.885407 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:10:36.887034 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:10:36.887215 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:10:36.893625 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:10:36.893829 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:10:36.893948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:38.435637 [debug] [Thread-1  ]: SQL status: OK -1 in 1.54 seconds
[0m17:10:38.436973 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:10:38.437946 [debug] [Thread-1  ]: finished collecting timing info
[0m17:10:38.438089 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:10:38.450981 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:10:38.451536 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:10:38.451648 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:10:39.850048 [debug] [Thread-1  ]: SQL status: OK -1 in 1.4 seconds
[0m17:10:39.857515 [debug] [Thread-1  ]: finished collecting timing info
[0m17:10:39.857773 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:10:39.858282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e88c417-53de-46c0-ac3b-2b6eaf92a379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b14af0>]}
[0m17:10:39.858599 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.97s]
[0m17:10:39.859007 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:10:39.859555 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:10:39.859773 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:10:39.859921 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:10:39.860134 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:10:39.860680 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:10:39.861266 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:10:39.861430 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:10:39.861558 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:10:39.861694 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:10:39.861811 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:10:39.864588 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:10:39.866688 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:10:39.868743 [debug] [Thread-3  ]: finished collecting timing info
[0m17:10:39.868848 [debug] [Thread-4  ]: finished collecting timing info
[0m17:10:39.868975 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:10:39.869083 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:10:39.874766 [debug] [Thread-3  ]: finished collecting timing info
[0m17:10:39.876238 [debug] [Thread-4  ]: finished collecting timing info
[0m17:10:39.876629 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m17:10:39.876944 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m17:10:39.877152 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e88c417-53de-46c0-ac3b-2b6eaf92a379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f58850>]}
[0m17:10:39.877309 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e88c417-53de-46c0-ac3b-2b6eaf92a379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f586d0>]}
[0m17:10:39.877553 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m17:10:39.877813 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m17:10:39.878115 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:10:39.878322 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:10:39.878675 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:10:39.878901 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:10:39.879138 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:10:39.879947 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:10:39.880317 [info ] [MainThread]: 
[0m17:10:39.880506 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m17:10:39.880653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:39.880727 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:10:39.880797 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:10:39.880864 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:10:39.885717 [info ] [MainThread]: 
[0m17:10:39.885917 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:10:39.886064 [info ] [MainThread]: 
[0m17:10:39.886180 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m17:10:39.886294 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:10:39.886403 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m17:10:39.886542 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m17:10:39.886657 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m17:10:39.886770 [error] [MainThread]:   
[0m17:10:39.886884 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:10:39.886997 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m17:10:39.887112 [info ] [MainThread]: 
[0m17:10:39.887229 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m17:10:39.887345 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:10:39.887456 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m17:10:39.887569 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m17:10:39.887680 [error] [MainThread]:   Found: default_globalx.polygon
[0m17:10:39.887793 [error] [MainThread]:   
[0m17:10:39.887905 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:10:39.888018 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m17:10:39.888139 [info ] [MainThread]: 
[0m17:10:39.888259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m17:10:39.888441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b14af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169cf850>]}
[0m17:10:39.888588 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:11:13.095571 | 2cfa53e9-afbb-4acc-abe1-ad8399c4138b ==============================
[0m17:11:13.095595 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:11:13.096187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:11:13.096295 [debug] [MainThread]: Tracking: tracking
[0m17:11:13.106790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106256910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062522b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106252490>]}
[0m17:11:13.146059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:11:13.146372 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/polygon.sql
[0m17:11:13.146533 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m17:11:13.154935 [debug] [MainThread]: 1603: static parser failed on polygon.sql
[0m17:11:13.163663 [debug] [MainThread]: 1602: parser fallback to jinja rendering on polygon.sql
[0m17:11:13.164526 [debug] [MainThread]: 1603: static parser failed on fred_unemp.sql
[0m17:11:13.167425 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fred_unemp.sql
[0m17:11:13.184036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cfa53e9-afbb-4acc-abe1-ad8399c4138b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106474f40>]}
[0m17:11:13.187844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cfa53e9-afbb-4acc-abe1-ad8399c4138b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b2970>]}
[0m17:11:13.188024 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:11:13.188179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cfa53e9-afbb-4acc-abe1-ad8399c4138b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b80af0>]}
[0m17:11:13.188887 [info ] [MainThread]: 
[0m17:11:13.189216 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:11:13.189758 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:11:13.197400 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:11:13.197594 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:11:13.197692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:14.652963 [debug] [ThreadPool]: SQL status: OK -1 in 1.46 seconds
[0m17:11:14.657153 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:11:14.659429 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:11:14.669500 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:11:14.669709 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:11:14.669849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:16.384772 [debug] [ThreadPool]: SQL status: OK -1 in 1.71 seconds
[0m17:11:16.386439 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:11:16.387193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cfa53e9-afbb-4acc-abe1-ad8399c4138b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627d040>]}
[0m17:11:16.387690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:16.387910 [info ] [MainThread]: 
[0m17:11:16.390403 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:11:16.390663 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:11:16.391137 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:11:16.392546 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:11:16.392673 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:11:16.398261 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:11:16.398447 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:11:16.398613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:17.838130 [debug] [Thread-1  ]: SQL status: OK -1 in 1.44 seconds
[0m17:11:17.842321 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:11:17.843284 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:17.843542 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:11:17.856819 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:17.857088 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:11:17.857619 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:11:17.857872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cfa53e9-afbb-4acc-abe1-ad8399c4138b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a0910>]}
[0m17:11:17.858231 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.47s]
[0m17:11:17.858634 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:11:17.859283 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:11:17.859513 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:11:17.859618 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m17:11:17.859765 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m17:11:17.860046 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:11:17.860299 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:11:17.860646 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:11:17.860888 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:11:17.861223 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:11:17.862441 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:11:17.863069 [info ] [MainThread]: 
[0m17:11:17.863314 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m17:11:17.863513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:17.863615 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:11:17.871802 [info ] [MainThread]: 
[0m17:11:17.872099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:11:17.872297 [info ] [MainThread]: 
[0m17:11:17.872456 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m17:11:17.872619 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:11:17.872761 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m17:11:17.872899 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m17:11:17.873047 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m17:11:17.873172 [error] [MainThread]:   
[0m17:11:17.873298 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m17:11:17.873424 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m17:11:17.873548 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:11:17.873682 [info ] [MainThread]: 
[0m17:11:17.873814 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m17:11:17.874104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063df700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064474f0>]}
[0m17:11:17.874458 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:11:23.099863 | 8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b ==============================
[0m17:11:23.099884 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:11:23.100281 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:11:23.100378 [debug] [MainThread]: Tracking: tracking
[0m17:11:23.109961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109424730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094122b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109412490>]}
[0m17:11:23.141424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:23.141613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:23.145475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c4d90>]}
[0m17:11:23.149326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109509cd0>]}
[0m17:11:23.149489 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:11:23.149648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107180af0>]}
[0m17:11:23.150380 [info ] [MainThread]: 
[0m17:11:23.150722 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:11:23.151330 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:11:23.158929 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:11:23.159096 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:11:23.159185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:24.776607 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m17:11:24.781655 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:11:24.783919 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:11:24.793976 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:11:24.794203 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:11:24.794355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:26.331643 [debug] [ThreadPool]: SQL status: OK -1 in 1.54 seconds
[0m17:11:26.334814 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:11:26.336163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e97f0>]}
[0m17:11:26.337033 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:26.337442 [info ] [MainThread]: 
[0m17:11:26.339852 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:11:26.340245 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:11:26.340952 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:11:26.343389 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:11:26.343724 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:11:26.351803 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:11:26.352029 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:11:26.352157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:27.885186 [debug] [Thread-1  ]: SQL status: OK -1 in 1.53 seconds
[0m17:11:27.890160 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:11:27.891338 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:27.891617 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:11:27.911428 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:11:27.912059 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:11:27.912208 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:11:29.265368 [debug] [Thread-1  ]: SQL status: OK -1 in 1.35 seconds
[0m17:11:29.277501 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:29.277893 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:11:29.278573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095eba60>]}
[0m17:11:29.279017 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.94s]
[0m17:11:29.279549 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:11:29.280263 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:11:29.280549 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:11:29.280755 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:11:29.281001 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:11:29.281558 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:11:29.282056 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:11:29.282210 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:11:29.282345 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:11:29.282493 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:11:29.282625 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:11:29.286180 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:11:29.289165 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:11:29.289854 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:29.290027 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:11:29.290152 [debug] [Thread-4  ]: finished collecting timing info
[0m17:11:29.296379 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:29.296603 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:11:29.297045 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m17:11:29.298672 [debug] [Thread-4  ]: finished collecting timing info
[0m17:11:29.298917 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119579430>]}
[0m17:11:29.299276 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m17:11:29.299575 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m17:11:29.299744 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6f961a-fdb1-4ff7-aaa1-c0e9c0480c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119579cd0>]}
[0m17:11:29.300083 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:11:29.300261 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m17:11:29.300629 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:11:29.300897 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:11:29.301145 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:11:29.301477 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:11:29.302288 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:11:29.302652 [info ] [MainThread]: 
[0m17:11:29.302823 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m17:11:29.302972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:29.303053 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:11:29.303131 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:11:29.303208 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:11:29.308844 [info ] [MainThread]: 
[0m17:11:29.309062 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:11:29.309237 [info ] [MainThread]: 
[0m17:11:29.309384 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m17:11:29.309527 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:11:29.309664 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m17:11:29.309799 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m17:11:29.309933 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m17:11:29.310071 [error] [MainThread]:   
[0m17:11:29.310202 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:11:29.310323 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m17:11:29.310449 [info ] [MainThread]: 
[0m17:11:29.310575 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m17:11:29.310699 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:11:29.310818 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m17:11:29.310938 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m17:11:29.311056 [error] [MainThread]:   Found: default_globalx.polygon
[0m17:11:29.311175 [error] [MainThread]:   
[0m17:11:29.311295 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:11:29.311413 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m17:11:29.311545 [info ] [MainThread]: 
[0m17:11:29.311671 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m17:11:29.311862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106612040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef2a00>]}
[0m17:11:29.312016 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:12:28.531306 | 60fc0200-b9f8-4148-8375-a14907f278f9 ==============================
[0m17:12:28.531323 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:12:28.531909 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:12:28.532013 [debug] [MainThread]: Tracking: tracking
[0m17:12:28.542479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f862e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa4250>]}
[0m17:12:28.582271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:12:28.582566 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/polygon.sql
[0m17:12:28.582727 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m17:12:28.591123 [debug] [MainThread]: 1603: static parser failed on polygon.sql
[0m17:12:28.600073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on polygon.sql
[0m17:12:28.601002 [debug] [MainThread]: 1603: static parser failed on fred_unemp.sql
[0m17:12:28.604258 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fred_unemp.sql
[0m17:12:28.621097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60fc0200-b9f8-4148-8375-a14907f278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051be0d0>]}
[0m17:12:28.625277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60fc0200-b9f8-4148-8375-a14907f278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f2a60>]}
[0m17:12:28.625458 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:12:28.625608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60fc0200-b9f8-4148-8375-a14907f278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f862e0>]}
[0m17:12:28.626347 [info ] [MainThread]: 
[0m17:12:28.626686 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:12:28.627255 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:12:28.635051 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:12:28.635242 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:12:28.635327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:30.178330 [debug] [ThreadPool]: SQL status: OK -1 in 1.54 seconds
[0m17:12:30.181976 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:12:30.182971 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:12:30.187689 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:12:30.187855 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:12:30.187983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:32.800174 [debug] [ThreadPool]: SQL status: OK -1 in 2.61 seconds
[0m17:12:32.803319 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:12:32.803932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60fc0200-b9f8-4148-8375-a14907f278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106280610>]}
[0m17:12:32.804328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:12:32.804493 [info ] [MainThread]: 
[0m17:12:32.806367 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:12:32.806540 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:12:32.806892 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:12:32.807889 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:12:32.807989 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:12:32.812197 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:12:32.812341 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:12:32.812419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:12:34.369543 [debug] [Thread-1  ]: SQL status: OK -1 in 1.56 seconds
[0m17:12:34.372480 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:12:34.373079 [debug] [Thread-1  ]: finished collecting timing info
[0m17:12:34.373185 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:12:34.379711 [debug] [Thread-1  ]: finished collecting timing info
[0m17:12:34.379837 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:12:34.380112 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:12:34.380243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60fc0200-b9f8-4148-8375-a14907f278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8cd60>]}
[0m17:12:34.380424 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.57s]
[0m17:12:34.380632 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:12:34.380943 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:12:34.381066 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:12:34.381158 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m17:12:34.381282 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m17:12:34.381469 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:12:34.381630 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:12:34.381858 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:12:34.382016 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:12:34.382179 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:12:34.382746 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:12:34.383034 [info ] [MainThread]: 
[0m17:12:34.383171 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m17:12:34.383292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:34.383357 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:12:34.388209 [info ] [MainThread]: 
[0m17:12:34.388536 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:12:34.388781 [info ] [MainThread]: 
[0m17:12:34.388989 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m17:12:34.389187 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:12:34.389374 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m17:12:34.389559 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m17:12:34.389742 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m17:12:34.389924 [error] [MainThread]:   
[0m17:12:34.390081 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m17:12:34.390239 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m17:12:34.390394 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:12:34.390559 [info ] [MainThread]: 
[0m17:12:34.390724 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m17:12:34.390957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062415e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106241d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105188f40>]}
[0m17:12:34.391146 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:12:38.419167 | 049f7a66-9922-47a2-a2f7-78592715de36 ==============================
[0m17:12:38.419194 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:12:38.419651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:12:38.419749 [debug] [MainThread]: Tracking: tracking
[0m17:12:38.430441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074862e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a4250>]}
[0m17:12:38.461770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:38.461942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:38.465794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '049f7a66-9922-47a2-a2f7-78592715de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107645dc0>]}
[0m17:12:38.469752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '049f7a66-9922-47a2-a2f7-78592715de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107587d00>]}
[0m17:12:38.469919 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:12:38.470074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '049f7a66-9922-47a2-a2f7-78592715de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074862e0>]}
[0m17:12:38.470833 [info ] [MainThread]: 
[0m17:12:38.471173 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:12:38.471721 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:12:38.479476 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:12:38.479639 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:12:38.479727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:39.951527 [debug] [ThreadPool]: SQL status: OK -1 in 1.47 seconds
[0m17:12:39.954372 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:12:39.955366 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:12:39.960216 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:12:39.960357 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:12:39.960440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:41.454563 [debug] [ThreadPool]: SQL status: OK -1 in 1.49 seconds
[0m17:12:41.458011 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:12:41.458753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '049f7a66-9922-47a2-a2f7-78592715de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766dd90>]}
[0m17:12:41.459150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:12:41.459306 [info ] [MainThread]: 
[0m17:12:41.460277 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:12:41.460443 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:12:41.460764 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:12:41.461860 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:12:41.461979 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:12:41.466417 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:12:41.466594 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:12:41.466677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:12:42.981831 [debug] [Thread-1  ]: SQL status: OK -1 in 1.52 seconds
[0m17:12:42.983070 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:12:42.983563 [debug] [Thread-1  ]: finished collecting timing info
[0m17:12:42.983675 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:12:42.994311 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:12:42.994765 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:12:42.994920 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:12:44.431529 [debug] [Thread-1  ]: SQL status: OK -1 in 1.44 seconds
[0m17:12:44.438611 [debug] [Thread-1  ]: finished collecting timing info
[0m17:12:44.438829 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:12:44.439153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '049f7a66-9922-47a2-a2f7-78592715de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766c730>]}
[0m17:12:44.439362 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.98s]
[0m17:12:44.439613 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:12:44.439955 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:12:44.440063 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:12:44.440189 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:12:44.440365 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:12:44.440713 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:12:44.441012 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:12:44.441097 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:12:44.441175 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:12:44.441266 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:12:44.441336 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:12:44.443464 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:12:44.445553 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:12:44.446034 [debug] [Thread-3  ]: finished collecting timing info
[0m17:12:44.446132 [debug] [Thread-4  ]: finished collecting timing info
[0m17:12:44.446343 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:12:44.446467 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:12:44.451230 [debug] [Thread-3  ]: finished collecting timing info
[0m17:12:44.452495 [debug] [Thread-4  ]: finished collecting timing info
[0m17:12:44.452826 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m17:12:44.453322 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m17:12:44.453559 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '049f7a66-9922-47a2-a2f7-78592715de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8eb20>]}
[0m17:12:44.453736 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '049f7a66-9922-47a2-a2f7-78592715de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8ec10>]}
[0m17:12:44.453996 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.01s]
[0m17:12:44.454289 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.01s]
[0m17:12:44.454598 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:12:44.454875 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:12:44.455263 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:12:44.455397 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:12:44.455719 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:12:44.456517 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:12:44.456894 [info ] [MainThread]: 
[0m17:12:44.457073 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m17:12:44.457262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:44.457359 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:12:44.457441 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:12:44.457523 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:12:44.463791 [info ] [MainThread]: 
[0m17:12:44.464034 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:12:44.464226 [info ] [MainThread]: 
[0m17:12:44.464384 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m17:12:44.464536 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:12:44.464679 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m17:12:44.464821 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m17:12:44.464994 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m17:12:44.465135 [error] [MainThread]:   
[0m17:12:44.465273 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:12:44.465414 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m17:12:44.465554 [info ] [MainThread]: 
[0m17:12:44.465699 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m17:12:44.465850 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:12:44.465990 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m17:12:44.466128 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m17:12:44.466265 [error] [MainThread]:   Found: default_globalx.polygon
[0m17:12:44.466402 [error] [MainThread]:   
[0m17:12:44.466539 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:12:44.466677 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m17:12:44.466825 [info ] [MainThread]: 
[0m17:12:44.467052 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m17:12:44.467297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107587910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857e370>]}
[0m17:12:44.467483 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:15:44.371231 | e15a17d4-a630-4e0a-a638-f178ff9cd528 ==============================
[0m17:15:44.371248 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:15:44.371801 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:15:44.371913 [debug] [MainThread]: Tracking: tracking
[0m17:15:44.381999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dba2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd8250>]}
[0m17:15:44.421764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:44.421942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:44.425893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e15a17d4-a630-4e0a-a638-f178ff9cd528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f79dc0>]}
[0m17:15:44.429846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e15a17d4-a630-4e0a-a638-f178ff9cd528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebbd00>]}
[0m17:15:44.430016 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:15:44.430182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15a17d4-a630-4e0a-a638-f178ff9cd528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dba2e0>]}
[0m17:15:44.430862 [info ] [MainThread]: 
[0m17:15:44.431017 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:15:44.434701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3cd00>]}
[0m17:15:44.434836 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:15:52.641762 | bed8425e-1d8d-4bdb-836c-0dacd6551e49 ==============================
[0m17:15:52.641785 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:15:52.642193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:15:52.642292 [debug] [MainThread]: Tracking: tracking
[0m17:15:52.651131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d8a00>]}
[0m17:15:52.682187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:52.682365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:52.686131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed8425e-1d8d-4bdb-836c-0dacd6551e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106979dc0>]}
[0m17:15:52.691535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed8425e-1d8d-4bdb-836c-0dacd6551e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bdd00>]}
[0m17:15:52.691703 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:15:52.691856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed8425e-1d8d-4bdb-836c-0dacd6551e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bc2e0>]}
[0m17:15:52.692488 [info ] [MainThread]: 
[0m17:15:52.692637 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:15:52.696505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693dd00>]}
[0m17:15:52.696645 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:15:57.199484 | 07ac34b7-7241-499a-9fad-7dec3c009bcb ==============================
[0m17:15:57.199503 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:15:57.199930 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:15:57.200033 [debug] [MainThread]: Tracking: tracking
[0m17:15:57.209035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114758700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114746160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114746040>]}
[0m17:15:57.240257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:57.240424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:57.244306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07ac34b7-7241-499a-9fad-7dec3c009bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b05d60>]}
[0m17:15:57.249741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07ac34b7-7241-499a-9fad-7dec3c009bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a48d90>]}
[0m17:15:57.249915 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:15:57.250068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07ac34b7-7241-499a-9fad-7dec3c009bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a48e20>]}
[0m17:15:57.250717 [info ] [MainThread]: 
[0m17:15:57.250860 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:15:57.254535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac8d60>]}
[0m17:15:57.254679 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:17:06.172198 | 48a507c6-3023-469e-a4a9-23dcdf99d52a ==============================
[0m17:17:06.172223 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:17:06.172785 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:17:06.172891 [debug] [MainThread]: Tracking: tracking
[0m17:17:06.182928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060422e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106060220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060606a0>]}
[0m17:17:06.224553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:17:06.224877 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/polygon.sql
[0m17:17:06.225046 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/fred_unemp.sql
[0m17:17:06.233812 [debug] [MainThread]: 1603: static parser failed on polygon.sql
[0m17:17:06.242844 [debug] [MainThread]: 1602: parser fallback to jinja rendering on polygon.sql
[0m17:17:06.243647 [debug] [MainThread]: 1603: static parser failed on fred_unemp.sql
[0m17:17:06.246733 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fred_unemp.sql
[0m17:17:06.262702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48a507c6-3023-469e-a4a9-23dcdf99d52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062770d0>]}
[0m17:17:06.266527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48a507c6-3023-469e-a4a9-23dcdf99d52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061afa60>]}
[0m17:17:06.266744 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:17:06.266894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48a507c6-3023-469e-a4a9-23dcdf99d52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060422e0>]}
[0m17:17:06.267526 [info ] [MainThread]: 
[0m17:17:06.267670 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:17:06.270940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106172190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106172220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106172ac0>]}
[0m17:17:06.271087 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:17:11.078354 | fe738455-02d5-43fa-9978-09749a7d9327 ==============================
[0m17:17:11.078384 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:17:11.078744 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:17:11.078839 [debug] [MainThread]: Tracking: tracking
[0m17:17:11.088444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e062e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e24e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e24a00>]}
[0m17:17:11.119594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:11.119750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:11.123451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe738455-02d5-43fa-9978-09749a7d9327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3dc0>]}
[0m17:17:11.127397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe738455-02d5-43fa-9978-09749a7d9327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107008d00>]}
[0m17:17:11.127553 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:17:11.127703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe738455-02d5-43fa-9978-09749a7d9327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e062e0>]}
[0m17:17:11.128460 [info ] [MainThread]: 
[0m17:17:11.128876 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:17:11.129471 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:17:11.136959 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:17:11.137159 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:17:11.137276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:12.948418 [debug] [ThreadPool]: SQL status: OK -1 in 1.81 seconds
[0m17:17:12.952525 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:17:12.954807 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:17:12.964879 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:17:12.965114 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:17:12.965262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:14.698455 [debug] [ThreadPool]: SQL status: OK -1 in 1.73 seconds
[0m17:17:14.701677 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:17:14.702871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe738455-02d5-43fa-9978-09749a7d9327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ead90>]}
[0m17:17:14.703751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:14.704148 [info ] [MainThread]: 
[0m17:17:14.707858 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:17:14.708204 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:17:14.708870 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:17:14.711229 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:17:14.711462 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:17:14.719135 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:17:14.719378 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:17:14.719505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:16.345068 [debug] [Thread-1  ]: SQL status: OK -1 in 1.63 seconds
[0m17:17:16.348750 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:17:16.351145 [debug] [Thread-1  ]: finished collecting timing info
[0m17:17:16.351444 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:17:16.364644 [debug] [Thread-1  ]: finished collecting timing info
[0m17:17:16.364912 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:17:16.365425 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:17:16.365716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe738455-02d5-43fa-9978-09749a7d9327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c48ee0>]}
[0m17:17:16.366038 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.66s]
[0m17:17:16.366402 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:17:16.367055 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:17:16.367191 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:17:16.367338 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m17:17:16.367480 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m17:17:16.367757 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:17:16.368009 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:17:16.368363 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:17:16.368610 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:17:16.368945 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:17:16.369950 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:17:16.370416 [info ] [MainThread]: 
[0m17:17:16.370629 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m17:17:16.370815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:16.370915 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:17:16.377607 [info ] [MainThread]: 
[0m17:17:16.377837 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:16.378021 [info ] [MainThread]: 
[0m17:17:16.378176 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m17:17:16.378331 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:17:16.378474 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m17:17:16.378617 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m17:17:16.378758 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m17:17:16.378902 [error] [MainThread]:   
[0m17:17:16.379046 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m17:17:16.379185 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m17:17:16.379322 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:17:16.379469 [info ] [MainThread]: 
[0m17:17:16.379619 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m17:17:16.379828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208cc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208cc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efc400>]}
[0m17:17:16.379990 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:17:22.528043 | f7abdc3b-deb8-432d-8b01-5f8cba4816ef ==============================
[0m17:17:22.528066 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:17:22.528614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:17:22.528798 [debug] [MainThread]: Tracking: tracking
[0m17:17:22.539920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107998220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107998e50>]}
[0m17:17:22.580916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:22.581087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:22.585378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7abdc3b-deb8-432d-8b01-5f8cba4816ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b38dc0>]}
[0m17:17:22.589594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7abdc3b-deb8-432d-8b01-5f8cba4816ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7cd00>]}
[0m17:17:22.589763 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:17:22.589921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7abdc3b-deb8-432d-8b01-5f8cba4816ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797a2e0>]}
[0m17:17:22.590633 [info ] [MainThread]: 
[0m17:17:22.590980 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:17:22.591659 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:17:22.599752 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:17:22.599952 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:17:22.600043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:24.113570 [debug] [ThreadPool]: SQL status: OK -1 in 1.51 seconds
[0m17:17:24.114666 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:17:24.115681 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:17:24.120775 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:17:24.120919 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:17:24.121077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:25.608560 [debug] [ThreadPool]: SQL status: OK -1 in 1.49 seconds
[0m17:17:25.609667 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:17:25.610303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7abdc3b-deb8-432d-8b01-5f8cba4816ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5fd90>]}
[0m17:17:25.610711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:25.610877 [info ] [MainThread]: 
[0m17:17:25.612256 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:17:25.612492 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:17:25.612882 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:17:25.614139 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:17:25.614341 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:17:25.618788 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:17:25.618972 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:17:25.619055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:27.126763 [debug] [Thread-1  ]: SQL status: OK -1 in 1.51 seconds
[0m17:17:27.127901 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:17:27.128261 [debug] [Thread-1  ]: finished collecting timing info
[0m17:17:27.128373 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:17:27.140057 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:17:27.140511 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:17:27.140606 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:17:28.479282 [debug] [Thread-1  ]: SQL status: OK -1 in 1.34 seconds
[0m17:17:28.489751 [debug] [Thread-1  ]: finished collecting timing info
[0m17:17:28.490111 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:17:28.490784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7abdc3b-deb8-432d-8b01-5f8cba4816ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b62730>]}
[0m17:17:28.491248 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.88s]
[0m17:17:28.491794 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:17:28.492522 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:17:28.492754 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:17:28.493025 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:17:28.493269 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:17:28.493887 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:17:28.494512 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:17:28.494665 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:17:28.494802 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:17:28.494960 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:17:28.495083 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:17:28.498723 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:17:28.501676 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:17:28.502313 [debug] [Thread-3  ]: finished collecting timing info
[0m17:17:28.502441 [debug] [Thread-4  ]: finished collecting timing info
[0m17:17:28.502584 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:17:28.502730 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:17:28.509180 [debug] [Thread-3  ]: finished collecting timing info
[0m17:17:28.510905 [debug] [Thread-4  ]: finished collecting timing info
[0m17:17:28.511358 [debug] [Thread-3  ]: Compilation Error in model fred_unemp (models/fred_unemp.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
  Searched for: default_globalx.fred_unemp
  Found: default_globalx.fred_unemp
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model fred_unemp (models/fred_unemp.sql)
[0m17:17:28.511737 [debug] [Thread-4  ]: Compilation Error in model polygon (models/polygon.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
  Searched for: default_globalx.polygon
  Found: default_globalx.polygon
  
  > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
  > called by model polygon (models/polygon.sql)
[0m17:17:28.511941 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7abdc3b-deb8-432d-8b01-5f8cba4816ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e959b20>]}
[0m17:17:28.512102 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7abdc3b-deb8-432d-8b01-5f8cba4816ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e959c10>]}
[0m17:17:28.512350 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model default_globalx.fred_unemp ............... [[31mERROR[0m in 0.02s]
[0m17:17:28.512584 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model default_globalx.polygon .................. [[31mERROR[0m in 0.02s]
[0m17:17:28.512897 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:17:28.513146 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:17:28.513557 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:17:28.513686 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:17:28.513945 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:17:28.514756 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:17:28.515108 [info ] [MainThread]: 
[0m17:17:28.515264 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m17:17:28.515409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:28.515486 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:17:28.515605 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:17:28.515679 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:17:28.521114 [info ] [MainThread]: 
[0m17:17:28.521351 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:17:28.521531 [info ] [MainThread]: 
[0m17:17:28.521663 [error] [MainThread]: [33mCompilation Error in model fred_unemp (models/fred_unemp.sql)[0m
[0m17:17:28.521789 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:17:28.521910 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.fred_unemp, or rename it to be less ambiguous.
[0m17:17:28.522028 [error] [MainThread]:   Searched for: default_globalx.fred_unemp
[0m17:17:28.522143 [error] [MainThread]:   Found: default_globalx.fred_unemp
[0m17:17:28.522257 [error] [MainThread]:   
[0m17:17:28.522367 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:17:28.522481 [error] [MainThread]:   > called by model fred_unemp (models/fred_unemp.sql)
[0m17:17:28.522596 [info ] [MainThread]: 
[0m17:17:28.522714 [error] [MainThread]: [33mCompilation Error in model polygon (models/polygon.sql)[0m
[0m17:17:28.522830 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:17:28.522944 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.polygon, or rename it to be less ambiguous.
[0m17:17:28.523058 [error] [MainThread]:   Searched for: default_globalx.polygon
[0m17:17:28.523171 [error] [MainThread]:   Found: default_globalx.polygon
[0m17:17:28.523287 [error] [MainThread]:   
[0m17:17:28.523400 [error] [MainThread]:   > in macro materialization_table_athena (macros/materializations/models/table/table.sql)
[0m17:17:28.523512 [error] [MainThread]:   > called by model polygon (models/polygon.sql)
[0m17:17:28.523633 [info ] [MainThread]: 
[0m17:17:28.523752 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m17:17:28.523927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a96370>]}
[0m17:17:28.524078 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:18:09.717395 | 1c8b8fc8-b073-458a-a231-a07aae836121 ==============================
[0m17:18:09.717420 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:18:09.718072 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:18:09.718183 [debug] [MainThread]: Tracking: tracking
[0m17:18:09.727604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed2490>]}
[0m17:18:09.768415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:09.768578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:09.772634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8b8fc8-b073-458a-a231-a07aae836121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104184d90>]}
[0m17:18:09.776662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8b8fc8-b073-458a-a231-a07aae836121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc8cd0>]}
[0m17:18:09.776838 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:18:09.777002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8b8fc8-b073-458a-a231-a07aae836121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101bf8af0>]}
[0m17:18:09.777760 [info ] [MainThread]: 
[0m17:18:09.778109 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:18:09.778677 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:18:09.786120 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:18:09.786283 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:18:09.786369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:11.323228 [debug] [ThreadPool]: SQL status: OK -1 in 1.54 seconds
[0m17:18:11.325998 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:18:11.328222 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:18:11.338016 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:18:11.338262 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:18:11.338408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:12.844651 [debug] [ThreadPool]: SQL status: OK -1 in 1.51 seconds
[0m17:18:12.848180 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:18:12.849507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8b8fc8-b073-458a-a231-a07aae836121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041aa7f0>]}
[0m17:18:12.850384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:18:12.850735 [info ] [MainThread]: 
[0m17:18:12.854481 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:18:12.854866 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:18:12.855589 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:18:12.857730 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:18:12.857959 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:18:12.865715 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:18:12.865975 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:18:12.866099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:18:14.336287 [debug] [Thread-1  ]: SQL status: OK -1 in 1.47 seconds
[0m17:18:14.340429 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:18:14.341559 [debug] [Thread-1  ]: finished collecting timing info
[0m17:18:14.341818 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:18:14.355448 [debug] [Thread-1  ]: finished collecting timing info
[0m17:18:14.355722 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:18:14.356251 [debug] [Thread-1  ]: Compilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
  Searched for: default_globalx.etl_integrated_etf_data
  Found: default_globalx.etl_integrated_etf_data
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:18:14.356508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b8fc8-b073-458a-a231-a07aae836121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b708eb0>]}
[0m17:18:14.356814 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model default_globalx.etl_integrated_etf_data ... [[31mERROR[0m in 1.50s]
[0m17:18:14.357175 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:18:14.357835 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:18:14.357990 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:18:14.358113 [info ] [Thread-3  ]: 2 of 4 SKIP relation default_globalx.fred_unemp ................................ [[33mSKIP[0m]
[0m17:18:14.358289 [info ] [Thread-4  ]: 3 of 4 SKIP relation default_globalx.polygon ................................... [[33mSKIP[0m]
[0m17:18:14.358585 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:18:14.358850 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:18:14.359190 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:18:14.359325 [info ] [Thread-1  ]: 4 of 4 SKIP relation default_globalx.extra_metrics ............................. [[33mSKIP[0m]
[0m17:18:14.359756 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:18:14.360755 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:18:14.361230 [info ] [MainThread]: 
[0m17:18:14.361438 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m17:18:14.361627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:14.361726 [debug] [MainThread]: Connection 'model.global_x_task.etl_integrated_etf_data' was properly closed.
[0m17:18:14.368314 [info ] [MainThread]: 
[0m17:18:14.368527 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:18:14.368706 [info ] [MainThread]: 
[0m17:18:14.368863 [error] [MainThread]: [33mCompilation Error in model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)[0m
[0m17:18:14.369017 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:18:14.369258 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.etl_integrated_etf_data, or rename it to be less ambiguous.
[0m17:18:14.369443 [error] [MainThread]:   Searched for: default_globalx.etl_integrated_etf_data
[0m17:18:14.369595 [error] [MainThread]:   Found: default_globalx.etl_integrated_etf_data
[0m17:18:14.369740 [error] [MainThread]:   
[0m17:18:14.369885 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m17:18:14.370027 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m17:18:14.370164 [error] [MainThread]:   > called by model etl_integrated_etf_data (models/etl_integrated_etf_data.sql)
[0m17:18:14.370319 [info ] [MainThread]: 
[0m17:18:14.370472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m17:18:14.370693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb8250>]}
[0m17:18:14.370886 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:18:18.688384 | f876f708-027e-4987-9c22-f8e814537cc7 ==============================
[0m17:18:18.688407 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:18:18.688823 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:18:18.688917 [debug] [MainThread]: Tracking: tracking
[0m17:18:18.697787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e24730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e122b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e12490>]}
[0m17:18:18.729863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:18.730033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:18.733987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc4d90>]}
[0m17:18:18.738040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0dcd0>]}
[0m17:18:18.738203 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:18:18.738358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102880af0>]}
[0m17:18:18.739085 [info ] [MainThread]: 
[0m17:18:18.739422 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:18:18.740046 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:18:18.747467 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:18:18.747634 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:18:18.747764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:20.238872 [debug] [ThreadPool]: SQL status: OK -1 in 1.49 seconds
[0m17:18:20.242917 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:18:20.245154 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:18:20.255002 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:18:20.255207 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:18:20.255360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:21.751100 [debug] [ThreadPool]: SQL status: OK -1 in 1.5 seconds
[0m17:18:21.754490 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:18:21.755799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fea7f0>]}
[0m17:18:21.756718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:18:21.757076 [info ] [MainThread]: 
[0m17:18:21.759383 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:18:21.759768 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:18:21.760469 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:18:21.762731 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:18:21.762959 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:18:21.770994 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:18:21.771203 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:18:21.771325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:18:23.235678 [debug] [Thread-1  ]: SQL status: OK -1 in 1.46 seconds
[0m17:18:23.239914 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:18:23.241093 [debug] [Thread-1  ]: finished collecting timing info
[0m17:18:23.241358 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:18:23.260955 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:18:23.261524 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:18:23.261664 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:18:24.592074 [debug] [Thread-1  ]: SQL status: OK -1 in 1.33 seconds
[0m17:18:24.603009 [debug] [Thread-1  ]: finished collecting timing info
[0m17:18:24.603369 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:18:24.604030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fed4f0>]}
[0m17:18:24.604462 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.84s]
[0m17:18:24.604975 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:18:24.605641 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:18:24.605853 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:18:24.606083 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:18:24.606285 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:18:24.606845 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:18:24.607341 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:18:24.607487 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:18:24.607620 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:18:24.607769 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:18:24.607895 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:18:24.611360 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:18:24.614111 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:18:24.614747 [debug] [Thread-3  ]: finished collecting timing info
[0m17:18:24.614884 [debug] [Thread-4  ]: finished collecting timing info
[0m17:18:24.615030 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:18:24.615224 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:18:24.630960 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m17:18:24.633802 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m17:18:24.634734 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:18:24.634860 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:18:24.634948 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m17:18:24.635036 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m17:18:24.635121 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:18:24.635226 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:18:27.188510 [debug] [Thread-3  ]: SQL status: OK 48 in 2.55 seconds
[0m17:18:27.191634 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:18:27.192180 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.56 seconds
[0m17:18:27.192283 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m17:18:27.193199 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:18:27.194266 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m17:18:28.477766 [debug] [Thread-4  ]: SQL status: OK -1 in 1.28 seconds
[0m17:18:28.478944 [debug] [Thread-4  ]: finished collecting timing info
[0m17:18:28.479093 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m17:18:28.479441 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f0df0>]}
[0m17:18:28.479662 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.87s]
[0m17:18:28.479933 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:18:28.496692 [debug] [Thread-3  ]: SQL status: OK -1 in 1.3 seconds
[0m17:18:28.497883 [debug] [Thread-3  ]: finished collecting timing info
[0m17:18:28.498118 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m17:18:28.498550 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7fa0>]}
[0m17:18:28.498781 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 3.89s]
[0m17:18:28.499046 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:18:28.499393 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:18:28.499631 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m17:18:28.500045 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m17:18:28.501263 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m17:18:28.501373 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m17:18:28.504000 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m17:18:28.504121 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m17:18:28.504198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:18:29.923967 [debug] [Thread-1  ]: SQL status: OK -1 in 1.42 seconds
[0m17:18:29.928706 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m17:18:29.930763 [debug] [Thread-1  ]: finished collecting timing info
[0m17:18:29.931053 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m17:18:29.934085 [debug] [Thread-1  ]: finished collecting timing info
[0m17:18:29.934344 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m17:18:29.934925 [debug] [Thread-1  ]: Compilation Error in model extra_metrics (models/extra_metrics.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.extra_metrics, or rename it to be less ambiguous.
  Searched for: default_globalx.extra_metrics
  Found: default_globalx.extra_metrics
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model extra_metrics (models/extra_metrics.sql)
[0m17:18:29.935214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f876f708-027e-4987-9c22-f8e814537cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202ee490>]}
[0m17:18:29.935597 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model default_globalx.extra_metrics ............. [[31mERROR[0m in 1.44s]
[0m17:18:29.936040 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:18:29.937502 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:18:29.938076 [info ] [MainThread]: 
[0m17:18:29.938352 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 11.20 seconds (11.20s).
[0m17:18:29.938605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:29.938744 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m17:18:29.938873 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:18:29.938998 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:18:29.951641 [info ] [MainThread]: 
[0m17:18:29.951965 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:18:29.952185 [info ] [MainThread]: 
[0m17:18:29.952375 [error] [MainThread]: [33mCompilation Error in model extra_metrics (models/extra_metrics.sql)[0m
[0m17:18:29.952550 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m17:18:29.952713 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.extra_metrics, or rename it to be less ambiguous.
[0m17:18:29.952872 [error] [MainThread]:   Searched for: default_globalx.extra_metrics
[0m17:18:29.953033 [error] [MainThread]:   Found: default_globalx.extra_metrics
[0m17:18:29.953195 [error] [MainThread]:   
[0m17:18:29.953357 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m17:18:29.953520 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m17:18:29.953915 [error] [MainThread]:   > called by model extra_metrics (models/extra_metrics.sql)
[0m17:18:29.954107 [info ] [MainThread]: 
[0m17:18:29.954272 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:18:29.954503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202c66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202bf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202f1730>]}
[0m17:18:29.954694 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:18:58.639213 | 35cbedab-0bcb-4d33-8726-7c2a22dafc1a ==============================
[0m17:18:58.639236 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:18:58.639657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:18:58.639797 [debug] [MainThread]: Tracking: tracking
[0m17:18:58.649045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f52b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f63850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f63040>]}
[0m17:18:58.680695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:58.680862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:58.684757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072fd0d0>]}
[0m17:18:58.688839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107249c40>]}
[0m17:18:58.688997 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:18:58.689150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf9ca0>]}
[0m17:18:58.689874 [info ] [MainThread]: 
[0m17:18:58.690216 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:18:58.690783 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:18:58.698359 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:18:58.698530 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:18:58.698615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:00.300730 [debug] [ThreadPool]: SQL status: OK -1 in 1.6 seconds
[0m17:19:00.304757 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:19:00.307031 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:19:00.317007 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:19:00.317212 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:19:00.317367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:01.933024 [debug] [ThreadPool]: SQL status: OK -1 in 1.62 seconds
[0m17:19:01.936300 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:19:01.937933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107329d60>]}
[0m17:19:01.938923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:19:01.939333 [info ] [MainThread]: 
[0m17:19:01.941743 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:19:01.942176 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:19:01.943091 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:19:01.945599 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:19:01.945833 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:19:01.953932 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:19:01.954309 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:19:01.954453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:03.522351 [debug] [Thread-1  ]: SQL status: OK -1 in 1.57 seconds
[0m17:19:03.526531 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:19:03.527675 [debug] [Thread-1  ]: finished collecting timing info
[0m17:19:03.527938 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:19:03.547369 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:19:03.547909 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:19:03.548043 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:19:04.898004 [debug] [Thread-1  ]: SQL status: OK -1 in 1.35 seconds
[0m17:19:04.908956 [debug] [Thread-1  ]: finished collecting timing info
[0m17:19:04.909317 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:19:04.909974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7d340>]}
[0m17:19:04.910398 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.97s]
[0m17:19:04.910902 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:19:04.911683 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:19:04.911899 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:19:04.912133 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:19:04.912414 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:19:04.913030 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:19:04.913539 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:19:04.913689 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:19:04.913918 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:19:04.914071 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:19:04.914194 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:19:04.917758 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:19:04.920695 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:19:04.921301 [debug] [Thread-3  ]: finished collecting timing info
[0m17:19:04.921430 [debug] [Thread-4  ]: finished collecting timing info
[0m17:19:04.921566 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:19:04.921695 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:19:04.936820 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m17:19:04.939388 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m17:19:04.939787 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:19:04.939897 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m17:19:04.940005 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:19:04.940084 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:19:04.940189 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m17:19:04.945056 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:19:07.637569 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.7 seconds
[0m17:19:07.638506 [debug] [Thread-3  ]: SQL status: OK 48 in 2.69 seconds
[0m17:19:07.642739 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:19:07.644222 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:19:07.644488 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m17:19:07.644644 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m17:19:09.016135 [debug] [Thread-3  ]: SQL status: OK -1 in 1.37 seconds
[0m17:19:09.017732 [debug] [Thread-4  ]: SQL status: OK -1 in 1.37 seconds
[0m17:19:09.021300 [debug] [Thread-3  ]: finished collecting timing info
[0m17:19:09.023495 [debug] [Thread-4  ]: finished collecting timing info
[0m17:19:09.023819 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m17:19:09.024017 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m17:19:09.024788 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117882d00>]}
[0m17:19:09.025322 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a92040>]}
[0m17:19:09.025752 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.11s]
[0m17:19:09.026083 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.11s]
[0m17:19:09.026585 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:19:09.026952 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:19:09.027803 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:19:09.028139 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m17:19:09.028766 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m17:19:09.031063 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m17:19:09.031252 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m17:19:09.036132 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m17:19:09.036438 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m17:19:09.036588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:10.587760 [debug] [Thread-1  ]: SQL status: OK -1 in 1.55 seconds
[0m17:19:10.591045 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m17:19:10.592207 [debug] [Thread-1  ]: finished collecting timing info
[0m17:19:10.592467 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m17:19:10.595905 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m17:19:10.596482 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m17:19:10.596651 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m17:19:11.915731 [debug] [Thread-1  ]: SQL status: OK -1 in 1.32 seconds
[0m17:19:11.919910 [debug] [Thread-1  ]: finished collecting timing info
[0m17:19:11.920381 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m17:19:11.921148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cbedab-0bcb-4d33-8726-7c2a22dafc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12294be80>]}
[0m17:19:11.921628 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.89s]
[0m17:19:11.922195 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:19:11.923986 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:19:11.924673 [info ] [MainThread]: 
[0m17:19:11.924971 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m17:19:11.925232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:11.925375 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m17:19:11.925509 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:19:11.925636 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:19:11.938625 [info ] [MainThread]: 
[0m17:19:11.938943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:11.939174 [info ] [MainThread]: 
[0m17:19:11.939356 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:19:11.939599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b26100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116adad90>]}
[0m17:19:11.939792 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:46:23.073012 | b809dc9a-5a74-4b07-811a-f05bc2fa9491 ==============================
[0m17:46:23.073030 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:46:23.073769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:46:23.073877 [debug] [MainThread]: Tracking: tracking
[0m17:46:23.085508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069badf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ba4f0>]}
[0m17:46:23.125263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:23.125422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:23.129415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b720d0>]}
[0m17:46:23.133754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab9d60>]}
[0m17:46:23.133944 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:46:23.134096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab9df0>]}
[0m17:46:23.134834 [info ] [MainThread]: 
[0m17:46:23.135175 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:46:23.135714 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:46:23.143045 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:46:23.143189 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:46:23.143269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:24.780155 [debug] [ThreadPool]: SQL status: OK -1 in 1.64 seconds
[0m17:46:24.782931 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:46:24.785262 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:46:24.793901 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:46:24.794186 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:46:24.794324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:27.401257 [debug] [ThreadPool]: SQL status: OK -1 in 2.61 seconds
[0m17:46:27.403435 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:46:27.404369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9e790>]}
[0m17:46:27.405103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:46:27.405403 [info ] [MainThread]: 
[0m17:46:27.409545 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:46:27.409909 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:46:27.410507 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:46:27.412647 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:46:27.412932 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:46:27.420038 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:46:27.420241 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:46:27.420398 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:46:28.972810 [debug] [Thread-1  ]: SQL status: OK -1 in 1.55 seconds
[0m17:46:28.974442 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:46:28.975156 [debug] [Thread-1  ]: finished collecting timing info
[0m17:46:28.975284 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:46:28.985916 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:46:28.986313 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:46:28.986415 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:46:30.292626 [debug] [Thread-1  ]: SQL status: OK -1 in 1.31 seconds
[0m17:46:30.297755 [debug] [Thread-1  ]: finished collecting timing info
[0m17:46:30.297942 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:46:30.298308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c00190>]}
[0m17:46:30.298550 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.89s]
[0m17:46:30.298826 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:46:30.299219 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:46:30.299346 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:46:30.299499 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:46:30.299712 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:46:30.300126 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:46:30.300481 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:46:30.300583 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:46:30.300674 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:46:30.300770 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:46:30.300854 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:46:30.303151 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:46:30.305186 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:46:30.306605 [debug] [Thread-3  ]: finished collecting timing info
[0m17:46:30.306715 [debug] [Thread-4  ]: finished collecting timing info
[0m17:46:30.306807 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:46:30.306911 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:46:30.318811 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m17:46:30.321106 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m17:46:30.321521 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:46:30.321625 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:46:30.321700 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m17:46:30.321785 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m17:46:30.321865 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:46:30.321943 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:46:33.167607 [debug] [Thread-3  ]: SQL status: OK 48 in 2.85 seconds
[0m17:46:33.169527 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.85 seconds
[0m17:46:33.174747 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:46:33.176203 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:46:33.176449 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m17:46:33.176619 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m17:46:34.502344 [debug] [Thread-4  ]: SQL status: OK -1 in 1.32 seconds
[0m17:46:34.506111 [debug] [Thread-4  ]: finished collecting timing info
[0m17:46:34.506940 [debug] [Thread-3  ]: SQL status: OK -1 in 1.33 seconds
[0m17:46:34.507413 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m17:46:34.509400 [debug] [Thread-3  ]: finished collecting timing info
[0m17:46:34.510215 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c644040>]}
[0m17:46:34.510419 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m17:46:34.510836 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.21s]
[0m17:46:34.511393 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c657df0>]}
[0m17:46:34.511885 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:46:34.512202 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 4.21s]
[0m17:46:34.512841 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:46:34.513497 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:46:34.513756 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m17:46:34.514508 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m17:46:34.516882 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m17:46:34.517056 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m17:46:34.521885 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m17:46:34.522175 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m17:46:34.522305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:46:36.064481 [debug] [Thread-1  ]: SQL status: OK -1 in 1.54 seconds
[0m17:46:36.067265 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m17:46:36.069666 [debug] [Thread-1  ]: finished collecting timing info
[0m17:46:36.069892 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m17:46:36.073283 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m17:46:36.073829 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m17:46:36.073999 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m17:46:37.437883 [debug] [Thread-1  ]: SQL status: OK -1 in 1.36 seconds
[0m17:46:37.440719 [debug] [Thread-1  ]: finished collecting timing info
[0m17:46:37.441059 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m17:46:37.441735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b809dc9a-5a74-4b07-811a-f05bc2fa9491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec0bf40>]}
[0m17:46:37.442183 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.93s]
[0m17:46:37.442678 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:46:37.444541 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:46:37.445224 [info ] [MainThread]: 
[0m17:46:37.445536 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 14.31 seconds (14.31s).
[0m17:46:37.445798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:37.445939 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m17:46:37.446073 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:46:37.446203 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:46:37.459993 [info ] [MainThread]: 
[0m17:46:37.460274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:37.460500 [info ] [MainThread]: 
[0m17:46:37.460685 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:46:37.460906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6d5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab98b0>]}
[0m17:46:37.461080 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 17:55:48.034630 | eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce ==============================
[0m17:55:48.034648 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:55:48.035669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:55:48.035814 [debug] [MainThread]: Tracking: tracking
[0m17:55:48.048092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c98e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c98df0>]}
[0m17:55:48.093855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:48.094027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:48.098326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f83df0>]}
[0m17:55:48.103215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d95ca0>]}
[0m17:55:48.103407 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:55:48.103565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b35ee0>]}
[0m17:55:48.104355 [info ] [MainThread]: 
[0m17:55:48.104722 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:55:48.105322 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m17:55:48.113136 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m17:55:48.113305 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m17:55:48.113459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:49.685802 [debug] [ThreadPool]: SQL status: OK -1 in 1.57 seconds
[0m17:55:49.689649 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:55:49.691957 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m17:55:49.702106 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m17:55:49.702342 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m17:55:49.702492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:51.248773 [debug] [ThreadPool]: SQL status: OK -1 in 1.55 seconds
[0m17:55:51.252617 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m17:55:51.253941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104faadc0>]}
[0m17:55:51.254911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:55:51.255310 [info ] [MainThread]: 
[0m17:55:51.258236 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m17:55:51.258582 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m17:55:51.259257 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:55:51.261498 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m17:55:51.261721 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m17:55:51.269962 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:55:51.270141 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m17:55:51.270254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:55:52.763829 [debug] [Thread-1  ]: SQL status: OK -1 in 1.49 seconds
[0m17:55:52.767835 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m17:55:52.768961 [debug] [Thread-1  ]: finished collecting timing info
[0m17:55:52.769236 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m17:55:52.789317 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m17:55:52.789893 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m17:55:52.790034 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m17:55:54.143659 [debug] [Thread-1  ]: SQL status: OK -1 in 1.35 seconds
[0m17:55:54.152066 [debug] [Thread-1  ]: finished collecting timing info
[0m17:55:54.152344 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m17:55:54.153076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500a520>]}
[0m17:55:54.153528 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.89s]
[0m17:55:54.154212 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m17:55:54.155006 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m17:55:54.155220 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m17:55:54.155486 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m17:55:54.155765 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m17:55:54.156532 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m17:55:54.157248 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m17:55:54.157494 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m17:55:54.157647 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m17:55:54.157794 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m17:55:54.157965 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m17:55:54.161016 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m17:55:54.163497 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m17:55:54.163999 [debug] [Thread-3  ]: finished collecting timing info
[0m17:55:54.164130 [debug] [Thread-4  ]: finished collecting timing info
[0m17:55:54.164247 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m17:55:54.164361 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m17:55:54.185947 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m17:55:54.186228 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m17:55:54.186954 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:55:54.187097 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:55:54.187263 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m17:55:54.187386 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m17:55:54.187543 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:55:54.187743 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:55:56.835373 [debug] [Thread-3  ]: SQL status: OK 48 in 2.65 seconds
[0m17:55:56.839493 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m17:55:56.839777 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m17:55:56.840705 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.65 seconds
[0m17:55:56.842914 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m17:55:56.843099 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m17:55:58.164589 [debug] [Thread-4  ]: SQL status: OK -1 in 1.32 seconds
[0m17:55:58.166007 [debug] [Thread-4  ]: finished collecting timing info
[0m17:55:58.166239 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m17:55:58.166837 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b7eb0>]}
[0m17:55:58.167138 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.01s]
[0m17:55:58.167467 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m17:55:59.189065 [debug] [Thread-3  ]: SQL status: OK -1 in 2.35 seconds
[0m17:55:59.190301 [debug] [Thread-3  ]: finished collecting timing info
[0m17:55:59.190483 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m17:55:59.190846 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509eeb0>]}
[0m17:55:59.191064 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 5.03s]
[0m17:55:59.191368 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m17:55:59.191812 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m17:55:59.192136 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m17:55:59.192690 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m17:55:59.193805 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m17:55:59.193922 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m17:55:59.196636 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m17:55:59.196736 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m17:55:59.196810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:56:00.666319 [debug] [Thread-1  ]: SQL status: OK -1 in 1.47 seconds
[0m17:56:00.667575 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m17:56:00.667922 [debug] [Thread-1  ]: finished collecting timing info
[0m17:56:00.668033 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m17:56:00.669676 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m17:56:00.669927 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m17:56:00.670012 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m17:56:02.064849 [debug] [Thread-1  ]: SQL status: OK -1 in 1.39 seconds
[0m17:56:02.068729 [debug] [Thread-1  ]: finished collecting timing info
[0m17:56:02.069154 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m17:56:02.069961 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa96a21-d47a-42c3-a4b1-b0e88b3d47ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108657b20>]}
[0m17:56:02.070498 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.88s]
[0m17:56:02.071073 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m17:56:02.072783 [debug] [MainThread]: Acquiring new athena connection "master"
[0m17:56:02.073454 [info ] [MainThread]: 
[0m17:56:02.073762 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 13.97 seconds (13.97s).
[0m17:56:02.074031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:02.074175 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m17:56:02.074309 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m17:56:02.074441 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m17:56:02.086485 [info ] [MainThread]: 
[0m17:56:02.086786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:02.087018 [info ] [MainThread]: 
[0m17:56:02.087198 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:56:02.087451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f04280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d95580>]}
[0m17:56:02.087707 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 18:05:34.696950 | 6c40ac5f-1f7e-4ec2-bb5a-0341269479d3 ==============================
[0m18:05:34.696968 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:05:34.697691 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:05:34.697790 [debug] [MainThread]: Tracking: tracking
[0m18:05:34.709739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880250>]}
[0m18:05:34.750861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:34.751151 [debug] [MainThread]: Partial parsing: updated file: global_x_task://models/extra_metrics.sql
[0m18:05:34.758995 [debug] [MainThread]: 1603: static parser failed on extra_metrics.sql
[0m18:05:34.772196 [debug] [MainThread]: 1602: parser fallback to jinja rendering on extra_metrics.sql
[0m18:05:34.782866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a078e0>]}
[0m18:05:34.786887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106961f40>]}
[0m18:05:34.787039 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:05:34.787188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068622e0>]}
[0m18:05:34.787883 [info ] [MainThread]: 
[0m18:05:34.788207 [debug] [MainThread]: Acquiring new athena connection "master"
[0m18:05:34.788762 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m18:05:34.793082 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m18:05:34.793198 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m18:05:34.793292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:36.329291 [debug] [ThreadPool]: SQL status: OK -1 in 1.54 seconds
[0m18:05:36.332559 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:05:36.334796 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m18:05:36.345181 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m18:05:36.345408 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m18:05:36.345650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:37.857631 [debug] [ThreadPool]: SQL status: OK -1 in 1.51 seconds
[0m18:05:37.858644 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m18:05:37.859131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a88220>]}
[0m18:05:37.859470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:37.859621 [info ] [MainThread]: 
[0m18:05:37.861747 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m18:05:37.861920 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m18:05:37.862254 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m18:05:37.863267 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m18:05:37.863366 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m18:05:37.903461 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m18:05:37.903662 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m18:05:37.903744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:39.445719 [debug] [Thread-1  ]: SQL status: OK -1 in 1.54 seconds
[0m18:05:39.449970 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m18:05:39.451158 [debug] [Thread-1  ]: finished collecting timing info
[0m18:05:39.451453 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m18:05:39.470965 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m18:05:39.471555 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m18:05:39.471690 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m18:05:40.839809 [debug] [Thread-1  ]: SQL status: OK -1 in 1.37 seconds
[0m18:05:40.850882 [debug] [Thread-1  ]: finished collecting timing info
[0m18:05:40.851194 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m18:05:40.851804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a93fd0>]}
[0m18:05:40.852183 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.99s]
[0m18:05:40.852640 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m18:05:40.853264 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m18:05:40.853494 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m18:05:40.853821 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m18:05:40.854121 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m18:05:40.854799 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m18:05:40.855395 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m18:05:40.855559 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m18:05:40.855712 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m18:05:40.855871 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m18:05:40.855993 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m18:05:40.858659 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m18:05:40.861198 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m18:05:40.861948 [debug] [Thread-3  ]: finished collecting timing info
[0m18:05:40.862093 [debug] [Thread-4  ]: finished collecting timing info
[0m18:05:40.862249 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m18:05:40.862381 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m18:05:40.878397 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m18:05:40.881162 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m18:05:40.881661 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m18:05:40.881777 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m18:05:40.881876 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m18:05:40.881975 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m18:05:40.882065 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:05:40.882154 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:05:42.462354 [debug] [Thread-4  ]: SQL status: OK 1506 in 1.58 seconds
[0m18:05:42.466657 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m18:05:42.466916 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m18:05:43.465073 [debug] [Thread-3  ]: SQL status: OK 48 in 2.58 seconds
[0m18:05:43.467937 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m18:05:43.468378 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m18:05:43.925652 [debug] [Thread-4  ]: SQL status: OK -1 in 1.46 seconds
[0m18:05:43.930736 [debug] [Thread-4  ]: finished collecting timing info
[0m18:05:43.931179 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m18:05:43.931953 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a87df0>]}
[0m18:05:43.932445 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.08s]
[0m18:05:43.933048 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m18:05:44.831180 [debug] [Thread-3  ]: SQL status: OK -1 in 1.36 seconds
[0m18:05:44.835773 [debug] [Thread-3  ]: finished collecting timing info
[0m18:05:44.836258 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m18:05:44.836930 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc3eb0>]}
[0m18:05:44.837352 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 3.98s]
[0m18:05:44.837857 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m18:05:44.838594 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m18:05:44.838862 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m18:05:44.839500 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m18:05:44.841529 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m18:05:44.841726 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m18:05:44.846703 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m18:05:44.846975 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m18:05:44.847111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:46.283447 [debug] [Thread-1  ]: SQL status: OK -1 in 1.44 seconds
[0m18:05:46.288153 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m18:05:46.290549 [debug] [Thread-1  ]: finished collecting timing info
[0m18:05:46.290810 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m18:05:46.294546 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m18:05:46.295063 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m18:05:46.295229 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m18:05:47.642555 [debug] [Thread-1  ]: SQL status: OK -1 in 1.35 seconds
[0m18:05:47.647732 [debug] [Thread-1  ]: finished collecting timing info
[0m18:05:47.648184 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m18:05:47.648966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c40ac5f-1f7e-4ec2-bb5a-0341269479d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd86400>]}
[0m18:05:47.649452 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.81s]
[0m18:05:47.650032 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m18:05:47.651795 [debug] [MainThread]: Acquiring new athena connection "master"
[0m18:05:47.652501 [info ] [MainThread]: 
[0m18:05:47.652775 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 12.86 seconds (12.86s).
[0m18:05:47.653028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:47.653164 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m18:05:47.653292 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m18:05:47.653417 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m18:05:47.666801 [info ] [MainThread]: 
[0m18:05:47.667115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:47.667344 [info ] [MainThread]: 
[0m18:05:47.667520 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:05:47.667764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea14fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdead60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdead90>]}
[0m18:05:47.667953 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 18:07:50.967258 | 0078926c-a596-4f30-bbca-0e8120863040 ==============================
[0m18:07:50.967273 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:07:50.967784 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:07:50.967881 [debug] [MainThread]: Tracking: tracking
[0m18:07:50.977840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bccb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be8df0>]}
[0m18:07:51.008662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:07:51.008804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:07:51.012723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d87df0>]}
[0m18:07:51.016778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cccca0>]}
[0m18:07:51.016942 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:07:51.017091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c71ee0>]}
[0m18:07:51.017809 [info ] [MainThread]: 
[0m18:07:51.018148 [debug] [MainThread]: Acquiring new athena connection "master"
[0m18:07:51.018745 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m18:07:51.026194 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m18:07:51.026317 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m18:07:51.026399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:52.536424 [debug] [ThreadPool]: SQL status: OK -1 in 1.51 seconds
[0m18:07:52.539136 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:07:52.540691 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m18:07:52.547047 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m18:07:52.547195 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m18:07:52.547307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:54.072290 [debug] [ThreadPool]: SQL status: OK -1 in 1.52 seconds
[0m18:07:54.074039 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m18:07:54.074941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daedc0>]}
[0m18:07:54.075580 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:07:54.075822 [info ] [MainThread]: 
[0m18:07:54.078634 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m18:07:54.078934 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m18:07:54.079415 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m18:07:54.081090 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m18:07:54.081303 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m18:07:54.087021 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m18:07:54.087191 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m18:07:54.087297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:55.642101 [debug] [Thread-1  ]: SQL status: OK -1 in 1.55 seconds
[0m18:07:55.647043 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m18:07:55.648169 [debug] [Thread-1  ]: finished collecting timing info
[0m18:07:55.648429 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m18:07:55.667935 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m18:07:55.668455 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m18:07:55.668587 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m18:07:57.096073 [debug] [Thread-1  ]: SQL status: OK -1 in 1.43 seconds
[0m18:07:57.107389 [debug] [Thread-1  ]: finished collecting timing info
[0m18:07:57.107788 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m18:07:57.108425 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc3f70>]}
[0m18:07:57.108837 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.03s]
[0m18:07:57.109286 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m18:07:57.109912 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m18:07:57.110103 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m18:07:57.110367 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m18:07:57.110614 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m18:07:57.111204 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m18:07:57.111722 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m18:07:57.111870 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m18:07:57.112006 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m18:07:57.112161 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m18:07:57.112284 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m18:07:57.115683 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m18:07:57.118486 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m18:07:57.119086 [debug] [Thread-4  ]: finished collecting timing info
[0m18:07:57.119230 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:57.119341 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m18:07:57.119620 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m18:07:57.134854 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m18:07:57.137599 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m18:07:57.138022 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m18:07:57.138116 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m18:07:57.138205 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m18:07:57.138314 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:07:57.138407 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m18:07:57.143207 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:07:58.697459 [debug] [Thread-3  ]: SQL status: OK 48 in 1.55 seconds
[0m18:07:58.700067 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m18:07:58.700201 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m18:07:58.707225 [debug] [Thread-4  ]: SQL status: OK 1506 in 1.57 seconds
[0m18:07:58.708053 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m18:07:58.708189 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m18:08:00.131361 [debug] [Thread-3  ]: SQL status: OK -1 in 1.43 seconds
[0m18:08:00.136423 [debug] [Thread-3  ]: finished collecting timing info
[0m18:08:00.136882 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m18:08:00.137700 [debug] [Thread-4  ]: SQL status: OK -1 in 1.43 seconds
[0m18:08:00.138587 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f3400>]}
[0m18:08:00.140722 [debug] [Thread-4  ]: finished collecting timing info
[0m18:08:00.141277 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 3.03s]
[0m18:08:00.141503 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m18:08:00.142046 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m18:08:00.142559 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4fdeb0>]}
[0m18:08:00.143163 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.03s]
[0m18:08:00.143544 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m18:08:00.144129 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m18:08:00.144476 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m18:08:00.145092 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m18:08:00.147284 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m18:08:00.147455 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m18:08:00.152153 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m18:08:00.152397 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m18:08:00.152528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:01.681244 [debug] [Thread-1  ]: SQL status: OK -1 in 1.53 seconds
[0m18:08:01.684174 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m18:08:01.684558 [debug] [Thread-1  ]: finished collecting timing info
[0m18:08:01.684658 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m18:08:01.686183 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m18:08:01.686460 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m18:08:01.686540 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m18:08:03.022027 [debug] [Thread-1  ]: SQL status: OK -1 in 1.34 seconds
[0m18:08:03.026698 [debug] [Thread-1  ]: finished collecting timing info
[0m18:08:03.027150 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m18:08:03.027932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0078926c-a596-4f30-bbca-0e8120863040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ae520>]}
[0m18:08:03.028437 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.88s]
[0m18:08:03.029012 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m18:08:03.030725 [debug] [MainThread]: Acquiring new athena connection "master"
[0m18:08:03.031381 [info ] [MainThread]: 
[0m18:08:03.031656 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m18:08:03.031908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:03.032046 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m18:08:03.032174 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m18:08:03.032297 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m18:08:03.045274 [info ] [MainThread]: 
[0m18:08:03.045531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:03.045749 [info ] [MainThread]: 
[0m18:08:03.045926 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:08:03.046171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ae550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9aebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cccaf0>]}
[0m18:08:03.046362 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 19:27:40.188710 | dafac485-1dca-4176-a9f4-75c407208212 ==============================
[0m19:27:40.188727 [info ] [MainThread]: Running with dbt=1.3.0
[0m19:27:40.189541 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:27:40.189646 [debug] [MainThread]: Tracking: tracking
[0m19:27:40.202069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e387f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1a4f0>]}
[0m19:27:40.243180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:40.243343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:40.247431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd30d0>]}
[0m19:27:40.251701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1cd60>]}
[0m19:27:40.251862 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:27:40.252017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1cdf0>]}
[0m19:27:40.252766 [info ] [MainThread]: 
[0m19:27:40.253102 [debug] [MainThread]: Acquiring new athena connection "master"
[0m19:27:40.253661 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m19:27:40.261160 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m19:27:40.261328 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m19:27:40.261415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:41.777026 [debug] [ThreadPool]: SQL status: OK -1 in 1.52 seconds
[0m19:27:41.780502 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:27:41.782688 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m19:27:41.791982 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m19:27:41.792200 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m19:27:41.792346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:43.236123 [debug] [ThreadPool]: SQL status: OK -1 in 1.44 seconds
[0m19:27:43.237090 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m19:27:43.237536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fff790>]}
[0m19:27:43.237870 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:27:43.238022 [info ] [MainThread]: 
[0m19:27:43.239230 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m19:27:43.239423 [info ] [Thread-1  ]: 1 of 4 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m19:27:43.239779 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m19:27:43.240753 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m19:27:43.240856 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m19:27:43.245031 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m19:27:43.245177 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m19:27:43.245258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:44.720651 [debug] [Thread-1  ]: SQL status: OK -1 in 1.48 seconds
[0m19:27:44.724673 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m19:27:44.727334 [debug] [Thread-1  ]: finished collecting timing info
[0m19:27:44.727557 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m19:27:44.746419 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m19:27:44.746965 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m19:27:44.747099 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m19:27:46.084930 [debug] [Thread-1  ]: SQL status: OK -1 in 1.34 seconds
[0m19:27:46.094586 [debug] [Thread-1  ]: finished collecting timing info
[0m19:27:46.094892 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m19:27:46.095501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040603a0>]}
[0m19:27:46.095968 [info ] [Thread-1  ]: 1 of 4 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.86s]
[0m19:27:46.096488 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m19:27:46.097212 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m19:27:46.097473 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m19:27:46.097655 [info ] [Thread-3  ]: 2 of 4 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m19:27:46.097866 [info ] [Thread-4  ]: 3 of 4 START sql table model default_globalx.polygon ........................... [RUN]
[0m19:27:46.098422 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m19:27:46.098900 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m19:27:46.099049 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m19:27:46.099183 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m19:27:46.099334 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m19:27:46.099456 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m19:27:46.103014 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m19:27:46.106069 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m19:27:46.107901 [debug] [Thread-4  ]: finished collecting timing info
[0m19:27:46.108084 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m19:27:46.108217 [debug] [Thread-3  ]: finished collecting timing info
[0m19:27:46.123139 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m19:27:46.123334 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m19:27:46.125993 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m19:27:46.126258 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m19:27:46.126395 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m19:27:46.126531 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m19:27:46.126613 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:27:46.126728 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m19:27:46.131608 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:27:47.644365 [debug] [Thread-3  ]: SQL status: OK 48 in 1.51 seconds
[0m19:27:47.646953 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m19:27:47.647111 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m19:27:48.683150 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.56 seconds
[0m19:27:48.687734 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m19:27:48.688158 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m19:27:48.947019 [debug] [Thread-3  ]: SQL status: OK -1 in 1.3 seconds
[0m19:27:48.948366 [debug] [Thread-3  ]: finished collecting timing info
[0m19:27:48.948543 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m19:27:48.948899 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a291070>]}
[0m19:27:48.949133 [info ] [Thread-3  ]: 2 of 4 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 2.85s]
[0m19:27:48.949405 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m19:27:49.974929 [debug] [Thread-4  ]: SQL status: OK -1 in 1.29 seconds
[0m19:27:49.977714 [debug] [Thread-4  ]: finished collecting timing info
[0m19:27:49.978047 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m19:27:49.978705 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a282b20>]}
[0m19:27:49.979132 [info ] [Thread-4  ]: 3 of 4 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.88s]
[0m19:27:49.979636 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m19:27:49.980397 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m19:27:49.980648 [info ] [Thread-1  ]: 4 of 4 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m19:27:49.981269 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m19:27:49.983644 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m19:27:49.983816 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m19:27:49.988458 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m19:27:49.988822 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m19:27:49.988956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:51.459945 [debug] [Thread-1  ]: SQL status: OK -1 in 1.47 seconds
[0m19:27:51.464505 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m19:27:51.466316 [debug] [Thread-1  ]: finished collecting timing info
[0m19:27:51.466627 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m19:27:51.470249 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m19:27:51.471185 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m19:27:51.471395 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m19:27:52.797189 [debug] [Thread-1  ]: SQL status: OK -1 in 1.33 seconds
[0m19:27:52.800279 [debug] [Thread-1  ]: finished collecting timing info
[0m19:27:52.800483 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m19:27:52.800837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dafac485-1dca-4176-a9f4-75c407208212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d7700>]}
[0m19:27:52.801043 [info ] [Thread-1  ]: 4 of 4 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.82s]
[0m19:27:52.801269 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m19:27:52.801978 [debug] [MainThread]: Acquiring new athena connection "master"
[0m19:27:52.802268 [info ] [MainThread]: 
[0m19:27:52.802405 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 12.55 seconds (12.55s).
[0m19:27:52.802527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:52.802602 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m19:27:52.802709 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m19:27:52.802771 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m19:27:52.809345 [info ] [MainThread]: 
[0m19:27:52.809530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:52.809677 [info ] [MainThread]: 
[0m19:27:52.809794 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:27:52.809952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a378e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a378f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d44e130>]}
[0m19:27:52.810084 [debug] [MainThread]: Flushing usage events


============================== 2024-06-06 20:25:02.774742 | 22b04199-e284-41ea-8864-8cb30a9b14c3 ==============================
[0m20:25:02.774769 [info ] [MainThread]: Running with dbt=1.3.0
[0m20:25:02.775408 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:25:02.775517 [debug] [MainThread]: Tracking: tracking
[0m20:25:02.796446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cde640>]}
[0m20:25:02.816783 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:25:02.817004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfd820>]}
[0m20:25:02.837253 [debug] [MainThread]: Parsing macros/drop_view.sql
[0m20:25:02.837934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:25:02.838918 [debug] [MainThread]: Parsing macros/materializations/models/helpers.sql
[0m20:25:02.839492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m20:25:02.843935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:25:02.849295 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:25:02.850791 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:25:02.853068 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:25:02.853635 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:25:02.855603 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:25:02.855887 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:25:02.857976 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:25:02.858601 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:25:02.858812 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:25:02.863174 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:25:02.864002 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:25:02.866007 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:25:02.867273 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:25:02.868145 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:25:02.876818 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:25:02.884562 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:25:02.891378 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:25:02.893775 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:25:02.894726 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:25:02.895667 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:25:02.899965 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:25:02.908805 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:25:02.909611 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m20:25:02.913200 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:25:02.918860 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:25:02.928382 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:25:02.931327 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:25:02.933173 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:25:02.936113 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:25:02.936787 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:25:02.938568 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:25:02.939750 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:25:02.943514 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:25:02.953762 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:25:02.954552 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:25:02.955855 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:25:02.956671 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:25:02.957152 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:25:02.957572 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:25:02.957929 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:25:02.958640 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:25:02.961453 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:25:02.965978 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:25:02.966404 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:25:02.967051 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:25:02.967556 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:25:02.968044 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:25:02.968692 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:25:02.969112 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:25:02.969659 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:25:02.970474 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:25:02.971700 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:25:02.972339 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:25:02.972906 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:25:02.973456 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:25:02.973994 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:25:02.974477 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:25:02.975040 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:25:02.975529 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:25:02.979087 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m20:25:02.979672 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:25:02.980156 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:25:02.981101 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:25:02.982284 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:25:02.982825 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m20:25:02.983615 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m20:25:02.984167 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:25:02.985284 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m20:25:02.987004 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:25:02.988463 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:25:02.996476 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:25:02.997511 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:25:03.004772 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:25:03.007093 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:25:03.010897 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:25:03.016175 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m20:25:03.019488 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:25:03.147632 [debug] [MainThread]: 1603: static parser failed on fred_unemp.sql
[0m20:25:03.155956 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fred_unemp.sql
[0m20:25:03.157995 [debug] [MainThread]: 1699: static parser successfully parsed group_by_date.sql
[0m20:25:03.159408 [debug] [MainThread]: 1603: static parser failed on etl_integrated_etf_data.sql
[0m20:25:03.166757 [debug] [MainThread]: 1602: parser fallback to jinja rendering on etl_integrated_etf_data.sql
[0m20:25:03.167551 [debug] [MainThread]: 1699: static parser successfully parsed group_by_stock.sql
[0m20:25:03.169080 [debug] [MainThread]: 1603: static parser failed on extra_metrics.sql
[0m20:25:03.171965 [debug] [MainThread]: 1602: parser fallback to jinja rendering on extra_metrics.sql
[0m20:25:03.172689 [debug] [MainThread]: 1603: static parser failed on polygon.sql
[0m20:25:03.175884 [debug] [MainThread]: 1602: parser fallback to jinja rendering on polygon.sql
[0m20:25:03.210517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5deb0>]}
[0m20:25:03.215315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfd610>]}
[0m20:25:03.215477 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:25:03.215620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce4520>]}
[0m20:25:03.216361 [info ] [MainThread]: 
[0m20:25:03.216692 [debug] [MainThread]: Acquiring new athena connection "master"
[0m20:25:03.217299 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m20:25:03.221599 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m20:25:03.221723 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m20:25:03.221820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:04.777816 [debug] [ThreadPool]: SQL status: OK -1 in 1.56 seconds
[0m20:25:04.779936 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m20:25:04.781901 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m20:25:04.790992 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m20:25:04.791186 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m20:25:04.791328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:06.273534 [debug] [ThreadPool]: SQL status: OK -1 in 1.48 seconds
[0m20:25:06.277397 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m20:25:06.278627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5ebe0>]}
[0m20:25:06.279553 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:06.279936 [info ] [MainThread]: 
[0m20:25:06.283960 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m20:25:06.284301 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m20:25:06.284967 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m20:25:06.287074 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m20:25:06.287270 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m20:25:06.291689 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m20:25:06.291874 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m20:25:06.292006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:07.712028 [debug] [Thread-1  ]: SQL status: OK -1 in 1.42 seconds
[0m20:25:07.714367 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m20:25:07.716673 [debug] [Thread-1  ]: finished collecting timing info
[0m20:25:07.716863 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m20:25:07.732625 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m20:25:07.732997 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m20:25:07.733109 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m20:25:09.363215 [debug] [Thread-1  ]: SQL status: OK -1 in 1.63 seconds
[0m20:25:09.374585 [debug] [Thread-1  ]: finished collecting timing info
[0m20:25:09.374966 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m20:25:09.375667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1bbbe0>]}
[0m20:25:09.376123 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.09s]
[0m20:25:09.376655 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m20:25:09.377296 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m20:25:09.377541 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m20:25:09.377723 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m20:25:09.377969 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m20:25:09.378583 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m20:25:09.379113 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m20:25:09.379264 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m20:25:09.379396 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m20:25:09.379555 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m20:25:09.379683 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m20:25:09.383251 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m20:25:09.386027 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m20:25:09.387888 [debug] [Thread-3  ]: finished collecting timing info
[0m20:25:09.388023 [debug] [Thread-4  ]: finished collecting timing info
[0m20:25:09.388128 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m20:25:09.388256 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m20:25:09.404367 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m20:25:09.407055 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m20:25:09.407504 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m20:25:09.407609 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m20:25:09.407702 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m20:25:09.407788 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m20:25:09.407869 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:25:09.407950 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:25:11.965017 [debug] [Thread-3  ]: SQL status: OK 48 in 2.56 seconds
[0m20:25:11.969166 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m20:25:11.969434 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m20:25:11.978337 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.57 seconds
[0m20:25:11.979590 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m20:25:11.979752 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m20:25:13.292181 [debug] [Thread-4  ]: SQL status: OK -1 in 1.31 seconds
[0m20:25:13.293585 [debug] [Thread-3  ]: SQL status: OK -1 in 1.32 seconds
[0m20:25:13.296653 [debug] [Thread-4  ]: finished collecting timing info
[0m20:25:13.298914 [debug] [Thread-3  ]: finished collecting timing info
[0m20:25:13.299310 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m20:25:13.299550 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m20:25:13.300330 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1448e0>]}
[0m20:25:13.300953 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f2b80>]}
[0m20:25:13.301388 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.92s]
[0m20:25:13.301721 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 48[0m in 3.92s]
[0m20:25:13.302218 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m20:25:13.302585 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m20:25:13.303435 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m20:25:13.303705 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m20:25:13.303920 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m20:25:13.304061 [debug] [Thread-4  ]: Began running node model.global_x_task.group_by_stock
[0m20:25:13.304308 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m20:25:13.304976 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m20:25:13.305212 [info ] [Thread-4  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m20:25:13.305808 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m20:25:13.306681 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m20:25:13.308376 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m20:25:13.308541 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m20:25:13.310568 [debug] [Thread-4  ]: Began compiling node model.global_x_task.group_by_stock
[0m20:25:13.310703 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m20:25:13.310840 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m20:25:13.310965 [debug] [Thread-4  ]: Compiling model.global_x_task.group_by_stock
[0m20:25:13.315395 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m20:25:13.318441 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m20:25:13.321443 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m20:25:13.321774 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m20:25:13.322262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:13.328174 [debug] [Thread-2  ]: finished collecting timing info
[0m20:25:13.328693 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m20:25:13.328832 [debug] [Thread-4  ]: finished collecting timing info
[0m20:25:13.331254 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m20:25:13.331707 [debug] [Thread-4  ]: Began executing node model.global_x_task.group_by_stock
[0m20:25:13.333700 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m20:25:13.333994 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m20:25:13.342504 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m20:25:13.342616 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m20:25:13.342742 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:25:13.342963 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m20:25:13.347751 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:25:14.853205 [debug] [Thread-1  ]: SQL status: OK -1 in 1.53 seconds
[0m20:25:14.854493 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m20:25:14.855993 [debug] [Thread-1  ]: finished collecting timing info
[0m20:25:14.856127 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m20:25:14.858099 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m20:25:14.858407 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m20:25:14.858509 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m20:25:14.886279 [debug] [Thread-4  ]: SQL status: OK -1 in 1.54 seconds
[0m20:25:14.887485 [debug] [Thread-4  ]: finished collecting timing info
[0m20:25:14.887634 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: Close
[0m20:25:14.888013 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d419520>]}
[0m20:25:14.888254 [info ] [Thread-4  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.58s]
[0m20:25:14.888536 [debug] [Thread-4  ]: Finished running node model.global_x_task.group_by_stock
[0m20:25:14.898038 [debug] [Thread-2  ]: SQL status: OK -1 in 1.56 seconds
[0m20:25:14.899414 [debug] [Thread-2  ]: finished collecting timing info
[0m20:25:14.899594 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m20:25:14.900015 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c86d0>]}
[0m20:25:14.900269 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.59s]
[0m20:25:14.900555 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m20:25:16.166622 [debug] [Thread-1  ]: SQL status: OK -1 in 1.31 seconds
[0m20:25:16.171172 [debug] [Thread-1  ]: finished collecting timing info
[0m20:25:16.171651 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m20:25:16.172483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b04199-e284-41ea-8864-8cb30a9b14c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d130f70>]}
[0m20:25:16.173017 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.87s]
[0m20:25:16.173617 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m20:25:16.175360 [debug] [MainThread]: Acquiring new athena connection "master"
[0m20:25:16.176015 [info ] [MainThread]: 
[0m20:25:16.176318 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 12.96 seconds (12.96s).
[0m20:25:16.176580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:16.176718 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m20:25:16.176849 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m20:25:16.176977 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m20:25:16.177100 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m20:25:16.192630 [info ] [MainThread]: 
[0m20:25:16.192974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:16.193204 [info ] [MainThread]: 
[0m20:25:16.193382 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:25:16.193647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf1b20>]}
[0m20:25:16.193887 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 14:18:59.887064 | bd032d0e-81d0-451f-81cd-b31f1244ca51 ==============================
[0m14:18:59.887116 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:18:59.887937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:18:59.888066 [debug] [MainThread]: Tracking: tracking
[0m14:18:59.899191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821bd30>]}
[0m14:18:59.941984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:59.942167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:59.946774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c80d0>]}
[0m14:18:59.951948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108317af0>]}
[0m14:18:59.952185 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:18:59.952387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c20d30>]}
[0m14:18:59.953229 [info ] [MainThread]: 
[0m14:18:59.953660 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:18:59.954369 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:18:59.962030 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:18:59.962195 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:18:59.962278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:02.145148 [debug] [ThreadPool]: SQL status: OK -1 in 2.18 seconds
[0m14:19:02.148821 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:19:02.149882 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m14:19:02.154786 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m14:19:02.154956 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m14:19:02.155040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:04.074840 [debug] [ThreadPool]: SQL status: OK -1 in 1.92 seconds
[0m14:19:04.077336 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m14:19:04.078024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f54c0>]}
[0m14:19:04.078519 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:19:04.078712 [info ] [MainThread]: 
[0m14:19:04.080726 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m14:19:04.080977 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m14:19:04.081409 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:19:04.082663 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m14:19:04.082783 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m14:19:04.088064 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:19:04.088234 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m14:19:04.088332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:05.897376 [debug] [Thread-1  ]: SQL status: OK -1 in 1.81 seconds
[0m14:19:05.900269 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m14:19:05.901568 [debug] [Thread-1  ]: finished collecting timing info
[0m14:19:05.901799 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m14:19:05.918647 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m14:19:05.919191 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:19:05.919291 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m14:19:07.313968 [debug] [Thread-1  ]: SQL status: OK -1 in 1.39 seconds
[0m14:19:07.322773 [debug] [Thread-1  ]: finished collecting timing info
[0m14:19:07.323051 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m14:19:07.323535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090220a0>]}
[0m14:19:07.323851 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 3.24s]
[0m14:19:07.324285 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m14:19:07.324847 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m14:19:07.324970 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m14:19:07.325213 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m14:19:07.325392 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m14:19:07.325894 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m14:19:07.326303 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m14:19:07.326426 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m14:19:07.326530 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m14:19:07.326642 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m14:19:07.326743 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m14:19:07.330179 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m14:19:07.333038 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m14:19:07.334053 [debug] [Thread-4  ]: finished collecting timing info
[0m14:19:07.334168 [debug] [Thread-3  ]: finished collecting timing info
[0m14:19:07.334317 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m14:19:07.334454 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m14:19:07.356378 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m14:19:07.358637 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m14:19:07.359131 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:19:07.359264 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:19:07.359345 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m14:19:07.359443 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m14:19:07.359563 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:19:07.359670 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:19:09.094581 [debug] [Thread-3  ]: SQL status: OK 51 in 1.73 seconds
[0m14:19:09.098111 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:19:09.098460 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m14:19:09.106793 [debug] [Thread-4  ]: SQL status: OK 1506 in 1.75 seconds
[0m14:19:09.108163 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:19:09.108385 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m14:19:10.869689 [debug] [Thread-4  ]: SQL status: OK -1 in 1.76 seconds
[0m14:19:10.873052 [debug] [Thread-4  ]: finished collecting timing info
[0m14:19:10.873502 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m14:19:10.874267 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a5d90>]}
[0m14:19:10.874583 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.55s]
[0m14:19:10.874900 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m14:19:10.916175 [debug] [Thread-3  ]: SQL status: OK -1 in 1.82 seconds
[0m14:19:10.919479 [debug] [Thread-3  ]: finished collecting timing info
[0m14:19:10.919803 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m14:19:10.920463 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc2640>]}
[0m14:19:10.920807 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 3.59s]
[0m14:19:10.921167 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m14:19:10.921589 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m14:19:10.921695 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m14:19:10.921840 [debug] [Thread-4  ]: Began running node model.global_x_task.group_by_stock
[0m14:19:10.922013 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m14:19:10.922233 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m14:19:10.922448 [info ] [Thread-4  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m14:19:10.922972 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m14:19:10.923524 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m14:19:10.923995 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m14:19:10.925486 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m14:19:10.925599 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m14:19:10.927188 [debug] [Thread-4  ]: Began compiling node model.global_x_task.group_by_stock
[0m14:19:10.927392 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m14:19:10.927565 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m14:19:10.927722 [debug] [Thread-4  ]: Compiling model.global_x_task.group_by_stock
[0m14:19:10.932125 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:19:10.935561 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m14:19:10.939469 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m14:19:10.939726 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m14:19:10.940120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:10.947172 [debug] [Thread-4  ]: finished collecting timing info
[0m14:19:10.947373 [debug] [Thread-2  ]: finished collecting timing info
[0m14:19:10.947543 [debug] [Thread-4  ]: Began executing node model.global_x_task.group_by_stock
[0m14:19:10.948329 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m14:19:10.950366 [debug] [Thread-4  ]: finished collecting timing info
[0m14:19:10.951952 [debug] [Thread-2  ]: finished collecting timing info
[0m14:19:10.952620 [debug] [Thread-4  ]: Compilation Error in model group_by_stock (models/group_by_stock.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.group_by_stock, or rename it to be less ambiguous.
  Searched for: default_globalx.group_by_stock
  Found: default_globalx.group_by_stock
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model group_by_stock (models/group_by_stock.sql)
[0m14:19:10.953082 [debug] [Thread-2  ]: Compilation Error in model group_by_date (models/group_by_date.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.group_by_date, or rename it to be less ambiguous.
  Searched for: default_globalx.group_by_date
  Found: default_globalx.group_by_date
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model group_by_date (models/group_by_date.sql)
[0m14:19:10.953337 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa77c0>]}
[0m14:19:10.962915 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa7eb0>]}
[0m14:19:10.963258 [error] [Thread-4  ]: 6 of 6 ERROR creating sql view model default_globalx.group_by_stock ............ [[31mERROR[0m in 0.03s]
[0m14:19:10.963652 [error] [Thread-2  ]: 5 of 6 ERROR creating sql view model default_globalx.group_by_date ............. [[31mERROR[0m in 0.04s]
[0m14:19:10.964049 [debug] [Thread-4  ]: Finished running node model.global_x_task.group_by_stock
[0m14:19:10.964323 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m14:19:12.691035 [debug] [Thread-1  ]: SQL status: OK -1 in 1.75 seconds
[0m14:19:12.694457 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m14:19:12.695669 [debug] [Thread-1  ]: finished collecting timing info
[0m14:19:12.695936 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m14:19:12.699716 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m14:19:12.700756 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:19:12.700940 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m14:19:14.066784 [debug] [Thread-1  ]: SQL status: OK -1 in 1.37 seconds
[0m14:19:14.071545 [debug] [Thread-1  ]: finished collecting timing info
[0m14:19:14.072178 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m14:19:14.073158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd032d0e-81d0-451f-81cd-b31f1244ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab163d0>]}
[0m14:19:14.073708 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 3.15s]
[0m14:19:14.074317 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m14:19:14.075995 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:19:14.076727 [info ] [MainThread]: 
[0m14:19:14.077014 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 14.12 seconds (14.12s).
[0m14:19:14.077263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:14.077541 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m14:19:14.077676 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m14:19:14.077811 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m14:19:14.077936 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m14:19:14.091846 [info ] [MainThread]: 
[0m14:19:14.092300 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:19:14.092543 [info ] [MainThread]: 
[0m14:19:14.092729 [error] [MainThread]: [33mCompilation Error in model group_by_stock (models/group_by_stock.sql)[0m
[0m14:19:14.092914 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m14:19:14.093095 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.group_by_stock, or rename it to be less ambiguous.
[0m14:19:14.093255 [error] [MainThread]:   Searched for: default_globalx.group_by_stock
[0m14:19:14.093415 [error] [MainThread]:   Found: default_globalx.group_by_stock
[0m14:19:14.093578 [error] [MainThread]:   
[0m14:19:14.093739 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m14:19:14.093898 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m14:19:14.094053 [error] [MainThread]:   > called by model group_by_stock (models/group_by_stock.sql)
[0m14:19:14.094202 [info ] [MainThread]: 
[0m14:19:14.094357 [error] [MainThread]: [33mCompilation Error in model group_by_date (models/group_by_date.sql)[0m
[0m14:19:14.094502 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m14:19:14.094703 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.group_by_date, or rename it to be less ambiguous.
[0m14:19:14.094960 [error] [MainThread]:   Searched for: default_globalx.group_by_date
[0m14:19:14.095118 [error] [MainThread]:   Found: default_globalx.group_by_date
[0m14:19:14.095271 [error] [MainThread]:   
[0m14:19:14.095425 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m14:19:14.095570 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m14:19:14.095716 [error] [MainThread]:   > called by model group_by_date (models/group_by_date.sql)
[0m14:19:14.095891 [info ] [MainThread]: 
[0m14:19:14.096054 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m14:19:14.096320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b580ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b580490>]}
[0m14:19:14.096514 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 14:21:51.026416 | aec456f7-987c-4c63-a4e4-74efc9d1be2a ==============================
[0m14:21:51.026438 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:21:51.027895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:21:51.028125 [debug] [MainThread]: Tracking: tracking
[0m14:21:51.042582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106811340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106811250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430dd00>]}
[0m14:21:51.086077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:51.086256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:51.090731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c70d0>]}
[0m14:21:51.095039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106919b50>]}
[0m14:21:51.095248 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:21:51.095411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3aaf0>]}
[0m14:21:51.096252 [info ] [MainThread]: 
[0m14:21:51.096630 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:21:51.097391 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:21:51.106417 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:21:51.106640 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:21:51.106731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:52.657079 [debug] [ThreadPool]: SQL status: OK -1 in 1.55 seconds
[0m14:21:52.658427 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:21:52.659585 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m14:21:52.667942 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m14:21:52.668375 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m14:21:52.668550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:54.275870 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m14:21:54.290024 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m14:21:54.291551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106873790>]}
[0m14:21:54.292011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:54.292205 [info ] [MainThread]: 
[0m14:21:54.293638 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m14:21:54.294095 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m14:21:54.294652 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:21:54.295948 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m14:21:54.296094 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m14:21:54.301452 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:21:54.301626 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m14:21:54.301726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:55.798181 [debug] [Thread-1  ]: SQL status: OK -1 in 1.5 seconds
[0m14:21:55.803228 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m14:21:55.804390 [debug] [Thread-1  ]: finished collecting timing info
[0m14:21:55.804666 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m14:21:55.823963 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m14:21:55.824552 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:21:55.824693 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m14:21:57.160878 [debug] [Thread-1  ]: SQL status: OK -1 in 1.34 seconds
[0m14:21:57.172485 [debug] [Thread-1  ]: finished collecting timing info
[0m14:21:57.172891 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m14:21:57.173564 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c7eb0>]}
[0m14:21:57.174021 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.88s]
[0m14:21:57.174548 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m14:21:57.175318 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m14:21:57.175503 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m14:21:57.175708 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m14:21:57.175958 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m14:21:57.176550 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m14:21:57.177078 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m14:21:57.177230 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m14:21:57.177369 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m14:21:57.177520 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m14:21:57.177648 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m14:21:57.181155 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m14:21:57.183874 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m14:21:57.184648 [debug] [Thread-4  ]: finished collecting timing info
[0m14:21:57.184787 [debug] [Thread-3  ]: finished collecting timing info
[0m14:21:57.184900 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m14:21:57.185030 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m14:21:57.199568 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m14:21:57.202050 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m14:21:57.202392 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:21:57.202503 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m14:21:57.202614 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:21:57.202699 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:21:57.202803 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m14:21:57.207805 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:21:59.794016 [debug] [Thread-3  ]: SQL status: OK 51 in 2.59 seconds
[0m14:21:59.797357 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:21:59.797572 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m14:21:59.803324 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.6 seconds
[0m14:21:59.804350 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:21:59.804533 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m14:22:01.157890 [debug] [Thread-4  ]: SQL status: OK -1 in 1.35 seconds
[0m14:22:01.162946 [debug] [Thread-4  ]: finished collecting timing info
[0m14:22:01.163863 [debug] [Thread-3  ]: SQL status: OK -1 in 1.37 seconds
[0m14:22:01.164291 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m14:22:01.166257 [debug] [Thread-3  ]: finished collecting timing info
[0m14:22:01.166993 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069abdc0>]}
[0m14:22:01.167206 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m14:22:01.167654 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.99s]
[0m14:22:01.168217 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069abd30>]}
[0m14:22:01.168732 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m14:22:01.169200 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 3.99s]
[0m14:22:01.169848 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m14:22:01.170491 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m14:22:01.170736 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m14:22:01.170928 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m14:22:01.171058 [debug] [Thread-4  ]: Began running node model.global_x_task.group_by_stock
[0m14:22:01.171289 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m14:22:01.171923 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m14:22:01.172130 [info ] [Thread-4  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m14:22:01.172629 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m14:22:01.173466 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m14:22:01.175309 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m14:22:01.175500 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m14:22:01.175973 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m14:22:01.177622 [debug] [Thread-4  ]: Began compiling node model.global_x_task.group_by_stock
[0m14:22:01.177779 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m14:22:01.181667 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:22:01.181831 [debug] [Thread-4  ]: Compiling model.global_x_task.group_by_stock
[0m14:22:01.184558 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m14:22:01.184719 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m14:22:01.187174 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m14:22:01.187380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:22:01.195124 [debug] [Thread-4  ]: finished collecting timing info
[0m14:22:01.195323 [debug] [Thread-2  ]: finished collecting timing info
[0m14:22:01.195425 [debug] [Thread-4  ]: Began executing node model.global_x_task.group_by_stock
[0m14:22:01.196392 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m14:22:01.198084 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m14:22:01.199800 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m14:22:01.208387 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m14:22:01.208531 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m14:22:01.208657 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m14:22:01.208798 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m14:22:01.208979 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:22:01.209099 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:22:02.805228 [debug] [Thread-4  ]: SQL status: OK -1 in 1.6 seconds
[0m14:22:02.806600 [debug] [Thread-4  ]: finished collecting timing info
[0m14:22:02.806765 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: Close
[0m14:22:02.807132 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110febbb0>]}
[0m14:22:02.807359 [info ] [Thread-4  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.63s]
[0m14:22:02.807623 [debug] [Thread-4  ]: Finished running node model.global_x_task.group_by_stock
[0m14:22:02.810410 [debug] [Thread-2  ]: SQL status: OK -1 in 1.6 seconds
[0m14:22:02.811501 [debug] [Thread-2  ]: finished collecting timing info
[0m14:22:02.811640 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m14:22:02.811974 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f35cd0>]}
[0m14:22:02.812170 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.64s]
[0m14:22:02.812405 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m14:22:02.842605 [debug] [Thread-1  ]: SQL status: OK -1 in 1.66 seconds
[0m14:22:02.843820 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m14:22:02.844290 [debug] [Thread-1  ]: finished collecting timing info
[0m14:22:02.844423 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m14:22:02.846198 [debug] [Thread-1  ]: finished collecting timing info
[0m14:22:02.846331 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m14:22:02.846675 [debug] [Thread-1  ]: Compilation Error in model extra_metrics (models/extra_metrics.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete default_globalx.extra_metrics, or rename it to be less ambiguous.
  Searched for: default_globalx.extra_metrics
  Found: default_globalx.extra_metrics
  
  > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
  > called by model extra_metrics (models/extra_metrics.sql)
[0m14:22:02.846841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec456f7-987c-4c63-a4e4-74efc9d1be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f35280>]}
[0m14:22:02.847053 [error] [Thread-1  ]: 4 of 6 ERROR creating sql view model default_globalx.extra_metrics ............. [[31mERROR[0m in 1.68s]
[0m14:22:02.847306 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m14:22:02.848166 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:22:02.848577 [info ] [MainThread]: 
[0m14:22:02.848771 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m14:22:02.848941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:02.849030 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m14:22:02.849116 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m14:22:02.849199 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m14:22:02.849281 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m14:22:02.857954 [info ] [MainThread]: 
[0m14:22:02.858153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:22:02.858357 [info ] [MainThread]: 
[0m14:22:02.858503 [error] [MainThread]: [33mCompilation Error in model extra_metrics (models/extra_metrics.sql)[0m
[0m14:22:02.858642 [error] [MainThread]:   When searching for a relation, dbt found an approximate match. Instead of guessing 
[0m14:22:02.858780 [error] [MainThread]:   which relation to use, dbt will move on. Please delete default_globalx.extra_metrics, or rename it to be less ambiguous.
[0m14:22:02.858908 [error] [MainThread]:   Searched for: default_globalx.extra_metrics
[0m14:22:02.859037 [error] [MainThread]:   Found: default_globalx.extra_metrics
[0m14:22:02.859163 [error] [MainThread]:   
[0m14:22:02.859287 [error] [MainThread]:   > in macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m14:22:02.859412 [error] [MainThread]:   > called by macro materialization_view_athena (macros/materializations/models/view/view.sql)
[0m14:22:02.859536 [error] [MainThread]:   > called by model extra_metrics (models/extra_metrics.sql)
[0m14:22:02.859673 [info ] [MainThread]: 
[0m14:22:02.859805 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m14:22:02.859985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f35280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126192e0>]}
[0m14:22:02.860130 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 14:23:50.189934 | d826622e-8d6b-4c58-bab0-abcc945399d0 ==============================
[0m14:23:50.189962 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:23:50.190561 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:23:50.190661 [debug] [MainThread]: Tracking: tracking
[0m14:23:50.200046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a95e0>]}
[0m14:23:50.241384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:50.241551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:50.245750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064640d0>]}
[0m14:23:50.249700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063aebb0>]}
[0m14:23:50.249862 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:23:50.250011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438fa30>]}
[0m14:23:50.250785 [info ] [MainThread]: 
[0m14:23:50.251120 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:23:50.251726 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:23:50.259192 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:23:50.259358 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:23:50.259457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:51.869662 [debug] [ThreadPool]: SQL status: OK -1 in 1.61 seconds
[0m14:23:51.873277 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:23:51.875407 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m14:23:51.885264 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m14:23:51.885479 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m14:23:51.885635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:53.401928 [debug] [ThreadPool]: SQL status: OK -1 in 1.52 seconds
[0m14:23:53.403265 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m14:23:53.403783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106310160>]}
[0m14:23:53.404215 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:53.404385 [info ] [MainThread]: 
[0m14:23:53.405795 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m14:23:53.405993 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m14:23:53.406359 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:23:53.407413 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m14:23:53.407537 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m14:23:53.411910 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:23:53.412053 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m14:23:53.412134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:23:54.910083 [debug] [Thread-1  ]: SQL status: OK -1 in 1.5 seconds
[0m14:23:54.914120 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m14:23:54.915365 [debug] [Thread-1  ]: finished collecting timing info
[0m14:23:54.915635 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m14:23:54.934436 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m14:23:54.935011 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:23:54.935145 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m14:23:56.311125 [debug] [Thread-1  ]: SQL status: OK -1 in 1.38 seconds
[0m14:23:56.322413 [debug] [Thread-1  ]: finished collecting timing info
[0m14:23:56.322819 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m14:23:56.323514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649b280>]}
[0m14:23:56.323989 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.92s]
[0m14:23:56.324517 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m14:23:56.325220 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m14:23:56.325486 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m14:23:56.325868 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m14:23:56.326105 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m14:23:56.326701 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m14:23:56.327381 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m14:23:56.327528 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m14:23:56.327659 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m14:23:56.327806 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m14:23:56.327929 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m14:23:56.331758 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m14:23:56.335199 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m14:23:56.336129 [debug] [Thread-3  ]: finished collecting timing info
[0m14:23:56.336386 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m14:23:56.336527 [debug] [Thread-4  ]: finished collecting timing info
[0m14:23:56.352198 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m14:23:56.352448 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m14:23:56.355414 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m14:23:56.355794 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:23:56.355948 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m14:23:56.356043 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:23:56.356154 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:23:56.360952 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m14:23:56.361085 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:23:58.970454 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.61 seconds
[0m14:23:58.973761 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:23:58.973960 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m14:23:58.975293 [debug] [Thread-3  ]: SQL status: OK 51 in 2.62 seconds
[0m14:23:58.976438 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:23:58.976645 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m14:24:00.350348 [debug] [Thread-3  ]: SQL status: OK -1 in 1.37 seconds
[0m14:24:00.351850 [debug] [Thread-4  ]: SQL status: OK -1 in 1.38 seconds
[0m14:24:00.354787 [debug] [Thread-3  ]: finished collecting timing info
[0m14:24:00.356683 [debug] [Thread-4  ]: finished collecting timing info
[0m14:24:00.357120 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m14:24:00.357319 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m14:24:00.357953 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b8ca0>]}
[0m14:24:00.358474 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11881dee0>]}
[0m14:24:00.358908 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 4.03s]
[0m14:24:00.359237 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.03s]
[0m14:24:00.359802 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m14:24:00.360119 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m14:24:00.360979 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m14:24:00.361227 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m14:24:00.361418 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m14:24:00.361550 [debug] [Thread-3  ]: Began running node model.global_x_task.group_by_stock
[0m14:24:00.361783 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m14:24:00.362343 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m14:24:00.362539 [info ] [Thread-3  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m14:24:00.363034 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m14:24:00.363865 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m14:24:00.365864 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m14:24:00.366038 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m14:24:00.367846 [debug] [Thread-3  ]: Began compiling node model.global_x_task.group_by_stock
[0m14:24:00.368056 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m14:24:00.368238 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m14:24:00.368406 [debug] [Thread-3  ]: Compiling model.global_x_task.group_by_stock
[0m14:24:00.372756 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:24:00.375656 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m14:24:00.378302 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m14:24:00.378553 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m14:24:00.378853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:00.385751 [debug] [Thread-2  ]: finished collecting timing info
[0m14:24:00.386914 [debug] [Thread-3  ]: finished collecting timing info
[0m14:24:00.387061 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m14:24:00.387556 [debug] [Thread-3  ]: Began executing node model.global_x_task.group_by_stock
[0m14:24:00.389429 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m14:24:00.399839 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m14:24:00.400425 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m14:24:00.400534 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m14:24:00.400666 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m14:24:00.400763 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m14:24:00.400977 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:24:00.401190 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:24:02.073400 [debug] [Thread-3  ]: SQL status: OK -1 in 1.67 seconds
[0m14:24:02.075360 [debug] [Thread-3  ]: finished collecting timing info
[0m14:24:02.075606 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: Close
[0m14:24:02.076113 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119579eb0>]}
[0m14:24:02.076424 [info ] [Thread-3  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.71s]
[0m14:24:02.076785 [debug] [Thread-3  ]: Finished running node model.global_x_task.group_by_stock
[0m14:24:02.081011 [debug] [Thread-2  ]: SQL status: OK -1 in 1.68 seconds
[0m14:24:02.082398 [debug] [Thread-2  ]: finished collecting timing info
[0m14:24:02.082574 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m14:24:02.083019 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b33400>]}
[0m14:24:02.083348 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.72s]
[0m14:24:02.083675 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m14:24:02.084268 [debug] [Thread-1  ]: SQL status: OK -1 in 1.71 seconds
[0m14:24:02.085660 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m14:24:02.086219 [debug] [Thread-1  ]: finished collecting timing info
[0m14:24:02.086373 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m14:24:02.088711 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m14:24:02.089172 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:24:02.089289 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m14:24:03.416539 [debug] [Thread-1  ]: SQL status: OK -1 in 1.33 seconds
[0m14:24:03.418118 [debug] [Thread-1  ]: finished collecting timing info
[0m14:24:03.418287 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m14:24:03.418587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd826622e-8d6b-4c58-bab0-abcc945399d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195a8d90>]}
[0m14:24:03.418785 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 3.06s]
[0m14:24:03.419002 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m14:24:03.419754 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:24:03.420045 [info ] [MainThread]: 
[0m14:24:03.420177 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 13.17 seconds (13.17s).
[0m14:24:03.420296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:03.420361 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m14:24:03.420461 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m14:24:03.420523 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m14:24:03.420584 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m14:24:03.429218 [info ] [MainThread]: 
[0m14:24:03.429386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:03.429537 [info ] [MainThread]: 
[0m14:24:03.429655 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:24:03.429813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11889b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11889b190>]}
[0m14:24:03.429936 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 14:25:38.867218 | 7df99e91-1e82-4449-aa12-7bc3a2b3a138 ==============================
[0m14:25:38.867241 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:25:38.867853 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:25:38.867965 [debug] [MainThread]: Tracking: tracking
[0m14:25:38.885314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d1640>]}
[0m14:25:38.925709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:38.925886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:38.929974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056870d0>]}
[0m14:25:38.933934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d9bb0>]}
[0m14:25:38.934108 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:25:38.934270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a8ba30>]}
[0m14:25:38.935049 [info ] [MainThread]: 
[0m14:25:38.935407 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:25:38.936125 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m14:25:38.943663 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m14:25:38.943846 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m14:25:38.943931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:40.530315 [debug] [ThreadPool]: SQL status: OK -1 in 1.59 seconds
[0m14:25:40.534599 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:25:40.537025 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m14:25:40.546197 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m14:25:40.546477 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m14:25:40.546621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:42.096500 [debug] [ThreadPool]: SQL status: OK -1 in 1.55 seconds
[0m14:25:42.100655 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m14:25:42.102031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105533160>]}
[0m14:25:42.103016 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:42.103420 [info ] [MainThread]: 
[0m14:25:42.107219 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m14:25:42.107572 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m14:25:42.108253 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:25:42.110741 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m14:25:42.111004 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m14:25:42.118657 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:25:42.118864 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m14:25:42.118983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:43.642738 [debug] [Thread-1  ]: SQL status: OK -1 in 1.52 seconds
[0m14:25:43.647282 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m14:25:43.648478 [debug] [Thread-1  ]: finished collecting timing info
[0m14:25:43.648743 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m14:25:43.667844 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m14:25:43.668594 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m14:25:43.668735 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m14:25:45.027124 [debug] [Thread-1  ]: SQL status: OK -1 in 1.36 seconds
[0m14:25:45.037274 [debug] [Thread-1  ]: finished collecting timing info
[0m14:25:45.037604 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m14:25:45.038147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd3310>]}
[0m14:25:45.038426 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.93s]
[0m14:25:45.038772 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m14:25:45.039242 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m14:25:45.039387 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m14:25:45.039645 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m14:25:45.039848 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m14:25:45.040350 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m14:25:45.040796 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m14:25:45.040923 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m14:25:45.041036 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m14:25:45.041152 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m14:25:45.041259 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m14:25:45.044772 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m14:25:45.047807 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m14:25:45.048376 [debug] [Thread-3  ]: finished collecting timing info
[0m14:25:45.048520 [debug] [Thread-4  ]: finished collecting timing info
[0m14:25:45.048643 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m14:25:45.048786 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m14:25:45.065275 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m14:25:45.068243 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m14:25:45.068876 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:25:45.069090 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m14:25:45.069233 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:25:45.069324 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:25:45.069435 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m14:25:45.074632 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:25:47.683977 [debug] [Thread-3  ]: SQL status: OK 51 in 2.61 seconds
[0m14:25:47.687243 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m14:25:47.687441 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m14:25:47.693389 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.62 seconds
[0m14:25:47.694427 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m14:25:47.694574 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m14:25:49.048844 [debug] [Thread-4  ]: SQL status: OK -1 in 1.35 seconds
[0m14:25:49.052330 [debug] [Thread-4  ]: finished collecting timing info
[0m14:25:49.052755 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m14:25:49.053561 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757a640>]}
[0m14:25:49.054068 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 4.01s]
[0m14:25:49.054667 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m14:25:50.111841 [debug] [Thread-3  ]: SQL status: OK -1 in 2.42 seconds
[0m14:25:50.115079 [debug] [Thread-3  ]: finished collecting timing info
[0m14:25:50.115484 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m14:25:50.116174 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aedbb0>]}
[0m14:25:50.116622 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 5.08s]
[0m14:25:50.117133 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m14:25:50.117933 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m14:25:50.118121 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m14:25:50.118284 [debug] [Thread-4  ]: Began running node model.global_x_task.group_by_stock
[0m14:25:50.118571 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m14:25:50.118831 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m14:25:50.119054 [info ] [Thread-4  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m14:25:50.119730 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m14:25:50.120343 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m14:25:50.120907 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m14:25:50.121360 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m14:25:50.123617 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m14:25:50.124060 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m14:25:50.125841 [debug] [Thread-4  ]: Began compiling node model.global_x_task.group_by_stock
[0m14:25:50.126039 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m14:25:50.130027 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m14:25:50.130268 [debug] [Thread-4  ]: Compiling model.global_x_task.group_by_stock
[0m14:25:50.133621 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:25:50.136885 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m14:25:50.137208 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m14:25:50.137362 [debug] [Thread-2  ]: finished collecting timing info
[0m14:25:50.137562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:50.137711 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m14:25:50.144255 [debug] [Thread-4  ]: finished collecting timing info
[0m14:25:50.146497 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m14:25:50.147698 [debug] [Thread-4  ]: Began executing node model.global_x_task.group_by_stock
[0m14:25:50.149816 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m14:25:50.150123 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m14:25:50.158866 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m14:25:50.158997 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m14:25:50.159274 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m14:25:50.159377 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:25:50.159597 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:25:51.856033 [debug] [Thread-1  ]: SQL status: OK -1 in 1.72 seconds
[0m14:25:51.857777 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m14:25:51.858281 [debug] [Thread-1  ]: finished collecting timing info
[0m14:25:51.858434 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m14:25:51.860574 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m14:25:51.861004 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m14:25:51.861103 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m14:25:51.874333 [debug] [Thread-2  ]: SQL status: OK -1 in 1.71 seconds
[0m14:25:51.875451 [debug] [Thread-2  ]: finished collecting timing info
[0m14:25:51.875634 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m14:25:51.875987 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c504c0>]}
[0m14:25:51.876194 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.76s]
[0m14:25:51.876419 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m14:25:51.885992 [debug] [Thread-4  ]: SQL status: OK -1 in 1.73 seconds
[0m14:25:51.886990 [debug] [Thread-4  ]: finished collecting timing info
[0m14:25:51.887143 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: Close
[0m14:25:51.887459 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c06dc0>]}
[0m14:25:51.887661 [info ] [Thread-4  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.77s]
[0m14:25:51.887879 [debug] [Thread-4  ]: Finished running node model.global_x_task.group_by_stock
[0m14:25:53.181170 [debug] [Thread-1  ]: SQL status: OK -1 in 1.32 seconds
[0m14:25:53.189649 [debug] [Thread-1  ]: finished collecting timing info
[0m14:25:53.190093 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m14:25:53.190978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df99e91-1e82-4449-aa12-7bc3a2b3a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c06f10>]}
[0m14:25:53.191305 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 3.07s]
[0m14:25:53.191572 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m14:25:53.192558 [debug] [MainThread]: Acquiring new athena connection "master"
[0m14:25:53.192912 [info ] [MainThread]: 
[0m14:25:53.193062 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 14.26 seconds (14.26s).
[0m14:25:53.193186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:53.193252 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m14:25:53.193315 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m14:25:53.193375 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m14:25:53.193435 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m14:25:53.202483 [info ] [MainThread]: 
[0m14:25:53.202724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:53.202882 [info ] [MainThread]: 
[0m14:25:53.203005 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:25:53.203185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105533d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755e220>]}
[0m14:25:53.203338 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 15:37:08.146868 | d1fbc79f-0857-48a9-a91e-6cd34d7f8538 ==============================
[0m15:37:08.146893 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:37:08.147889 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:37:08.148014 [debug] [MainThread]: Tracking: tracking
[0m15:37:08.166053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c134f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c132b0>]}
[0m15:37:08.204226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:08.204400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:08.208490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc80d0>]}
[0m15:37:08.213280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d16b50>]}
[0m15:37:08.213545 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:37:08.213812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c82af0>]}
[0m15:37:08.214662 [info ] [MainThread]: 
[0m15:37:08.215032 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:37:08.215593 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m15:37:08.222307 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m15:37:08.222498 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m15:37:08.222569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:09.707815 [debug] [ThreadPool]: SQL status: OK -1 in 1.49 seconds
[0m15:37:09.709952 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:37:09.711630 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m15:37:09.720680 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m15:37:09.721078 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m15:37:09.721218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:11.164264 [debug] [ThreadPool]: SQL status: OK -1 in 1.44 seconds
[0m15:37:11.167432 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m15:37:11.168547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c73790>]}
[0m15:37:11.169361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:11.169686 [info ] [MainThread]: 
[0m15:37:11.173515 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m15:37:11.173999 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m15:37:11.174760 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:37:11.177283 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m15:37:11.177561 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m15:37:11.186355 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:37:11.186675 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m15:37:11.186801 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:37:12.671838 [debug] [Thread-1  ]: SQL status: OK -1 in 1.49 seconds
[0m15:37:12.673472 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m15:37:12.675201 [debug] [Thread-1  ]: finished collecting timing info
[0m15:37:12.675344 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m15:37:12.688138 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m15:37:12.688611 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:37:12.688710 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m15:37:14.064880 [debug] [Thread-1  ]: SQL status: OK -1 in 1.38 seconds
[0m15:37:14.075235 [debug] [Thread-1  ]: finished collecting timing info
[0m15:37:14.075648 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m15:37:14.076335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df7550>]}
[0m15:37:14.076804 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.90s]
[0m15:37:14.077342 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m15:37:14.078090 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m15:37:14.078383 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m15:37:14.078597 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m15:37:14.078840 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m15:37:14.079519 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m15:37:14.080080 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m15:37:14.080234 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m15:37:14.080361 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m15:37:14.080505 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m15:37:14.080744 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m15:37:14.085040 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m15:37:14.087939 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m15:37:14.088905 [debug] [Thread-3  ]: finished collecting timing info
[0m15:37:14.089069 [debug] [Thread-4  ]: finished collecting timing info
[0m15:37:14.089208 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m15:37:14.089331 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m15:37:14.105224 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m15:37:14.108140 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m15:37:14.108860 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:37:14.108989 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:37:14.109070 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m15:37:14.109167 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m15:37:14.109280 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:37:14.109385 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:37:15.568462 [debug] [Thread-3  ]: SQL status: OK 51 in 1.46 seconds
[0m15:37:15.574674 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:37:15.575031 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m15:37:16.621202 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.51 seconds
[0m15:37:16.622564 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:37:16.622755 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m15:37:16.874833 [debug] [Thread-3  ]: SQL status: OK -1 in 1.3 seconds
[0m15:37:16.876126 [debug] [Thread-3  ]: finished collecting timing info
[0m15:37:16.876313 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m15:37:16.876672 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b32f040>]}
[0m15:37:16.876906 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 2.80s]
[0m15:37:16.877180 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m15:37:17.916149 [debug] [Thread-4  ]: SQL status: OK -1 in 1.29 seconds
[0m15:37:17.918185 [debug] [Thread-4  ]: finished collecting timing info
[0m15:37:17.918497 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m15:37:17.919114 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf151c0>]}
[0m15:37:17.919509 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.84s]
[0m15:37:17.920046 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m15:37:17.920845 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m15:37:17.921046 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m15:37:17.921232 [debug] [Thread-3  ]: Began running node model.global_x_task.group_by_stock
[0m15:37:17.921452 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m15:37:17.921721 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m15:37:17.921920 [info ] [Thread-3  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m15:37:17.922575 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m15:37:17.923273 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m15:37:17.923800 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m15:37:17.925622 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m15:37:17.925770 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m15:37:17.927497 [debug] [Thread-3  ]: Began compiling node model.global_x_task.group_by_stock
[0m15:37:17.927611 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m15:37:17.927746 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m15:37:17.927860 [debug] [Thread-3  ]: Compiling model.global_x_task.group_by_stock
[0m15:37:17.931811 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:37:17.934986 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m15:37:17.937801 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m15:37:17.938047 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m15:37:17.939140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:37:17.945048 [debug] [Thread-2  ]: finished collecting timing info
[0m15:37:17.945396 [debug] [Thread-3  ]: finished collecting timing info
[0m15:37:17.945639 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m15:37:17.946707 [debug] [Thread-3  ]: Began executing node model.global_x_task.group_by_stock
[0m15:37:17.948896 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m15:37:17.951522 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m15:37:17.959545 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m15:37:17.959777 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:37:17.959902 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:37:17.960037 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m15:37:17.964986 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:37:17.965228 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:37:19.468406 [debug] [Thread-1  ]: SQL status: OK -1 in 1.53 seconds
[0m15:37:19.469586 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m15:37:19.470049 [debug] [Thread-1  ]: finished collecting timing info
[0m15:37:19.470177 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m15:37:19.471820 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m15:37:19.472121 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:37:19.472204 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m15:37:19.482853 [debug] [Thread-3  ]: SQL status: OK -1 in 1.52 seconds
[0m15:37:19.484038 [debug] [Thread-3  ]: finished collecting timing info
[0m15:37:19.484197 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: Close
[0m15:37:19.484504 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5952b0>]}
[0m15:37:19.484742 [info ] [Thread-3  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.56s]
[0m15:37:19.484972 [debug] [Thread-3  ]: Finished running node model.global_x_task.group_by_stock
[0m15:37:19.497831 [debug] [Thread-2  ]: SQL status: OK -1 in 1.54 seconds
[0m15:37:19.499014 [debug] [Thread-2  ]: finished collecting timing info
[0m15:37:19.499140 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m15:37:19.499603 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef18e80>]}
[0m15:37:19.499938 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.58s]
[0m15:37:19.500207 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m15:37:20.769643 [debug] [Thread-1  ]: SQL status: OK -1 in 1.3 seconds
[0m15:37:20.773753 [debug] [Thread-1  ]: finished collecting timing info
[0m15:37:20.774224 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m15:37:20.774965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1fbc79f-0857-48a9-a91e-6cd34d7f8538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c13100>]}
[0m15:37:20.775444 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.85s]
[0m15:37:20.775996 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m15:37:20.777601 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:37:20.778250 [info ] [MainThread]: 
[0m15:37:20.778553 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 12.56 seconds (12.56s).
[0m15:37:20.778815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:20.778953 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m15:37:20.779083 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m15:37:20.779212 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m15:37:20.779357 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m15:37:20.795568 [info ] [MainThread]: 
[0m15:37:20.795920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:20.796170 [info ] [MainThread]: 
[0m15:37:20.796347 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:37:20.796618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100648be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f2d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184f9220>]}
[0m15:37:20.796853 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 15:40:03.124249 | 0221cf53-5212-4144-8906-a6a18da085af ==============================
[0m15:40:03.124273 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:40:03.124845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:40:03.124949 [debug] [MainThread]: Tracking: tracking
[0m15:40:03.134030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106dbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106cd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d1640>]}
[0m15:40:03.160768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:03.160917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:03.164331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108870d0>]}
[0m15:40:03.167687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107dbbb0>]}
[0m15:40:03.167828 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:40:03.167961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bfa30>]}
[0m15:40:03.168671 [info ] [MainThread]: 
[0m15:40:03.168976 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:40:03.169513 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m15:40:03.176135 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m15:40:03.176300 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m15:40:03.176371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:04.661757 [debug] [ThreadPool]: SQL status: OK -1 in 1.49 seconds
[0m15:40:04.663573 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:40:04.664896 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m15:40:04.671101 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m15:40:04.671296 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m15:40:04.671395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:06.116630 [debug] [ThreadPool]: SQL status: OK -1 in 1.45 seconds
[0m15:40:06.122234 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m15:40:06.123323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110733160>]}
[0m15:40:06.124052 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:06.124373 [info ] [MainThread]: 
[0m15:40:06.127483 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m15:40:06.127866 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m15:40:06.128574 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:40:06.130813 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m15:40:06.131101 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m15:40:06.139501 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:40:06.139771 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m15:40:06.139920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:40:07.647124 [debug] [Thread-1  ]: SQL status: OK -1 in 1.51 seconds
[0m15:40:07.650815 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m15:40:07.652532 [debug] [Thread-1  ]: finished collecting timing info
[0m15:40:07.652736 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m15:40:07.671122 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m15:40:07.671767 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:40:07.671910 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m15:40:09.011439 [debug] [Thread-1  ]: SQL status: OK -1 in 1.34 seconds
[0m15:40:09.016733 [debug] [Thread-1  ]: finished collecting timing info
[0m15:40:09.016965 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m15:40:09.017316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a037c0>]}
[0m15:40:09.017565 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.89s]
[0m15:40:09.017875 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m15:40:09.018373 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m15:40:09.018601 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m15:40:09.018875 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m15:40:09.019122 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m15:40:09.019704 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m15:40:09.020176 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m15:40:09.020307 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m15:40:09.020424 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m15:40:09.020547 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m15:40:09.020657 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m15:40:09.023230 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m15:40:09.026145 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m15:40:09.026837 [debug] [Thread-4  ]: finished collecting timing info
[0m15:40:09.027027 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m15:40:09.027173 [debug] [Thread-3  ]: finished collecting timing info
[0m15:40:09.043021 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m15:40:09.043282 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m15:40:09.046738 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m15:40:09.047087 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:40:09.047232 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m15:40:09.047339 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:40:09.047464 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:40:09.052987 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m15:40:09.053194 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:40:11.535751 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.49 seconds
[0m15:40:11.542361 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:40:11.546123 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m15:40:12.931284 [debug] [Thread-4  ]: SQL status: OK -1 in 1.38 seconds
[0m15:40:12.933188 [debug] [Thread-4  ]: finished collecting timing info
[0m15:40:12.933433 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m15:40:12.933984 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110df6c70>]}
[0m15:40:12.934338 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.91s]
[0m15:40:12.934742 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m15:40:13.869802 [debug] [Thread-3  ]: SQL status: OK 51 in 4.82 seconds
[0m15:40:13.873136 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:40:13.873624 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m15:40:15.221239 [debug] [Thread-3  ]: SQL status: OK -1 in 1.35 seconds
[0m15:40:15.225206 [debug] [Thread-3  ]: finished collecting timing info
[0m15:40:15.225541 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m15:40:15.226061 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b2ee0>]}
[0m15:40:15.226390 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 6.21s]
[0m15:40:15.226816 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m15:40:15.227450 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m15:40:15.227648 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m15:40:15.227864 [debug] [Thread-4  ]: Began running node model.global_x_task.group_by_stock
[0m15:40:15.228179 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m15:40:15.228453 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m15:40:15.228675 [info ] [Thread-4  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m15:40:15.229330 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m15:40:15.229990 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m15:40:15.230592 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m15:40:15.230987 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m15:40:15.232676 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m15:40:15.234586 [debug] [Thread-4  ]: Began compiling node model.global_x_task.group_by_stock
[0m15:40:15.234731 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m15:40:15.234904 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m15:40:15.235057 [debug] [Thread-4  ]: Compiling model.global_x_task.group_by_stock
[0m15:40:15.239192 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m15:40:15.243456 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:40:15.246464 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m15:40:15.246820 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m15:40:15.247128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:40:15.247257 [debug] [Thread-2  ]: finished collecting timing info
[0m15:40:15.253554 [debug] [Thread-4  ]: finished collecting timing info
[0m15:40:15.253734 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m15:40:15.254028 [debug] [Thread-4  ]: Began executing node model.global_x_task.group_by_stock
[0m15:40:15.257508 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m15:40:15.259399 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m15:40:15.269054 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m15:40:15.269188 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m15:40:15.269399 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:40:15.269524 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:40:15.270006 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:40:15.270231 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m15:40:16.778726 [debug] [Thread-1  ]: SQL status: OK -1 in 1.53 seconds
[0m15:40:16.780077 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m15:40:16.780563 [debug] [Thread-1  ]: finished collecting timing info
[0m15:40:16.780691 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m15:40:16.782554 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m15:40:16.782881 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:40:16.782979 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m15:40:16.804789 [debug] [Thread-4  ]: SQL status: OK -1 in 1.53 seconds
[0m15:40:16.806173 [debug] [Thread-4  ]: finished collecting timing info
[0m15:40:16.806667 [debug] [Thread-2  ]: SQL status: OK -1 in 1.54 seconds
[0m15:40:16.807198 [debug] [Thread-4  ]: On model.global_x_task.group_by_stock: Close
[0m15:40:16.808455 [debug] [Thread-2  ]: finished collecting timing info
[0m15:40:16.808918 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213bfac0>]}
[0m15:40:16.809045 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m15:40:16.809286 [info ] [Thread-4  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.58s]
[0m15:40:16.809606 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121727af0>]}
[0m15:40:16.811846 [debug] [Thread-4  ]: Finished running node model.global_x_task.group_by_stock
[0m15:40:16.812139 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.58s]
[0m15:40:16.812455 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m15:40:18.104179 [debug] [Thread-1  ]: SQL status: OK -1 in 1.32 seconds
[0m15:40:18.107852 [debug] [Thread-1  ]: finished collecting timing info
[0m15:40:18.108417 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m15:40:18.109304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0221cf53-5212-4144-8906-a6a18da085af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111346f40>]}
[0m15:40:18.109850 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.88s]
[0m15:40:18.110445 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m15:40:18.112180 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:40:18.112864 [info ] [MainThread]: 
[0m15:40:18.113179 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 14.94 seconds (14.94s).
[0m15:40:18.113446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:18.113588 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m15:40:18.113722 [debug] [MainThread]: Connection 'model.global_x_task.fred_unemp' was properly closed.
[0m15:40:18.113849 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m15:40:18.113977 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m15:40:18.127771 [info ] [MainThread]: 
[0m15:40:18.128080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:18.128304 [info ] [MainThread]: 
[0m15:40:18.128481 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:40:18.128784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120073400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120073520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111346e50>]}
[0m15:40:18.128998 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 15:42:54.822393 | 241dc213-8e25-4873-9e68-0f26df9c6015 ==============================
[0m15:42:54.822413 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:42:54.822980 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:54.823104 [debug] [MainThread]: Tracking: tracking
[0m15:42:54.833000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062db2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062db3d0>]}
[0m15:42:54.869691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:54.869855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:54.873559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064870d0>]}
[0m15:42:54.877318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d6c70>]}
[0m15:42:54.877476 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:42:54.877615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d6d00>]}
[0m15:42:54.878328 [info ] [MainThread]: 
[0m15:42:54.878647 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:42:54.879232 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m15:42:54.886015 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m15:42:54.886156 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m15:42:54.886228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:56.392740 [debug] [ThreadPool]: SQL status: OK -1 in 1.51 seconds
[0m15:42:56.395552 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:42:56.397838 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m15:42:56.407383 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m15:42:56.407718 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m15:42:56.407923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:57.865381 [debug] [ThreadPool]: SQL status: OK -1 in 1.46 seconds
[0m15:42:57.866773 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m15:42:57.867449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106334a60>]}
[0m15:42:57.868007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:57.868239 [info ] [MainThread]: 
[0m15:42:57.870771 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m15:42:57.871025 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m15:42:57.871534 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:42:57.872969 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m15:42:57.873102 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m15:42:57.878821 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:42:57.879016 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m15:42:57.879119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:42:59.327049 [debug] [Thread-1  ]: SQL status: OK -1 in 1.45 seconds
[0m15:42:59.331303 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m15:42:59.332173 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:59.332396 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m15:42:59.351563 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m15:42:59.352307 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:42:59.352444 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m15:43:00.677273 [debug] [Thread-1  ]: SQL status: OK -1 in 1.32 seconds
[0m15:43:00.690154 [debug] [Thread-1  ]: finished collecting timing info
[0m15:43:00.690588 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m15:43:00.691288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106502400>]}
[0m15:43:00.691728 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.82s]
[0m15:43:00.692378 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m15:43:00.693130 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m15:43:00.693357 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m15:43:00.693568 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m15:43:00.693821 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m15:43:00.694441 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m15:43:00.694973 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m15:43:00.695134 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m15:43:00.695270 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m15:43:00.695416 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m15:43:00.695573 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m15:43:00.699190 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m15:43:00.702613 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m15:43:00.703418 [debug] [Thread-3  ]: finished collecting timing info
[0m15:43:00.703636 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m15:43:00.703782 [debug] [Thread-4  ]: finished collecting timing info
[0m15:43:00.719422 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m15:43:00.719652 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m15:43:00.722542 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m15:43:00.722835 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:43:00.722968 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m15:43:00.723072 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:43:00.723171 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:43:00.728140 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m15:43:00.728375 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:43:02.152148 [debug] [Thread-3  ]: SQL status: OK 51 in 1.43 seconds
[0m15:43:02.156023 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:43:02.156182 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m15:43:03.272995 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.54 seconds
[0m15:43:03.274509 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:43:03.275730 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m15:43:03.466649 [debug] [Thread-3  ]: SQL status: OK -1 in 1.31 seconds
[0m15:43:03.468784 [debug] [Thread-3  ]: finished collecting timing info
[0m15:43:03.469101 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m15:43:03.469721 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c6c40>]}
[0m15:43:03.470113 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 2.78s]
[0m15:43:03.470589 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m15:43:04.590340 [debug] [Thread-4  ]: SQL status: OK -1 in 1.31 seconds
[0m15:43:04.593889 [debug] [Thread-4  ]: finished collecting timing info
[0m15:43:04.594357 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m15:43:04.595062 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a55b0>]}
[0m15:43:04.595502 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.90s]
[0m15:43:04.595968 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m15:43:04.596567 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m15:43:04.596765 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m15:43:04.597006 [debug] [Thread-3  ]: Began running node model.global_x_task.group_by_stock
[0m15:43:04.597201 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m15:43:04.597443 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m15:43:04.597656 [info ] [Thread-3  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m15:43:04.598275 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m15:43:04.598859 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m15:43:04.599403 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m15:43:04.601554 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m15:43:04.601774 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m15:43:04.603936 [debug] [Thread-3  ]: Began compiling node model.global_x_task.group_by_stock
[0m15:43:04.604100 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m15:43:04.604283 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m15:43:04.604444 [debug] [Thread-3  ]: Compiling model.global_x_task.group_by_stock
[0m15:43:04.608956 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:43:04.612143 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m15:43:04.614848 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m15:43:04.615004 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m15:43:04.615453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:43:04.622139 [debug] [Thread-2  ]: finished collecting timing info
[0m15:43:04.622349 [debug] [Thread-3  ]: finished collecting timing info
[0m15:43:04.622880 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m15:43:04.624069 [debug] [Thread-3  ]: Began executing node model.global_x_task.group_by_stock
[0m15:43:04.626131 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m15:43:04.629013 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m15:43:04.637785 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m15:43:04.637931 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m15:43:04.638091 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:43:04.638200 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:43:04.638360 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:43:04.638487 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:43:06.159816 [debug] [Thread-2  ]: SQL status: OK -1 in 1.52 seconds
[0m15:43:06.161252 [debug] [Thread-2  ]: finished collecting timing info
[0m15:43:06.161476 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m15:43:06.161879 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106472970>]}
[0m15:43:06.162162 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.56s]
[0m15:43:06.162444 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m15:43:06.162921 [debug] [Thread-3  ]: SQL status: OK -1 in 1.52 seconds
[0m15:43:06.163969 [debug] [Thread-3  ]: finished collecting timing info
[0m15:43:06.164131 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: Close
[0m15:43:06.164518 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111927340>]}
[0m15:43:06.164737 [info ] [Thread-3  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.57s]
[0m15:43:06.164980 [debug] [Thread-3  ]: Finished running node model.global_x_task.group_by_stock
[0m15:43:06.173017 [debug] [Thread-1  ]: SQL status: OK -1 in 1.56 seconds
[0m15:43:06.174268 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m15:43:06.174711 [debug] [Thread-1  ]: finished collecting timing info
[0m15:43:06.174833 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m15:43:06.176816 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m15:43:06.177204 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:43:06.177303 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m15:43:07.515622 [debug] [Thread-1  ]: SQL status: OK -1 in 1.34 seconds
[0m15:43:07.520262 [debug] [Thread-1  ]: finished collecting timing info
[0m15:43:07.520672 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m15:43:07.521380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '241dc213-8e25-4873-9e68-0f26df9c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106472100>]}
[0m15:43:07.521817 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.92s]
[0m15:43:07.522441 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m15:43:07.523912 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:43:07.524558 [info ] [MainThread]: 
[0m15:43:07.524863 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 12.65 seconds (12.65s).
[0m15:43:07.525122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:07.525264 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m15:43:07.525400 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m15:43:07.525529 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m15:43:07.525657 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m15:43:07.539982 [info ] [MainThread]: 
[0m15:43:07.540275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:07.540505 [info ] [MainThread]: 
[0m15:43:07.540683 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:43:07.540987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106334160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b17880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cda220>]}
[0m15:43:07.541320 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 15:51:20.275786 | 67bfdc9f-55a6-4ccb-8287-10df4cd83bee ==============================
[0m15:51:20.275815 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:51:20.276445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:51:20.276581 [debug] [MainThread]: Tracking: tracking
[0m15:51:20.287801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f91640>]}
[0m15:51:20.325158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:20.325320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:20.329275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081470d0>]}
[0m15:51:20.333435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108096bb0>]}
[0m15:51:20.333633 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:51:20.333799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7ba30>]}
[0m15:51:20.334648 [info ] [MainThread]: 
[0m15:51:20.335057 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:51:20.335749 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m15:51:20.343095 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m15:51:20.343326 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m15:51:20.343420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:21.915970 [debug] [ThreadPool]: SQL status: OK -1 in 1.57 seconds
[0m15:51:21.918604 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:51:21.920310 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m15:51:21.924891 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m15:51:21.925051 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m15:51:21.925121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:23.399641 [debug] [ThreadPool]: SQL status: OK -1 in 1.47 seconds
[0m15:51:23.400559 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m15:51:23.400980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff4f40>]}
[0m15:51:23.401325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:23.401519 [info ] [MainThread]: 
[0m15:51:23.403910 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m15:51:23.404135 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m15:51:23.404485 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:51:23.405479 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m15:51:23.405596 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m15:51:23.409720 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:51:23.409915 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m15:51:23.409992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:51:24.870278 [debug] [Thread-1  ]: SQL status: OK -1 in 1.46 seconds
[0m15:51:24.871293 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m15:51:24.872054 [debug] [Thread-1  ]: finished collecting timing info
[0m15:51:24.872166 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m15:51:24.881527 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m15:51:24.882072 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m15:51:24.882200 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m15:51:26.160319 [debug] [Thread-1  ]: SQL status: OK -1 in 1.28 seconds
[0m15:51:26.164681 [debug] [Thread-1  ]: finished collecting timing info
[0m15:51:26.164975 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m15:51:26.165355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d92310>]}
[0m15:51:26.165555 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.76s]
[0m15:51:26.165771 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m15:51:26.166037 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m15:51:26.166193 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m15:51:26.166504 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m15:51:26.166582 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m15:51:26.166654 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m15:51:26.166788 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m15:51:26.168652 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m15:51:26.168817 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m15:51:26.169224 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m15:51:26.169351 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m15:51:26.169432 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m15:51:26.171120 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m15:51:26.171290 [debug] [Thread-3  ]: finished collecting timing info
[0m15:51:26.171380 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m15:51:26.181493 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m15:51:26.181701 [debug] [Thread-4  ]: finished collecting timing info
[0m15:51:26.181978 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m15:51:26.183951 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m15:51:26.184217 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:51:26.184355 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m15:51:26.184447 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:51:26.188412 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:51:26.188675 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m15:51:26.189231 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:51:27.684990 [debug] [Thread-3  ]: SQL status: OK 51 in 1.5 seconds
[0m15:51:27.686879 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m15:51:27.687026 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m15:51:28.642829 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.45 seconds
[0m15:51:28.643688 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m15:51:28.643843 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m15:51:29.003109 [debug] [Thread-3  ]: SQL status: OK -1 in 1.32 seconds
[0m15:51:29.006047 [debug] [Thread-3  ]: finished collecting timing info
[0m15:51:29.006441 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m15:51:29.006902 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a9040>]}
[0m15:51:29.007197 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 2.84s]
[0m15:51:29.007437 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m15:51:29.944655 [debug] [Thread-4  ]: SQL status: OK -1 in 1.3 seconds
[0m15:51:29.945777 [debug] [Thread-4  ]: finished collecting timing info
[0m15:51:29.945950 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m15:51:29.946238 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827c9a0>]}
[0m15:51:29.946423 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.78s]
[0m15:51:29.946639 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m15:51:29.946952 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m15:51:29.947040 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m15:51:29.947143 [debug] [Thread-3  ]: Began running node model.global_x_task.group_by_stock
[0m15:51:29.947241 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m15:51:29.947361 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m15:51:29.947461 [info ] [Thread-3  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m15:51:29.947756 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m15:51:29.948016 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m15:51:29.948269 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m15:51:29.948446 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m15:51:29.949281 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m15:51:29.950276 [debug] [Thread-3  ]: Began compiling node model.global_x_task.group_by_stock
[0m15:51:29.950352 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m15:51:29.950434 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m15:51:29.950505 [debug] [Thread-3  ]: Compiling model.global_x_task.group_by_stock
[0m15:51:29.952765 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m15:51:29.955051 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:51:29.957400 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m15:51:29.957703 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m15:51:29.958766 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:51:29.964405 [debug] [Thread-3  ]: finished collecting timing info
[0m15:51:29.964516 [debug] [Thread-2  ]: finished collecting timing info
[0m15:51:29.964688 [debug] [Thread-3  ]: Began executing node model.global_x_task.group_by_stock
[0m15:51:29.965203 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m15:51:29.966973 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m15:51:29.968636 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m15:51:29.976077 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m15:51:29.976261 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m15:51:29.976338 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:51:29.976449 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m15:51:29.976686 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:51:29.976817 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:51:31.497326 [debug] [Thread-3  ]: SQL status: OK -1 in 1.52 seconds
[0m15:51:31.498417 [debug] [Thread-3  ]: finished collecting timing info
[0m15:51:31.498589 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: Close
[0m15:51:31.498937 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad1fcd0>]}
[0m15:51:31.499182 [info ] [Thread-3  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.55s]
[0m15:51:31.499419 [debug] [Thread-3  ]: Finished running node model.global_x_task.group_by_stock
[0m15:51:31.509153 [debug] [Thread-2  ]: SQL status: OK -1 in 1.53 seconds
[0m15:51:31.510434 [debug] [Thread-2  ]: finished collecting timing info
[0m15:51:31.510642 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m15:51:31.510951 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f68e50>]}
[0m15:51:31.511143 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.56s]
[0m15:51:31.511342 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m15:51:31.518816 [debug] [Thread-1  ]: SQL status: OK -1 in 1.56 seconds
[0m15:51:31.519926 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m15:51:31.520356 [debug] [Thread-1  ]: finished collecting timing info
[0m15:51:31.520457 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m15:51:31.522594 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m15:51:31.522989 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m15:51:31.523067 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m15:51:32.832025 [debug] [Thread-1  ]: SQL status: OK -1 in 1.31 seconds
[0m15:51:32.837235 [debug] [Thread-1  ]: finished collecting timing info
[0m15:51:32.837653 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m15:51:32.838432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bfdc9f-55a6-4ccb-8287-10df4cd83bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108582a30>]}
[0m15:51:32.838745 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.89s]
[0m15:51:32.838983 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m15:51:32.839699 [debug] [MainThread]: Acquiring new athena connection "master"
[0m15:51:32.840026 [info ] [MainThread]: 
[0m15:51:32.840162 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 12.51 seconds (12.51s).
[0m15:51:32.840274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:32.840334 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m15:51:32.840394 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m15:51:32.840447 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m15:51:32.840501 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m15:51:32.847569 [info ] [MainThread]: 
[0m15:51:32.847799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:32.847948 [info ] [MainThread]: 
[0m15:51:32.848056 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:51:32.848229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109073d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108113c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ffb50>]}
[0m15:51:32.848377 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 16:12:25.511800 | 360432c9-87c5-4953-a399-4c83dffc0f86 ==============================
[0m16:12:25.511821 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:12:25.512702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:12:25.512823 [debug] [MainThread]: Tracking: tracking
[0m16:12:25.532587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f91580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10686efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f917c0>]}
[0m16:12:25.569530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:25.569705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:25.573684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091470d0>]}
[0m16:12:25.578282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109096a90>]}
[0m16:12:25.578466 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:12:25.578602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891dc70>]}
[0m16:12:25.579388 [info ] [MainThread]: 
[0m16:12:25.579745 [debug] [MainThread]: Acquiring new athena connection "master"
[0m16:12:25.580348 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m16:12:25.587933 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m16:12:25.588138 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m16:12:25.588228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:27.105155 [debug] [ThreadPool]: SQL status: OK -1 in 1.52 seconds
[0m16:12:27.108118 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:12:27.109671 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog_default_globalx"
[0m16:12:27.114048 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog_default_globalx"
[0m16:12:27.114207 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog_default_globalx"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "AwsDataCatalog".INFORMATION_SCHEMA.views
      where table_schema = LOWER('default_globalx')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "AwsDataCatalog".INFORMATION_SCHEMA.tables
      where table_schema = LOWER('default_globalx')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
[0m16:12:27.114287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:28.587167 [debug] [ThreadPool]: SQL status: OK -1 in 1.47 seconds
[0m16:12:28.589726 [debug] [ThreadPool]: On list_AwsDataCatalog_default_globalx: Close
[0m16:12:28.591049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091744f0>]}
[0m16:12:28.591515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:12:28.591669 [info ] [MainThread]: 
[0m16:12:28.593223 [debug] [Thread-1  ]: Began running node model.global_x_task.etl_integrated_etf_data
[0m16:12:28.593451 [info ] [Thread-1  ]: 1 of 6 START sql view model default_globalx.etl_integrated_etf_data ............ [RUN]
[0m16:12:28.593810 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.etl_integrated_etf_data"
[0m16:12:28.594780 [debug] [Thread-1  ]: Began compiling node model.global_x_task.etl_integrated_etf_data
[0m16:12:28.594886 [debug] [Thread-1  ]: Compiling model.global_x_task.etl_integrated_etf_data
[0m16:12:28.599043 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m16:12:28.599267 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */

    
        DROP VIEW IF EXISTS default_globalx.etl_integrated_etf_data;
    
  
[0m16:12:28.599345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:30.030711 [debug] [Thread-1  ]: SQL status: OK -1 in 1.43 seconds
[0m16:12:30.034444 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.etl_integrated_etf_data"
[0m16:12:30.036201 [debug] [Thread-1  ]: finished collecting timing info
[0m16:12:30.036326 [debug] [Thread-1  ]: Began executing node model.global_x_task.etl_integrated_etf_data
[0m16:12:30.046552 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.etl_integrated_etf_data"
[0m16:12:30.047256 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.etl_integrated_etf_data"
[0m16:12:30.047411 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.etl_integrated_etf_data"} */
create or replace view
    default_globalx.etl_integrated_etf_data
  as
    

select
    date,
    index,
    volume,
    volume_weighted_avg_price,
    opening_price,
    close_price,
    highest_price,
    lowest_price,
    timestamp,
    number_of_trades,
    symbol,
    realtime_start,
    realtime_end,
    unemployment_rate
from default_globalx.integrated_etf_data

[0m16:12:31.309901 [debug] [Thread-1  ]: SQL status: OK -1 in 1.26 seconds
[0m16:12:31.316595 [debug] [Thread-1  ]: finished collecting timing info
[0m16:12:31.316854 [debug] [Thread-1  ]: On model.global_x_task.etl_integrated_etf_data: Close
[0m16:12:31.317182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c2fd0>]}
[0m16:12:31.317395 [info ] [Thread-1  ]: 1 of 6 OK created sql view model default_globalx.etl_integrated_etf_data ....... [[32mOK -1[0m in 2.72s]
[0m16:12:31.317635 [debug] [Thread-1  ]: Finished running node model.global_x_task.etl_integrated_etf_data
[0m16:12:31.317993 [debug] [Thread-3  ]: Began running node model.global_x_task.fred_unemp
[0m16:12:31.318179 [debug] [Thread-4  ]: Began running node model.global_x_task.polygon
[0m16:12:31.318395 [info ] [Thread-3  ]: 2 of 6 START sql table model default_globalx.fred_unemp ........................ [RUN]
[0m16:12:31.318578 [info ] [Thread-4  ]: 3 of 6 START sql table model default_globalx.polygon ........................... [RUN]
[0m16:12:31.318988 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.fred_unemp"
[0m16:12:31.319274 [debug] [Thread-4  ]: Acquiring new athena connection "model.global_x_task.polygon"
[0m16:12:31.319354 [debug] [Thread-3  ]: Began compiling node model.global_x_task.fred_unemp
[0m16:12:31.319425 [debug] [Thread-4  ]: Began compiling node model.global_x_task.polygon
[0m16:12:31.319535 [debug] [Thread-3  ]: Compiling model.global_x_task.fred_unemp
[0m16:12:31.319628 [debug] [Thread-4  ]: Compiling model.global_x_task.polygon
[0m16:12:31.321540 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.fred_unemp"
[0m16:12:31.323082 [debug] [Thread-4  ]: Writing injected SQL for node "model.global_x_task.polygon"
[0m16:12:31.323756 [debug] [Thread-3  ]: finished collecting timing info
[0m16:12:31.323834 [debug] [Thread-4  ]: finished collecting timing info
[0m16:12:31.323903 [debug] [Thread-3  ]: Began executing node model.global_x_task.fred_unemp
[0m16:12:31.323980 [debug] [Thread-4  ]: Began executing node model.global_x_task.polygon
[0m16:12:31.334632 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.fred_unemp"
[0m16:12:31.337771 [debug] [Thread-4  ]: Writing runtime sql for node "model.global_x_task.polygon"
[0m16:12:31.338484 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m16:12:31.338620 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m16:12:31.338695 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */

  
    create table
    default_globalx.fred_unemp

    with (
        format='parquet'
    )
  as
    -- models/fred_unemp.sql



with integrated_data as (
    select
        date,
        unemployment_rate
    from default_globalx.etl_integrated_etf_data
    where unemployment_rate is not null
)

select * from integrated_data

  
  
[0m16:12:31.338779 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */

  
    create table
    default_globalx.polygon

    with (
        format='parquet'
    )
  as
    -- models/polygon.sql



with integrated_data as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.etl_integrated_etf_data
)

select * from integrated_data

  
  
[0m16:12:31.338855 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:12:31.338927 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:12:33.826807 [debug] [Thread-3  ]: SQL status: OK 51 in 2.49 seconds
[0m16:12:33.828803 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.fred_unemp"
[0m16:12:33.828950 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.fred_unemp"} */
alter table default_globalx.fred_unemp set tblproperties ('classification' = 'parquet')
[0m16:12:33.847994 [debug] [Thread-4  ]: SQL status: OK 1506 in 2.51 seconds
[0m16:12:33.848931 [debug] [Thread-4  ]: Using athena connection "model.global_x_task.polygon"
[0m16:12:33.849161 [debug] [Thread-4  ]: On model.global_x_task.polygon: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.polygon"} */
alter table default_globalx.polygon set tblproperties ('classification' = 'parquet')
[0m16:12:35.117536 [debug] [Thread-3  ]: SQL status: OK -1 in 1.29 seconds
[0m16:12:35.118606 [debug] [Thread-3  ]: finished collecting timing info
[0m16:12:35.118773 [debug] [Thread-3  ]: On model.global_x_task.fred_unemp: Close
[0m16:12:35.119050 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981dfd0>]}
[0m16:12:35.119227 [info ] [Thread-3  ]: 2 of 6 OK created sql table model default_globalx.fred_unemp ................... [[32mOK 51[0m in 3.80s]
[0m16:12:35.119435 [debug] [Thread-3  ]: Finished running node model.global_x_task.fred_unemp
[0m16:12:35.138783 [debug] [Thread-4  ]: SQL status: OK -1 in 1.29 seconds
[0m16:12:35.139830 [debug] [Thread-4  ]: finished collecting timing info
[0m16:12:35.140006 [debug] [Thread-4  ]: On model.global_x_task.polygon: Close
[0m16:12:35.140338 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab3aa60>]}
[0m16:12:35.140548 [info ] [Thread-4  ]: 3 of 6 OK created sql table model default_globalx.polygon ...................... [[32mOK 1506[0m in 3.82s]
[0m16:12:35.140938 [debug] [Thread-4  ]: Finished running node model.global_x_task.polygon
[0m16:12:35.141428 [debug] [Thread-1  ]: Began running node model.global_x_task.extra_metrics
[0m16:12:35.141612 [info ] [Thread-1  ]: 4 of 6 START sql view model default_globalx.extra_metrics ...................... [RUN]
[0m16:12:35.141947 [debug] [Thread-1  ]: Acquiring new athena connection "model.global_x_task.extra_metrics"
[0m16:12:35.142215 [debug] [Thread-2  ]: Began running node model.global_x_task.group_by_date
[0m16:12:35.142339 [debug] [Thread-3  ]: Began running node model.global_x_task.group_by_stock
[0m16:12:35.143145 [debug] [Thread-1  ]: Began compiling node model.global_x_task.extra_metrics
[0m16:12:35.143291 [info ] [Thread-2  ]: 5 of 6 START sql view model default_globalx.group_by_date ...................... [RUN]
[0m16:12:35.143418 [info ] [Thread-3  ]: 6 of 6 START sql view model default_globalx.group_by_stock ..................... [RUN]
[0m16:12:35.143508 [debug] [Thread-1  ]: Compiling model.global_x_task.extra_metrics
[0m16:12:35.143827 [debug] [Thread-2  ]: Acquiring new athena connection "model.global_x_task.group_by_date"
[0m16:12:35.144120 [debug] [Thread-3  ]: Acquiring new athena connection "model.global_x_task.group_by_stock"
[0m16:12:35.146521 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m16:12:35.146685 [debug] [Thread-2  ]: Began compiling node model.global_x_task.group_by_date
[0m16:12:35.146927 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */

    
        DROP VIEW IF EXISTS default_globalx.extra_metrics;
    
  
[0m16:12:35.147733 [debug] [Thread-3  ]: Began compiling node model.global_x_task.group_by_stock
[0m16:12:35.147832 [debug] [Thread-2  ]: Compiling model.global_x_task.group_by_date
[0m16:12:35.147903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:35.147979 [debug] [Thread-3  ]: Compiling model.global_x_task.group_by_stock
[0m16:12:35.150002 [debug] [Thread-2  ]: Writing injected SQL for node "model.global_x_task.group_by_date"
[0m16:12:35.156653 [debug] [Thread-3  ]: Writing injected SQL for node "model.global_x_task.group_by_stock"
[0m16:12:35.164486 [debug] [Thread-3  ]: finished collecting timing info
[0m16:12:35.164610 [debug] [Thread-2  ]: finished collecting timing info
[0m16:12:35.164736 [debug] [Thread-3  ]: Began executing node model.global_x_task.group_by_stock
[0m16:12:35.164966 [debug] [Thread-2  ]: Began executing node model.global_x_task.group_by_date
[0m16:12:35.167347 [debug] [Thread-3  ]: Writing runtime sql for node "model.global_x_task.group_by_stock"
[0m16:12:35.168955 [debug] [Thread-2  ]: Writing runtime sql for node "model.global_x_task.group_by_date"
[0m16:12:35.169508 [debug] [Thread-2  ]: Using athena connection "model.global_x_task.group_by_date"
[0m16:12:35.169634 [debug] [Thread-3  ]: Using athena connection "model.global_x_task.group_by_stock"
[0m16:12:35.169758 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_date"} */
create or replace view
    default_globalx.group_by_date
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        date,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        date
)

select
    date,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m16:12:35.169875 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.group_by_stock"} */
create or replace view
    default_globalx.group_by_stock
  as
    

with joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        default_globalx.polygon p
    left join
        default_globalx.fred_unemp f
    on
        p.date = f.date
),

aggregated_data as (
    select
        symbol,
        AVG(volume) as avg_volume,
        AVG(close_price) as avg_close_price,
        AVG(opening_price) as avg_opening_price,
        AVG(highest_price) as avg_highest_price,
        AVG(lowest_price) as avg_lowest_price,
        AVG(unemployment_rate) as avg_unemployment_rate,
        COUNT(*) as record_count
    from
        joined_data
    group by
        symbol
)

select
    symbol,
    avg_volume,
    avg_close_price,
    avg_opening_price,
    avg_highest_price,
    avg_lowest_price,
    avg_unemployment_rate,
    record_count
from
    aggregated_data

[0m16:12:35.169997 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:12:35.170098 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:12:36.681946 [debug] [Thread-3  ]: SQL status: OK -1 in 1.51 seconds
[0m16:12:36.683039 [debug] [Thread-3  ]: finished collecting timing info
[0m16:12:36.683169 [debug] [Thread-3  ]: On model.global_x_task.group_by_stock: Close
[0m16:12:36.683454 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d7fd0>]}
[0m16:12:36.683633 [info ] [Thread-3  ]: 6 of 6 OK created sql view model default_globalx.group_by_stock ................ [[32mOK -1[0m in 1.54s]
[0m16:12:36.683834 [debug] [Thread-3  ]: Finished running node model.global_x_task.group_by_stock
[0m16:12:36.707412 [debug] [Thread-2  ]: SQL status: OK -1 in 1.54 seconds
[0m16:12:36.708606 [debug] [Thread-2  ]: finished collecting timing info
[0m16:12:36.708758 [debug] [Thread-2  ]: On model.global_x_task.group_by_date: Close
[0m16:12:36.709091 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a2760>]}
[0m16:12:36.709287 [info ] [Thread-2  ]: 5 of 6 OK created sql view model default_globalx.group_by_date ................. [[32mOK -1[0m in 1.57s]
[0m16:12:36.709495 [debug] [Thread-2  ]: Finished running node model.global_x_task.group_by_date
[0m16:12:36.715210 [debug] [Thread-1  ]: SQL status: OK -1 in 1.57 seconds
[0m16:12:36.716325 [debug] [Thread-1  ]: Writing injected SQL for node "model.global_x_task.extra_metrics"
[0m16:12:36.716825 [debug] [Thread-1  ]: finished collecting timing info
[0m16:12:36.716969 [debug] [Thread-1  ]: Began executing node model.global_x_task.extra_metrics
[0m16:12:36.719169 [debug] [Thread-1  ]: Writing runtime sql for node "model.global_x_task.extra_metrics"
[0m16:12:36.720009 [debug] [Thread-1  ]: Using athena connection "model.global_x_task.extra_metrics"
[0m16:12:36.720108 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "node_id": "model.global_x_task.extra_metrics"} */
create or replace view
    default_globalx.extra_metrics
  as
    

with fred as (
    select
        date,
        unemployment_rate
    from default_globalx.fred_unemp
),

polygon as (
    select
        date,
        volume,
        volume_weighted_avg_price,
        opening_price,
        close_price,
        highest_price,
        lowest_price,
        timestamp,
        number_of_trades,
        symbol
    from default_globalx.polygon
),

joined_data as (
    select
        p.date,
        p.volume,
        p.volume_weighted_avg_price,
        p.opening_price,
        p.close_price,
        p.highest_price,
        p.lowest_price,
        p.timestamp,
        p.number_of_trades,
        p.symbol,
        f.unemployment_rate
    from
        polygon p
    left join
        fred f
    on
        p.date = f.date
)

select
    jd.date,
    jd.symbol,
    jd.volume,
    jd.volume_weighted_avg_price,
    jd.opening_price,
    jd.close_price,
    jd.highest_price,
    jd.lowest_price,
    jd.number_of_trades,
    -- Calculate daily_return as the percentage change from the previous day's close_price to today's close_price
    (jd.close_price - LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date)) / LAG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date) as daily_return,
    -- Calculate moving_avg_50 as the 50-day moving average of close_price
    AVG(jd.close_price) OVER (PARTITION BY jd.symbol ORDER BY jd.date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) as moving_avg_50,
    -- Calculate Change in Price
    (jd.close_price - jd.opening_price) as price_change,
    (jd.highest_price - jd.lowest_price) / jd.lowest_price * 100 as intraday_volatility
from
    joined_data jd

[0m16:12:37.993204 [debug] [Thread-1  ]: SQL status: OK -1 in 1.27 seconds
[0m16:12:37.997101 [debug] [Thread-1  ]: finished collecting timing info
[0m16:12:37.997344 [debug] [Thread-1  ]: On model.global_x_task.extra_metrics: Close
[0m16:12:37.997718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360432c9-87c5-4953-a399-4c83dffc0f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c9fd0>]}
[0m16:12:37.997928 [info ] [Thread-1  ]: 4 of 6 OK created sql view model default_globalx.extra_metrics ................. [[32mOK -1[0m in 2.86s]
[0m16:12:37.998148 [debug] [Thread-1  ]: Finished running node model.global_x_task.extra_metrics
[0m16:12:37.998873 [debug] [MainThread]: Acquiring new athena connection "master"
[0m16:12:37.999154 [info ] [MainThread]: 
[0m16:12:37.999276 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 12.42 seconds (12.42s).
[0m16:12:37.999386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:37.999447 [debug] [MainThread]: Connection 'model.global_x_task.extra_metrics' was properly closed.
[0m16:12:37.999503 [debug] [MainThread]: Connection 'model.global_x_task.group_by_stock' was properly closed.
[0m16:12:37.999556 [debug] [MainThread]: Connection 'model.global_x_task.polygon' was properly closed.
[0m16:12:37.999607 [debug] [MainThread]: Connection 'model.global_x_task.group_by_date' was properly closed.
[0m16:12:38.007559 [info ] [MainThread]: 
[0m16:12:38.007855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:38.008022 [info ] [MainThread]: 
[0m16:12:38.008138 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:12:38.008340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc40070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e7dc0>]}
[0m16:12:38.008505 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 20:12:53.666044 | 58a17833-0990-48ec-84b1-9a1da4df040e ==============================
[0m20:12:53.666066 [info ] [MainThread]: Running with dbt=1.3.0
[0m20:12:53.666819 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:12:53.666947 [debug] [MainThread]: Tracking: tracking
[0m20:12:53.685560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d1b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0d5e0>]}
[0m20:12:53.727675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:53.727856 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:53.732459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58a17833-0990-48ec-84b1-9a1da4df040e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec70d0>]}
[0m20:12:53.737635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58a17833-0990-48ec-84b1-9a1da4df040e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e16bb0>]}
[0m20:12:53.737865 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:12:53.738023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58a17833-0990-48ec-84b1-9a1da4df040e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101df3a30>]}
[0m20:12:53.738852 [info ] [MainThread]: 
[0m20:12:53.739216 [debug] [MainThread]: Acquiring new athena connection "master"
[0m20:12:53.739861 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m20:12:53.747596 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m20:12:53.747781 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m20:12:53.747867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:10.844193 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m20:14:10.845067 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro list_schemas
[0m20:14:10.845558 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m20:14:10.846773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:10.846907 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m20:14:10.847302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e16820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e16610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e93cd0>]}
[0m20:14:10.847576 [debug] [MainThread]: Flushing usage events
[0m20:14:10.991484 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    Unable to locate credentials


============================== 2024-06-07 20:20:09.506090 | 327f3bf2-7bd0-4686-8295-834bc22c26a3 ==============================
[0m20:20:09.506108 [info ] [MainThread]: Running with dbt=1.3.0
[0m20:20:09.506679 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:20:09.506777 [debug] [MainThread]: Tracking: tracking
[0m20:20:09.524665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd19d0>]}
[0m20:20:09.564469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:09.564653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:09.568993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '327f3bf2-7bd0-4686-8295-834bc22c26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e870d0>]}
[0m20:20:09.573642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '327f3bf2-7bd0-4686-8295-834bc22c26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd6b20>]}
[0m20:20:09.573869 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:20:09.574068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '327f3bf2-7bd0-4686-8295-834bc22c26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107988220>]}
[0m20:20:09.574894 [info ] [MainThread]: 
[0m20:20:09.575267 [debug] [MainThread]: Acquiring new athena connection "master"
[0m20:20:09.575887 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m20:20:09.583465 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m20:20:09.583611 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m20:20:09.583703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:24.683107 [debug] [ThreadPool]: Athena adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m20:21:24.686150 [debug] [ThreadPool]: Athena adapter: Error running SQL: macro list_schemas
[0m20:21:24.687036 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m20:21:24.689946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:24.690186 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m20:21:24.691094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e53b20>]}
[0m20:21:24.691718 [debug] [MainThread]: Flushing usage events
[0m20:21:24.829464 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    Unable to locate credentials


============================== 2024-06-07 20:25:04.591138 | 1e6f17b2-caa5-45a3-8152-c32d2e0a48db ==============================
[0m20:25:04.591163 [info ] [MainThread]: Running with dbt=1.3.0
[0m20:25:04.591880 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/octavioelias/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:25:04.592006 [debug] [MainThread]: Tracking: tracking
[0m20:25:04.612364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a7a90>]}
[0m20:25:04.656310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:04.656503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:04.661337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e6f17b2-caa5-45a3-8152-c32d2e0a48db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107880d0>]}
[0m20:25:04.665860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e6f17b2-caa5-45a3-8152-c32d2e0a48db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110599af0>]}
[0m20:25:04.666038 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 276 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:25:04.666233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6f17b2-caa5-45a3-8152-c32d2e0a48db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e6d30>]}
[0m20:25:04.667149 [info ] [MainThread]: 
[0m20:25:04.667585 [debug] [MainThread]: Acquiring new athena connection "master"
[0m20:25:04.668283 [debug] [ThreadPool]: Acquiring new athena connection "list_AwsDataCatalog"
[0m20:25:04.676485 [debug] [ThreadPool]: Using athena connection "list_AwsDataCatalog"
[0m20:25:04.676688 [debug] [ThreadPool]: On list_AwsDataCatalog: -- /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "global_x_task", "target_name": "dev", "connection_name": "list_AwsDataCatalog"} */

    select
        distinct schema_name

    from AwsDataCatalog.INFORMATION_SCHEMA.schemata
  
[0m20:25:04.676775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:27.137868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:27.138357 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was left open.
[0m20:25:27.138806 [debug] [MainThread]: On list_AwsDataCatalog: Close
[0m20:25:27.138959 [debug] [MainThread]: Flushing usage events
[0m20:25:27.280344 [info ] [MainThread]: ctrl-c
